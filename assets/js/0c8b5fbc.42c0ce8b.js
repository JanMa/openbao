"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1138],{18908:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>r});var t=n(74848),o=n(28453);const s={sidebar_label:"File",description:'The "file" audit device writes audit logs to a file.'},l="File audit device",a={id:"audit/file",title:"File audit device",description:'The "file" audit device writes audit logs to a file.',source:"@site/content/docs/audit/file.mdx",sourceDirName:"audit",slug:"/audit/file",permalink:"/openbao/docs/audit/file",draft:!1,unlisted:!1,editUrl:"https://github.com/openbao/openbao/tree/main/website/content/docs/audit/file.mdx",tags:[],version:"current",frontMatter:{sidebar_label:"File",description:'The "file" audit device writes audit logs to a file.'},sidebar:"docs",previous:{title:"Overview",permalink:"/openbao/docs/audit/"},next:{title:"Syslog",permalink:"/openbao/docs/audit/syslog"}},d={},r=[{value:"Examples",id:"examples",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Log file rotation",id:"log-file-rotation",level:2}];function c(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h1,{id:"file-audit-device",children:"File audit device"}),"\n",(0,t.jsxs)(i.p,{children:["The ",(0,t.jsx)(i.code,{children:"file"})," audit device writes audit logs to a file. This is a very simple audit\ndevice: it appends logs to a file."]}),"\n",(0,t.jsx)(i.p,{children:"The device does not currently assist with any log rotation. There are very\nstable and feature-filled log rotation tools already, so we recommend using\nexisting tools."}),"\n",(0,t.jsxs)(i.p,{children:["Sending a ",(0,t.jsx)(i.code,{children:"SIGHUP"})," to the OpenBao process will cause ",(0,t.jsx)(i.code,{children:"file"})," audit devices to close\nand re-open their underlying file, which can assist with log rotation needs."]}),"\n",(0,t.jsx)(i.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(i.p,{children:"Enable at the default path:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-shell-session",children:"$ bao audit enable file file_path=/var/log/openbao_audit.log\n"})}),"\n",(0,t.jsx)(i.p,{children:"Enable at a different path. It is possible to enable multiple copies of an audit\ndevice:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-shell-session",children:'$ bao audit enable -path="openbao_audit_1" file file_path=/home/user/openbao_audit.log\n'})}),"\n",(0,t.jsx)(i.p,{children:"Enable logs on stdout. This is useful when running in a container:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-shell-session",children:"$ bao audit enable file file_path=stdout\n"})}),"\n",(0,t.jsx)(i.h2,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsxs)(i.p,{children:["Note the difference between ",(0,t.jsx)(i.code,{children:"audit enable"})," command options and the ",(0,t.jsx)(i.code,{children:"file"})," backend\nconfiguration options. Use ",(0,t.jsx)(i.code,{children:"bao audit enable -help"})," to see the command options."]}),"\n",(0,t.jsxs)(i.p,{children:["The ",(0,t.jsx)(i.code,{children:"file"})," audit device supports the common configuration options documented on\nthe ",(0,t.jsx)(i.a,{href:"/docs/audit#common-configuration-options",children:"main Audit Devices page"}),", and\nthese device-specific options:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.code,{children:"file_path"})," ",(0,t.jsx)(i.code,{children:"(string: <required>)"})," - The path to where the audit log will be\nwritten. If a file already exists at the given path, the audit backend will\nappend to it. There are some special keywords:"]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.code,{children:"stdout"})," writes the audit log to standard output"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.code,{children:"discard"})," discards output, instead of writing it to a device (useful in testing scenarios)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.code,{children:"mode"})," ",(0,t.jsx)(i.code,{children:'(string: "0600")'})," - A string containing an octal number representing\nthe bit pattern for the file mode, similar to ",(0,t.jsx)(i.code,{children:"chmod"}),". Set to ",(0,t.jsx)(i.code,{children:'"0000"'})," to\nprevent OpenBao from modifying the file mode."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"log-file-rotation",children:"Log file rotation"}),"\n",(0,t.jsxs)(i.p,{children:["To properly rotate OpenBao File Audit Device log files on BSD, Darwin, or Linux-based OpenBao servers, it is important that you configure your log rotation software to send the ",(0,t.jsx)(i.code,{children:"bao"})," process a signal hang up / ",(0,t.jsx)(i.code,{children:"SIGHUP"})," after each rotation of the log file."]})]})}function h(e={}){const{wrapper:i}={...(0,o.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,i,n)=>{n.d(i,{R:()=>l,x:()=>a});var t=n(96540);const o={},s=t.createContext(o);function l(e){const i=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),t.createElement(s.Provider,{value:i},e.children)}}}]);