"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2370],{94799:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>d,toc:()=>l});var i=s(74848),r=s(28453);const t={sidebar_label:"TCP",description:"The TCP listener configures OpenBao to listen on the specified TCP address and\nport."},c="tcp listener",d={id:"configuration/listener/tcp",title:"tcp listener",description:"The TCP listener configures OpenBao to listen on the specified TCP address and\nport.",source:"@site/content/docs/configuration/listener/tcp.mdx",sourceDirName:"configuration/listener",slug:"/configuration/listener/tcp",permalink:"/openbao/docs/configuration/listener/tcp",draft:!1,unlisted:!1,editUrl:"https://github.com/openbao/openbao/tree/main/website/content/docs/configuration/listener/tcp.mdx",tags:[],version:"current",frontMatter:{sidebar_label:"TCP",description:"The TCP listener configures OpenBao to listen on the specified TCP address and\nport."},sidebar:"docs",previous:{title:"Unix",permalink:"/openbao/docs/configuration/listener/unix"},next:{title:"Overview",permalink:"/openbao/docs/configuration/seal/"}},o={},l=[{value:"Listener&#39;s custom response headers",id:"listeners-custom-response-headers",level:2},{value:"Order of precedence",id:"order-of-precedence",level:3},{value:"<code>tcp</code> listener parameters",id:"tcp-listener-parameters",level:2},{value:"<code>telemetry</code> parameters",id:"telemetry-parameters",level:3},{value:"<code>profiling</code> parameters",id:"profiling-parameters",level:3},{value:"<code>inflight_requests_logging</code> parameters",id:"inflight_requests_logging-parameters",level:3},{value:"<code>custom_response_headers</code> parameters",id:"custom_response_headers-parameters",level:3},{value:"<code>tcp</code> listener examples",id:"tcp-listener-examples",level:2},{value:"Configuring TLS",id:"configuring-tls",level:3},{value:"Listening on multiple interfaces",id:"listening-on-multiple-interfaces",level:3},{value:"Configuring unauthenticated metrics access",id:"configuring-unauthenticated-metrics-access",level:3},{value:"Configuring unauthenticated profiling access",id:"configuring-unauthenticated-profiling-access",level:3},{value:"Configuring custom http response headers",id:"configuring-custom-http-response-headers",level:3},{value:"Listening on all IPv6 &amp; IPv4 interfaces",id:"listening-on-all-ipv6--ipv4-interfaces",level:3},{value:"Listening to specific IPv6 address",id:"listening-to-specific-ipv6-address",level:3}];function a(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.h1,{id:"tcp-listener",children:[(0,i.jsx)(n.code,{children:"tcp"})," listener"]}),"\n",(0,i.jsx)(n.p,{children:"The TCP listener configures OpenBao to listen on a TCP address/port."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'listener "tcp" {\n  address = "127.0.0.1:8200"\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"listener"})," stanza may be specified more than once to make OpenBao listen on\nmultiple interfaces. If you configure multiple listeners you also need to\nspecify ",(0,i.jsx)(n.a,{href:"/docs/configuration#api_addr",children:(0,i.jsx)(n.code,{children:"api_addr"})})," and ",(0,i.jsx)(n.a,{href:"/docs/configuration#cluster_addr",children:(0,i.jsx)(n.code,{children:"cluster_addr"})})," so OpenBao will\nadvertise the correct address to other nodes."]}),"\n",(0,i.jsx)(n.h2,{id:"listeners-custom-response-headers",children:"Listener's custom response headers"}),"\n",(0,i.jsxs)(n.p,{children:["OpenBao supports defining custom HTTP response headers for the root path (",(0,i.jsx)(n.code,{children:"/"}),") and also on API endpoints (",(0,i.jsx)(n.code,{children:"/v1/*"}),").\nThe headers are defined based on the returned status code. For example, a user can define a list of\ncustom response headers for the ",(0,i.jsx)(n.code,{children:"200"})," status code, and another list of custom response headers for\nthe ",(0,i.jsx)(n.code,{children:"307"})," status code. There is a ",(0,i.jsx)(n.code,{children:'"/sys/config/ui"'})," ",(0,i.jsx)(n.a,{href:"/api-docs/system/config-ui",children:"API endpoint"})," which allows users\nto set ",(0,i.jsx)(n.code,{children:"UI"})," specific custom headers. If a header is configured in a configuration file, it is not allowed\nto be reconfigured through the ",(0,i.jsx)(n.code,{children:'"/sys/config/ui"'})," ",(0,i.jsx)(n.a,{href:"/api-docs/system/config-ui",children:"API endpoint"}),". In cases where a\ncustom header value needs to be modified or the custom header needs to be removed, the OpenBao's configuration file\nneeds to be modified accordingly, and a ",(0,i.jsx)(n.code,{children:"SIGHUP"})," signal needs to be sent to the OpenBao process."]}),"\n",(0,i.jsxs)(n.p,{children:["If a header is defined in the configuration file and the same header is used by the internal\nprocesses of OpenBao, the configured header is not accepted. For example, a custom header which has\nthe ",(0,i.jsx)(n.code,{children:"X-Vault-"})," prefix will not be accepted. A message will be logged in the OpenBao's logs\nupon start up indicating the header with ",(0,i.jsx)(n.code,{children:"X-Vault-"})," prefix is not accepted."]}),"\n",(0,i.jsx)(n.h3,{id:"order-of-precedence",children:"Order of precedence"}),"\n",(0,i.jsxs)(n.p,{children:["If the same header is configured in both the configuration file and\nin the ",(0,i.jsx)(n.code,{children:'"/sys/config/ui"'})," ",(0,i.jsx)(n.a,{href:"/api-docs/system/config-ui",children:"API endpoint"}),", the header in the configuration file takes precedence.\nFor example, the ",(0,i.jsx)(n.code,{children:'"Content-Security-Policy"'})," header is defined by default in the\n",(0,i.jsx)(n.code,{children:'"/sys/config/ui"'})," ",(0,i.jsx)(n.a,{href:"/api-docs/system/config-ui",children:"API endpoint"}),". If that header is also defined in the configuration file,\nthe value in the configuration file is set in the response headers instead of the\ndefault value in the ",(0,i.jsx)(n.code,{children:'"/sys/config/ui"'})," ",(0,i.jsx)(n.a,{href:"/api-docs/system/config-ui",children:"API endpoint"}),"."]}),"\n",(0,i.jsxs)(n.h2,{id:"tcp-listener-parameters",children:[(0,i.jsx)(n.code,{children:"tcp"})," listener parameters"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"address"})," ",(0,i.jsx)(n.code,{children:'(string: "127.0.0.1:8200")'})," \u2013 Specifies the address to bind to for\nlistening. This can be dynamically defined with a\n",(0,i.jsx)(n.a,{href:"https://pkg.go.dev/github.com/hashicorp/go-sockaddr/template",children:"go-sockaddr template"}),"\nthat is resolved at runtime."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"cluster_address"})," ",(0,i.jsx)(n.code,{children:'(string: "127.0.0.1:8201")'})," \u2013 Specifies the address to bind\nto for cluster server-to-server requests. This defaults to one port higher\nthan the value of ",(0,i.jsx)(n.code,{children:"address"}),". This does not usually need to be set, but can be\nuseful in case OpenBao servers are isolated from each other in such a way that\nthey need to hop through a TCP load balancer or some other scheme in order to\ntalk. This can be dynamically defined with a\n",(0,i.jsx)(n.a,{href:"https://pkg.go.dev/github.com/hashicorp/go-sockaddr/template",children:"go-sockaddr template"}),"\nthat is resolved at runtime."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"http_idle_timeout"})," ",(0,i.jsx)(n.code,{children:'(string: "5m")'})," - Specifies the maximum amount of time to\nwait for the next request when keep-alives are enabled. If ",(0,i.jsx)(n.code,{children:"http_idle_timeout"}),"\nis zero, the value of ",(0,i.jsx)(n.code,{children:"http_read_timeout"})," is used. If both are zero, the value\nof ",(0,i.jsx)(n.code,{children:"http_read_header_timeout"})," is used. This is specified using a label suffix\nlike ",(0,i.jsx)(n.code,{children:'"30s"'})," or ",(0,i.jsx)(n.code,{children:'"1h"'}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"http_read_header_timeout"})," ",(0,i.jsx)(n.code,{children:'(string: "10s")'})," - Specifies the amount of time\nallowed to read request headers. This is specified using a label suffix like\n",(0,i.jsx)(n.code,{children:'"30s"'})," or ",(0,i.jsx)(n.code,{children:'"1h"'}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"http_read_timeout"})," ",(0,i.jsx)(n.code,{children:'(string: "30s")'})," - Specifies the maximum duration for\nreading the entire request, including the body. This is specified using a\nlabel suffix like ",(0,i.jsx)(n.code,{children:'"30s"'})," or ",(0,i.jsx)(n.code,{children:'"1h"'}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"http_write_timeout"})," ",(0,i.jsx)(n.code,{children:'string: "0")'})," - Specifies the maximum duration before\ntiming out writes of the response and is reset whenever a new request's header\nis read. The default value of ",(0,i.jsx)(n.code,{children:'"0"'})," means infinity. This is specified using a\nlabel suffix like ",(0,i.jsx)(n.code,{children:'"30s"'})," or ",(0,i.jsx)(n.code,{children:'"1h"'}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"max_request_size"})," ",(0,i.jsx)(n.code,{children:"(int: 33554432)"})," \u2013 Specifies a hard maximum allowed\nrequest size, in bytes. Defaults to 32 MB if not set or set to ",(0,i.jsx)(n.code,{children:"0"}),".\nSpecifying a number less than ",(0,i.jsx)(n.code,{children:"0"})," turns off limiting altogether."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"max_request_duration"})," ",(0,i.jsx)(n.code,{children:'(string: "90s")'})," \u2013\xa0Specifies the maximum\nrequest duration allowed before OpenBao cancels the request. This overrides\n",(0,i.jsx)(n.code,{children:"default_max_request_duration"})," for this listener."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"proxy_protocol_behavior"})," ",(0,i.jsx)(n.code,{children:'(string: "")'})," \u2013 When specified, enables a PROXY\nprotocol version 1 behavior for the listener.\nAccepted Values:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"use_always"})," - The client's IP address will always be used."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"allow_authorized"})," - If the source IP address is in the\n",(0,i.jsx)(n.code,{children:"proxy_protocol_authorized_addrs"})," list, the client's IP address will be used.\nIf the source IP is not in the list, the source IP address will be used."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.em,{children:"deny_unauthorized"})," - The traffic will be rejected if the source IP\naddress is not in the ",(0,i.jsx)(n.code,{children:"proxy_protocol_authorized_addrs"})," list."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"proxy_protocol_authorized_addrs"})," ",(0,i.jsx)(n.code,{children:"(string: <required-if-enabled> or array: <required-if-enabled> )"})," \u2013\nSpecifies the list of allowed source IP addresses to be used with the PROXY protocol.\nNot required if ",(0,i.jsx)(n.code,{children:"proxy_protocol_behavior"})," is set to ",(0,i.jsx)(n.code,{children:"use_always"}),". Source IPs should\nbe comma-delimited if provided as a string. At least one source IP must be provided,\n",(0,i.jsx)(n.code,{children:"proxy_protocol_authorized_addrs"})," cannot be an empty array or string."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tls_disable"})," ",(0,i.jsx)(n.code,{children:'(string: "false")'})," \u2013 Specifies if TLS will be disabled. OpenBao\nassumes TLS by default, so you must explicitly disable TLS to opt-in to\ninsecure communication."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tls_cert_file"})," ",(0,i.jsx)(n.code,{children:"(string: <required-if-enabled>, reloads-on-SIGHUP)"})," \u2013\nSpecifies the path to the certificate for TLS. It requires a PEM-encoded file.\nTo configure the listener to use a CA certificate, concatenate the primary certificate and the CA\ncertificate together. The primary certificate should appear first in the\ncombined file. On ",(0,i.jsx)(n.code,{children:"SIGHUP"}),", the path set here ",(0,i.jsx)(n.em,{children:"at OpenBao startup"})," will be used\nfor reloading the certificate; modifying this value while OpenBao is running\nwill have no effect for ",(0,i.jsx)(n.code,{children:"SIGHUP"}),"s."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tls_key_file"})," ",(0,i.jsx)(n.code,{children:"(string: <required-if-enabled>, reloads-on-SIGHUP)"})," \u2013\nSpecifies the path to the private key for the certificate. It requires a PEM-encoded file.\nIf the key file is encrypted, you will be prompted to enter the passphrase on server startup.\nThe passphrase must stay the same between key files when reloading your\nconfiguration using ",(0,i.jsx)(n.code,{children:"SIGHUP"}),". On ",(0,i.jsx)(n.code,{children:"SIGHUP"}),", the path set here ",(0,i.jsx)(n.em,{children:"at OpenBao\nstartup"})," will be used for reloading the certificate; modifying this value\nwhile OpenBao is running will have no effect for ",(0,i.jsx)(n.code,{children:"SIGHUP"}),"s."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tls_min_version"})," ",(0,i.jsx)(n.code,{children:'(string: "tls12")'}),' \u2013 Specifies the minimum supported\nversion of TLS. Accepted values are "tls10", "tls11", "tls12" or "tls13".']}),"\n",(0,i.jsxs)(n.p,{children:["~> ",(0,i.jsx)(n.strong,{children:"Warning"}),": TLS 1.1 and lower (",(0,i.jsx)(n.code,{children:"tls10"})," and ",(0,i.jsx)(n.code,{children:"tls11"})," values for the\n",(0,i.jsx)(n.code,{children:"tls_min_version"})," and ",(0,i.jsx)(n.code,{children:"tls_max_version"})," parameters) are widely considered\ninsecure."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tls_max_version"})," ",(0,i.jsx)(n.code,{children:'(string: "tls13")'}),' \u2013 Specifies the maximum supported\nversion of TLS. Accepted values are "tls10", "tls11", "tls12" or "tls13".']}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["~> ",(0,i.jsx)(n.strong,{children:"Warning"}),": TLS 1.1 and lower (",(0,i.jsx)(n.code,{children:"tls10"})," and ",(0,i.jsx)(n.code,{children:"tls11"})," values for the\n",(0,i.jsx)(n.code,{children:"tls_min_version"})," and ",(0,i.jsx)(n.code,{children:"tls_max_version"})," parameters) are widely considered\ninsecure."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tls_cipher_suites"})," ",(0,i.jsx)(n.code,{children:'(string: "")'})," \u2013 Specifies the list of supported\nciphersuites as a comma-separated-list. The list of all available ciphersuites\nis available in the ",(0,i.jsx)(n.a,{href:"https://golang.org/src/crypto/tls/cipher_suites.go",children:"Golang TLS documentation"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["~> ",(0,i.jsx)(n.strong,{children:"Note"}),": Go only consults the ",(0,i.jsx)(n.code,{children:"tls_cipher_suites"})," list for TLSv1.2 and\nearlier; the order of ciphers is not important. For this parameter to be\neffective, the ",(0,i.jsx)(n.code,{children:"tls_max_version"})," property must be set to ",(0,i.jsx)(n.code,{children:"tls12"})," to prevent\nnegotiation of TLSv1.3, which is not recommended. For more information about\nthis and other TLS related changes, see the ",(0,i.jsx)(n.a,{href:"https://go.dev/blog/tls-cipher-suites",children:"Go TLS blog post"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tls_prefer_server_cipher_suites"})," ",(0,i.jsx)(n.code,{children:'(string: "false")'})," \u2013 Specifies to prefer the\nserver's ciphersuite over the client ciphersuites."]}),"\n",(0,i.jsxs)(n.p,{children:["~> ",(0,i.jsx)(n.strong,{children:"Warning"}),": The ",(0,i.jsx)(n.code,{children:"tls_prefer_server_cipher_suites"})," parameter is\ndeprecated. Setting it has no effect. See the above\n",(0,i.jsx)(n.a,{href:"https://go.dev/blog/tls-cipher-suites",children:"Go blog post"})," for more information about\nthis change."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tls_require_and_verify_client_cert"})," ",(0,i.jsx)(n.code,{children:'(string: "false")'})," \u2013 Turns on client\nauthentication for this listener; the listener will require a presented\nclient cert that successfully validates against system CAs."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tls_client_ca_file"})," ",(0,i.jsx)(n.code,{children:'(string: "")'})," \u2013 PEM-encoded Certificate Authority file\nused for checking the authenticity of client."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tls_disable_client_certs"})," ",(0,i.jsx)(n.code,{children:'(string: "false")'})," \u2013 Turns off client\nauthentication for this listener. The default behavior (when this is false)\nis for OpenBao to request client certificates when available."]}),"\n",(0,i.jsxs)(n.p,{children:["~> ",(0,i.jsx)(n.strong,{children:"Warning"}),": The ",(0,i.jsx)(n.code,{children:"tls_disable_client_certs"})," and ",(0,i.jsx)(n.code,{children:"tls_require_and_verify_client_cert"})," fields in the listener stanza of the OpenBao server configuration are mutually exclusive fields. Please ensure they are not both set to true. TLS client verification remains optional with default settings and is not enforced."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"x_forwarded_for_authorized_addrs"})," ",(0,i.jsx)(n.code,{children:"(string: <required-to-enable>)"})," \u2013\nSpecifies the list of source IP CIDRs for which an X-Forwarded-For header\nwill be trusted. Comma-separated list or JSON array. This turns on\nX-Forwarded-For support.  If for example OpenBao receives connections from the\nload balancer's IP of ",(0,i.jsx)(n.code,{children:"1.2.3.4"}),", adding ",(0,i.jsx)(n.code,{children:"1.2.3.4"})," to ",(0,i.jsx)(n.code,{children:"x_forwarded_for_authorized_addrs"}),"\nwill result in the ",(0,i.jsx)(n.code,{children:"remote_address"})," field in the audit log being populated with the\nconnecting client's IP, for example ",(0,i.jsx)(n.code,{children:"3.4.5.6"}),". Note this requires the load balancer\nto send the connecting client's IP in the ",(0,i.jsx)(n.code,{children:"X-Forwarded-For"})," header."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"x_forwarded_for_hop_skips"})," ",(0,i.jsx)(n.code,{children:'(string: "0")'})," \u2013 The number of addresses that will be\nskipped from the ",(0,i.jsx)(n.em,{children:"rear"})," of the set of hops. For instance, for a header value\nof ",(0,i.jsx)(n.code,{children:"1.2.3.4, 2.3.4.5, 3.4.5.6, 4.5.6.7"}),", if this value is set to ",(0,i.jsx)(n.code,{children:'"1"'}),", the address that\nwill be used as the originating client IP is ",(0,i.jsx)(n.code,{children:"3.4.5.6"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"x_forwarded_for_reject_not_authorized"})," ",(0,i.jsx)(n.code,{children:'(string: "true")'})," \u2013 If set false,\nif there is an X-Forwarded-For header in a connection from an unauthorized\naddress, the header will be ignored and the client connection used as-is,\nrather than the client connection rejected."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"x_forwarded_for_reject_not_present"})," ",(0,i.jsx)(n.code,{children:'(string: "true")'})," \u2013 If set false, if\nthere is no X-Forwarded-For header or it is empty, the client address will be\nused as-is, rather than the client connection rejected."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"telemetry-parameters",children:[(0,i.jsx)(n.code,{children:"telemetry"})," parameters"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"unauthenticated_metrics_access"})," ",(0,i.jsx)(n.code,{children:"(bool: false)"})," - If set to true, allows\nunauthenticated access to the ",(0,i.jsx)(n.code,{children:"/v1/sys/metrics"})," endpoint."]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"profiling-parameters",children:[(0,i.jsx)(n.code,{children:"profiling"})," parameters"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"unauthenticated_pprof_access"})," ",(0,i.jsx)(n.code,{children:"(bool: false)"})," - If set to true, allows\nunauthenticated access to the ",(0,i.jsx)(n.code,{children:"/v1/sys/pprof"})," endpoint."]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"inflight_requests_logging-parameters",children:[(0,i.jsx)(n.code,{children:"inflight_requests_logging"})," parameters"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"unauthenticated_in_flight_requests_access"})," ",(0,i.jsx)(n.code,{children:"(bool: false)"})," - If set to true, allows\nunauthenticated access to the ",(0,i.jsx)(n.code,{children:"/v1/sys/in-flight-req"})," endpoint."]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"custom_response_headers-parameters",children:[(0,i.jsx)(n.code,{children:"custom_response_headers"})," parameters"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"default"})," ",(0,i.jsx)(n.code,{children:"(key-value-map: {})"}),' - A map of string header names to an array of\nstring values. The default headers are set on all endpoints regardless of\nthe status code value. For an example, please refer to the\n"Configuring custom http response headers" section.']}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"<specific status code>"})," ",(0,i.jsx)(n.code,{children:"(key-value-map: {})"})," - A map of string header names\nto an array of string values. These headers are set only when the specific status\ncode is returned. For example, ",(0,i.jsx)(n.code,{children:'"200" = {"Header-A": ["Value1", "Value2"]}'}),", ",(0,i.jsx)(n.code,{children:'"Header-A"'}),"\nis set when the http response status code is ",(0,i.jsx)(n.code,{children:'"200"'}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"<collective status code>"})," ",(0,i.jsx)(n.code,{children:"(key-value-map: {})"})," - A map of string header names\nto an array of string values. These headers are set only when the response status\ncode falls under the collective status code.\nFor example, ",(0,i.jsx)(n.code,{children:'"2xx" = {"Header-A": ["Value1", "Value2"]}'}),", ",(0,i.jsx)(n.code,{children:'"Header-A"'}),"\nis set when the http response status code is ",(0,i.jsx)(n.code,{children:'"200"'}),", ",(0,i.jsx)(n.code,{children:'"204"'}),", etc."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"tcp-listener-examples",children:[(0,i.jsx)(n.code,{children:"tcp"})," listener examples"]}),"\n",(0,i.jsx)(n.h3,{id:"configuring-tls",children:"Configuring TLS"}),"\n",(0,i.jsx)(n.p,{children:"This example shows enabling a TLS listener."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'listener "tcp" {\n  tls_cert_file = "/etc/certs/openbao.crt"\n  tls_key_file  = "/etc/certs/openbao.key"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"listening-on-multiple-interfaces",children:"Listening on multiple interfaces"}),"\n",(0,i.jsx)(n.p,{children:"This example shows OpenBao listening on a private interface, as well as localhost."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'listener "tcp" {\n  address = "127.0.0.1:8200"\n}\n\nlistener "tcp" {\n  address = "10.0.0.5:8200"\n}\n\n# Advertise the non-loopback interface\napi_addr = "https://10.0.0.5:8200"\ncluster_addr = "https://10.0.0.5:8201"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"configuring-unauthenticated-metrics-access",children:"Configuring unauthenticated metrics access"}),"\n",(0,i.jsx)(n.p,{children:"This example shows enabling unauthenticated metrics access."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'listener "tcp" {\n  telemetry {\n    unauthenticated_metrics_access = true\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"configuring-unauthenticated-profiling-access",children:"Configuring unauthenticated profiling access"}),"\n",(0,i.jsx)(n.p,{children:"This example shows enabling unauthenticated profiling access."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'listener "tcp" {\n  profiling {\n    unauthenticated_pprof_access = true\n    unauthenticated_in_flight_request_access = true\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"configuring-custom-http-response-headers",children:"Configuring custom http response headers"}),"\n",(0,i.jsxs)(n.p,{children:["This example shows configuring custom http response headers.\nOperators can configure ",(0,i.jsx)(n.code,{children:'"custom_response_headers"'})," sub-stanza in the listener stanza to set custom http\nheaders appropriate to their applications. Examples of such headers are ",(0,i.jsx)(n.code,{children:'"Strict-Transport-Security"'}),"\nand ",(0,i.jsx)(n.code,{children:'"Content-Security-Policy"'})," which are known HTTP headers, and could be configured to harden\nthe security of an application communicating with the OpenBao endpoints. Note that vulnerability\nscans often examine such security related HTTP headers. In addition, application specific\ncustom headers can also be configured. For example, ",(0,i.jsx)(n.code,{children:'"X-Custom-Header"'})," has been configured\nin the example below."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'listener "tcp" {\n  custom_response_headers {\n    "default" = {\n      "Strict-Transport-Security" = ["max-age=31536000","includeSubDomains"],\n      "Content-Security-Policy" = ["connect-src https://clusterA.openbao.external/"],\n      "X-Custom-Header" = ["Custom Header Default Value"],\n    },\n    "2xx" = {\n      "Content-Security-Policy" = ["connect-src https://clusterB.openbao.external/"],\n      "X-Custom-Header" = ["Custom Header Value 1", "Custom Header Value 2"],\n    },\n    "301" = {\n      "Strict-Transport-Security" = ["max-age=31536000"],\n      "Content-Security-Policy" = ["connect-src https://clusterC.openbao.external/"],\n    },\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["In situations where a header is defined under several status code subsections,\nthe header matching the most specific response code will be returned. For example,\nwith the config example below, a ",(0,i.jsx)(n.code,{children:"307"})," response would return ",(0,i.jsx)(n.code,{children:"307 Custom header value"}),",\nwhile a ",(0,i.jsx)(n.code,{children:"306"})," would return ",(0,i.jsx)(n.code,{children:"3xx Custom header value"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'listener "tcp" {\n  custom_response_headers {\n    "default" = {\n       "X-Custom-Header" = ["default Custom header value"]\n    },\n    "3xx" = {\n       "X-Custom-Header" = ["3xx Custom header value"]\n    },\n    "307" = {\n       "X-Custom-Header" = ["307 Custom header value"]\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"listening-on-all-ipv6--ipv4-interfaces",children:"Listening on all IPv6 & IPv4 interfaces"}),"\n",(0,i.jsx)(n.p,{children:"This example shows OpenBao listening on all IPv4 & IPv6 interfaces including localhost."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'listener "tcp" {\n  address         = "[::]:8200"\n  cluster_address = "[::]:8201"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"listening-to-specific-ipv6-address",children:"Listening to specific IPv6 address"}),"\n",(0,i.jsxs)(n.p,{children:["This example shows OpenBao only using IPv6 and binding to the interface with the IP address: ",(0,i.jsx)(n.code,{children:"2001:1c04:90d:1c00:a00:27ff:fefa:58ec"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-hcl",children:'listener "tcp" {\n  address         = "[2001:1c04:90d:1c00:a00:27ff:fefa:58ec]:8200"\n  cluster_address = "[2001:1c04:90d:1c00:a00:27ff:fefa:58ec]:8201"\n}\n\n# Advertise the non-loopback interface\napi_addr = "https://[2001:1c04:90d:1c00:a00:27ff:fefa:58ec]:8200"\ncluster_addr = "https://[2001:1c04:90d:1c00:a00:27ff:fefa:58ec]:8201"\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>d});var i=s(96540);const r={},t=i.createContext(r);function c(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);