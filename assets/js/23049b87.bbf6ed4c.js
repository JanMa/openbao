"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6440],{46806:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>u,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>a,toc:()=>l});var s=t(74848),n=t(28453);const r={sidebar_label:"user-lockout",description:"The user_lockout stanza specifies various configurations for user lockout behaviour for\nfailed logins in OpenBao. "},i="User lockout",a={id:"configuration/user-lockout",title:"User lockout",description:"The user_lockout stanza specifies various configurations for user lockout behaviour for\nfailed logins in OpenBao. ",source:"@site/content/docs/configuration/user-lockout.mdx",sourceDirName:"configuration",slug:"/configuration/user-lockout",permalink:"/docs/configuration/user-lockout",draft:!1,unlisted:!1,editUrl:"https://github.com/openbao/openbao/tree/main/website/content/docs/configuration/user-lockout.mdx",tags:[],version:"current",frontMatter:{sidebar_label:"user-lockout",description:"The user_lockout stanza specifies various configurations for user lockout behaviour for\nfailed logins in OpenBao. "},sidebar:"docs",previous:{title:"ui",permalink:"/docs/configuration/ui"},next:{title:"Log completed requests",permalink:"/docs/configuration/log-requests-level"}},u={},l=[{value:"<code>user_lockout</code> stanza",id:"user_lockout-stanza",level:2},{value:"Configuration",id:"configuration",level:2},{value:"<code>user_lockout</code> parameters",id:"user_lockout-parameters",level:2}];function c(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.h1,{id:"user-lockout",children:"User lockout"}),"\n",(0,s.jsx)(o.p,{children:'If a user provides bad credentials several times in quick succession,\nOpenBao will stop trying to validate their credentials for a while, instead returning immediately\nwith a permission denied error. We call this behavior "user lockout". The time for which\na user will be locked out is called \u201clockout duration\u201d. The user will be able to login after the lockout\nduration has passed. The number of failed login attempts after which the user is locked out is called\n\u201clockout threshold\u201d. The lockout threshold counter is reset to zero after a few minutes without login attempts,\nor upon a successful login attempt. The duration after which the counter will be reset to zero\nafter no login attempts is called "lockout counter reset". This can defeat both automated and targeted requests\ni.e, user-based password guessing attacks as well as automated attacks.'}),"\n",(0,s.jsx)(o.p,{children:'The user lockout feature is enabled by default. The default values for "lockout threshold" is 5 attempts,\n"lockout duration" is 15 minutes, "lockout counter reset" is 15 minutes.'}),"\n",(0,s.jsx)(o.p,{children:"The user lockout feature can be disabled as follows:"}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:["It can be disabled globally using environment variable ",(0,s.jsx)(o.code,{children:"VAULT_DISABLE_USER_LOCKOUT"}),"."]}),"\n",(0,s.jsxs)(o.li,{children:["It can be disabled for all supported auth methods (ldap, userpass and approle) or a specific supported auth method using the ",(0,s.jsx)(o.code,{children:"disable_lockout"}),"\nparameter within ",(0,s.jsx)(o.code,{children:"user_lockout"})," stanza in configuration file.\nPlease see ",(0,s.jsx)(o.a,{href:"/docs/configuration/user-lockout#user_lockout-stanza",children:"user lockout configuration"})," for more details."]}),"\n",(0,s.jsxs)(o.li,{children:['It can be disabled for a specific auth mount using "auth tune". Please see ',(0,s.jsx)(o.a,{href:"/docs/commands/auth/tune",children:"auth tune command"}),"\nor ",(0,s.jsx)(o.a,{href:"/api-docs/system/auth#tune-auth-method",children:"auth tune api"})," for more details."]}),"\n"]}),"\n",(0,s.jsxs)(o.p,{children:["~> ",(0,s.jsx)(o.strong,{children:"NOTE"}),": This feature is only supported by the userpass, ldap, and approle auth methods."]}),"\n",(0,s.jsxs)(o.h2,{id:"user_lockout-stanza",children:[(0,s.jsx)(o.code,{children:"user_lockout"})," stanza"]}),"\n",(0,s.jsxs)(o.p,{children:["The ",(0,s.jsx)(o.code,{children:"user_lockout"}),' stanza specifies various configurations for user lockout\nbehaviour for failed logins in OpenBao. They can be configured for all supported auth methods\n(userpass, ldap and approle) using "all" user_lockout stanza name or for a specific auth method\nusing the auth method name in stanza.']}),"\n",(0,s.jsx)(o.p,{children:"Supported user_lockout stanza names are all, userpass, ldap and approle."}),"\n",(0,s.jsx)(o.p,{children:'The configurations for a specific auth method takes precedence over the configurations specified\nfor all auth methods using "all" user_lockout stanza name in the config file.'}),"\n",(0,s.jsx)(o.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsxs)(o.p,{children:["User lockouts configuration is done through the OpenBao configuration file using\nthe ",(0,s.jsx)(o.code,{children:"user_lockout"})," stanza:"]}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-hcl",children:"user_lockout [NAME] {\n  [PARAMETERS...]\n}\n"})}),"\n",(0,s.jsx)(o.p,{children:"For example:"}),"\n",(0,s.jsx)(o.pre,{children:(0,s.jsx)(o.code,{className:"language-hcl",children:'user_lockout "all" {\n  lockout_duration = "10m"\n  lockout_counter_reset = "10m"\n}\n\nuser_lockout "userpass" {\n  lockout_threshold = "25"\n  lockout_duration = "5m"\n}\n\nuser_lockout "ldap" {\n disable_lockout = "true"\n}\n'})}),"\n",(0,s.jsx)(o.p,{children:"Here, user lockout feature will be disabled for ldap auth methods. Userpass auth methods will have lockout threshold of 25,\nlockout duration of 5 minutes, lockout counter reset of 10 minutes. Approle auth methods will have a lockout threshold of\n5 (considers default as this value is not configured), lockout duration of 10 minutes and lockout counter reset of 10 minutes."}),"\n",(0,s.jsxs)(o.p,{children:["The user lockout configuration for the auth method at a given path can be tuned using auth tune. Please see ",(0,s.jsx)(o.a,{href:"/docs/commands/auth/tune",children:"auth tune command"}),"\nor ",(0,s.jsx)(o.a,{href:"/api-docs/system/auth#tune-auth-method",children:"auth tune api"})," for more details."]}),"\n",(0,s.jsxs)(o.h2,{id:"user_lockout-parameters",children:[(0,s.jsx)(o.code,{children:"user_lockout"})," parameters"]}),"\n",(0,s.jsx)(o.p,{children:"The following options are available on all user_lockout configurations."}),"\n",(0,s.jsxs)(o.ul,{children:["\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.code,{children:"lockout_threshold"})," ",(0,s.jsx)(o.code,{children:'(string: "")'})," - Specifies the number of failed login attempts after which the user is locked out."]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.code,{children:"lockout_duration"})," ",(0,s.jsx)(o.code,{children:'(string: "")'})," - Specifies the duration for which an user will be locked out."]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.code,{children:"lockout_counter_reset"})," ",(0,s.jsx)(o.code,{children:'(string: "")'})," - Specifies the duration after which the lockout counter is reset with no failed login attempts."]}),"\n",(0,s.jsxs)(o.li,{children:[(0,s.jsx)(o.code,{children:"disable_lockout"})," ",(0,s.jsx)(o.code,{children:"(bool: false)"})," - Disables the user lockout feature if set to true."]}),"\n"]})]})}function d(e={}){const{wrapper:o}={...(0,n.R)(),...e.components};return o?(0,s.jsx)(o,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,o,t)=>{t.d(o,{R:()=>i,x:()=>a});var s=t(96540);const n={},r=s.createContext(n);function i(e){const o=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function a(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:i(e.components),s.createElement(r.Provider,{value:o},e.children)}}}]);