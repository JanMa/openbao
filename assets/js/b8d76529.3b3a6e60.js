"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3050],{53515:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var r=n(74848),s=n(28453);const i={layout:"docs",page_title:"Telemetry",description:"Learn about the telemetry data available in OpenBao"},a="Telemetry",l={id:"internals/telemetry/index",title:"Telemetry",description:"Learn about the telemetry data available in OpenBao",source:"@site/content/docs/internals/telemetry/index.mdx",sourceDirName:"internals/telemetry",slug:"/internals/telemetry/",permalink:"/openbao/docs/internals/telemetry/",draft:!1,unlisted:!1,editUrl:"https://github.com/openbao/openbao/tree/main/website/content/docs/internals/telemetry/index.mdx",tags:[],version:"current",frontMatter:{layout:"docs",page_title:"Telemetry",description:"Learn about the telemetry data available in OpenBao"},sidebar:"docs",previous:{title:"Security model",permalink:"/openbao/docs/internals/security"},next:{title:"Enable OpenBao telemetry gathering",permalink:"/openbao/docs/internals/telemetry/enable-telemetry"}},o={},d=[{value:"Working with raw telemetry data",id:"working-with-raw-telemetry-data",level:2},{value:"Example raw telemetry dump",id:"example-raw-telemetry-dump",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h1,{id:"telemetry",children:"Telemetry"}),"\n",(0,r.jsxs)(t.p,{children:["The OpenBao server process collects various runtime metrics about the performance\nof different libraries and subsystems. These metrics are aggregated on a\n10-second interval and retained for one minute in memory. High-cardinality\nmetrics, like ",(0,r.jsx)(t.code,{children:"vault.kv.secret.count"}),", report every 10 minutes or at an interval\nconfigured with in the ",(0,r.jsx)(t.code,{children:"telemetry"})," stanza."]}),"\n",(0,r.jsx)(t.p,{children:"Telemetry from OpenBao must be streamed and stored in metrics aggregation\nsoftware to monitor OpenBao and collect durable metrics."}),"\n",(0,r.jsxs)(t.p,{children:["OpenBao uses the ",(0,r.jsx)(t.code,{children:"go-metrics"})," package to export telemetry and supports the\nfollowing aggregation agents for time-series monitoring:"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Config prefix"}),(0,r.jsx)(t.th,{children:"Name"}),(0,r.jsx)(t.th,{children:"Company"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"circonus"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://www.circonus.com",children:"Circonus"})}),(0,r.jsx)(t.td,{children:"Circonus"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"dogstatsd"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://docs.datadoghq.com/developers/dogstatsd",children:"DogStatsD"})}),(0,r.jsx)(t.td,{children:"Datadog"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"prometheus"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://prometheus.io",children:"Prometheus"})}),(0,r.jsx)(t.td,{children:"Prometheus / Open source"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"stackdriver"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://cloud.google.com/products/operations",children:"Cloud Operations"})}),(0,r.jsx)(t.td,{children:"Google"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"statsd"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://github.com/statsd/statsd/wiki",children:"Statsd"})}),(0,r.jsx)(t.td,{children:"Open source"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"statsite"})}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.a,{href:"https://github.com/statsite/statsite",children:"Statsite"})}),(0,r.jsx)(t.td,{children:"Open source"})]})]})]}),"\n",(0,r.jsx)(t.admonition,{title:"Start with key health metrics",type:"tip",children:(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.a,{href:"/well-architected-framework",children:"Well-Architected Framework"})," documentation\nincludes a best practices guide on\n",(0,r.jsx)(t.a,{href:"/well-architected-framework/reliability/reliability-vault-monitoring-key-metrics",children:"key OpenBao metrics for common health checks"}),".\nWe recommend reviewing the key metric recommendations to identify metrics you\nmay want to start monitoring immediately."]})}),"\n",(0,r.jsx)(t.h2,{id:"working-with-raw-telemetry-data",children:"Working with raw telemetry data"}),"\n",(0,r.jsxs)(t.p,{children:["You can view raw telemetry data for debugging purposes by interrupting the OpenBao\nprocess with ",(0,r.jsx)(t.code,{children:"USR1"})," (on *nix) or ",(0,r.jsx)(t.code,{children:"BREAK"})," (on Windows). When the OpenBao process\nreceives this signal, it dumps telemetry data for the last 10 seconds to\n",(0,r.jsx)(t.code,{children:"stderr"}),"."]}),"\n",(0,r.jsx)(t.p,{children:"Raw telemetry data is prefixed with the relevant metric type:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.code,{children:"[C]"})})," indicates the metric is a ",(0,r.jsx)(t.strong,{children:"counter"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.code,{children:"[G]"})})," indicates the metric is a ",(0,r.jsx)(t.strong,{children:"gauge"}),"."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.code,{children:"[S]"})})," indicates the metric is a ",(0,r.jsx)(t.strong,{children:"summary"}),"."]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"example-raw-telemetry-dump",children:"Example raw telemetry dump"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-text",children:"[2017-12-19 20:37:50 +0000 UTC][G] 'vault.7f320e57f9fe.expire.num_leases': 5100.000\n[2017-12-19 20:37:50 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.num_goroutines': 39.000\n[2017-12-19 20:37:50 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.sys_bytes': 222746880.000\n[2017-12-19 20:37:50 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.malloc_count': 109189192.000\n[2017-12-19 20:37:50 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.free_count': 108408240.000\n[2017-12-19 20:37:50 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.heap_objects': 780953.000\n[2017-12-19 20:37:50 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.total_gc_runs': 232.000\n[2017-12-19 20:37:50 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.alloc_bytes': 72954392.000\n[2017-12-19 20:37:50 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.total_gc_pause_ns': 150293024.000\n[2017-12-19 20:37:50 +0000 UTC][S] 'vault.merkle.flushDirty': Count: 100 Min: 0.008 Mean: 0.027 Max: 0.183 Stddev: 0.024 Sum: 2.681 LastUpdated: 2017-12-19 20:37:59.848733035 +0000 UTC m=+10463.692105920\n[2017-12-19 20:37:50 +0000 UTC][S] 'vault.merkle.saveCheckpoint': Count: 4 Min: 0.021 Mean: 0.054 Max: 0.110 Stddev: 0.039 Sum: 0.217 LastUpdated: 2017-12-19 20:37:57.048458148 +0000 UTC m=+10460.891835029\n[2017-12-19 20:38:00 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.alloc_bytes': 73326136.000\n[2017-12-19 20:38:00 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.sys_bytes': 222746880.000\n[2017-12-19 20:38:00 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.malloc_count': 109195904.000\n[2017-12-19 20:38:00 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.free_count': 108409568.000\n[2017-12-19 20:38:00 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.heap_objects': 786342.000\n[2017-12-19 20:38:00 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.total_gc_pause_ns': 150293024.000\n[2017-12-19 20:38:00 +0000 UTC][G] 'vault.7f320e57f9fe.expire.num_leases': 5100.000\n[2017-12-19 20:38:00 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.num_goroutines': 39.000\n[2017-12-19 20:38:00 +0000 UTC][G] 'vault.7f320e57f9fe.runtime.total_gc_runs': 232.000\n[2017-12-19 20:38:00 +0000 UTC][S] 'vault.route.rollback.consul-': Count: 1 Sum: 0.013 LastUpdated: 2017-12-19 20:38:01.968471579 +0000 UTC m=+10465.811842067\n[2017-12-19 20:38:00 +0000 UTC][S] 'vault.rollback.attempt.consul-': Count: 1 Sum: 0.073 LastUpdated: 2017-12-19 20:38:01.968502743 +0000 UTC m=+10465.811873131\n[2017-12-19 20:38:00 +0000 UTC][S] 'vault.rollback.attempt.pki-': Count: 1 Sum: 0.070 LastUpdated: 2017-12-19 20:38:01.96867005 +0000 UTC m=+10465.812041936\n[2017-12-19 20:38:00 +0000 UTC][S] 'vault.route.rollback.auth-app-id-': Count: 1 Sum: 0.012 LastUpdated: 2017-12-19 20:38:01.969146401 +0000 UTC m=+10465.812516689\n[2017-12-19 20:38:00 +0000 UTC][S] 'vault.rollback.attempt.identity-': Count: 1 Sum: 0.063 LastUpdated: 2017-12-19 20:38:01.968029888 +0000 UTC m=+10465.811400276\n[2017-12-19 20:38:00 +0000 UTC][S] 'vault.rollback.attempt.database-': Count: 1 Sum: 0.066 LastUpdated: 2017-12-19 20:38:01.969394215 +0000 UTC m=+10465.812764603\n[2017-12-19 20:38:00 +0000 UTC][S] 'vault.barrier.get': Count: 16 Min: 0.010 Mean: 0.015 Max: 0.031 Stddev: 0.005 Sum: 0.237 LastUpdated: 2017-12-19 20:38:01.983268118 +0000 UTC m=+10465.826637008\n[2017-12-19 20:38:00 +0000 UTC][S] 'vault.merkle.flushDirty': Count: 100 Min: 0.006 Mean: 0.024 Max: 0.098 Stddev: 0.019 Sum: 2.386 LastUpdated: 2017-12-19 20:38:09.848158309 +0000 UTC m=+10473.691527099\n"})})]})}function u(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>l});var r=n(96540);const s={},i=r.createContext(s);function a(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);