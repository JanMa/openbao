"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1569],{17399:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>h});var a=n(74848),t=n(28453);const o={sidebar_label:"Username and Password",description:'The "userpass" auth method allows users to authenticate with OpenBao using a username and password.'},i="Userpass auth method",r={id:"auth/userpass",title:"Userpass auth method",description:'The "userpass" auth method allows users to authenticate with OpenBao using a username and password.',source:"@site/content/docs/auth/userpass.mdx",sourceDirName:"auth",slug:"/auth/userpass",permalink:"/openbao/docs/auth/userpass",draft:!1,unlisted:!1,editUrl:"https://github.com/openbao/openbao/tree/main/website/content/docs/auth/userpass.mdx",tags:[],version:"current",frontMatter:{sidebar_label:"Username and Password",description:'The "userpass" auth method allows users to authenticate with OpenBao using a username and password.'},sidebar:"docs",previous:{title:"Tokens",permalink:"/openbao/docs/auth/token"},next:{title:"Overview",permalink:"/openbao/docs/audit/"}},l={},h=[{value:"Authentication",id:"authentication",level:2},{value:"Via the CLI",id:"via-the-cli",level:3},{value:"Via the API",id:"via-the-api",level:3},{value:"Configuration",id:"configuration",level:2},{value:"User lockout",id:"user-lockout",level:2},{value:"API",id:"api",level:2}];function u(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.h1,{id:"userpass-auth-method",children:"Userpass auth method"}),"\n",(0,a.jsxs)(s.p,{children:["The ",(0,a.jsx)(s.code,{children:"userpass"})," auth method allows users to authenticate with OpenBao using\na username and password combination."]}),"\n",(0,a.jsxs)(s.p,{children:["The username/password combinations are configured directly to the auth\nmethod using the ",(0,a.jsx)(s.code,{children:"users/"})," path. This method cannot read usernames and\npasswords from an external source."]}),"\n",(0,a.jsxs)(s.p,{children:["The method lowercases all submitted usernames, e.g. ",(0,a.jsx)(s.code,{children:"Mary"})," and ",(0,a.jsx)(s.code,{children:"mary"})," are the\nsame entry."]}),"\n",(0,a.jsx)(s.h2,{id:"authentication",children:"Authentication"}),"\n",(0,a.jsx)(s.h3,{id:"via-the-cli",children:"Via the CLI"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-shell-session",children:"$ bao login -method=userpass \\\n    username=mitchellh \\\n    password=foo\n"})}),"\n",(0,a.jsx)(s.h3,{id:"via-the-api",children:"Via the API"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-shell-session",children:'$ curl \\\n    --request POST \\\n    --data \'{"password": "foo"}\' \\\n    http://127.0.0.1:8200/v1/auth/userpass/login/mitchellh\n'})}),"\n",(0,a.jsxs)(s.p,{children:["The response will contain the token at ",(0,a.jsx)(s.code,{children:"auth.client_token"}),":"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-json",children:'{\n  "lease_id": "",\n  "renewable": false,\n  "lease_duration": 0,\n  "data": null,\n  "auth": {\n    "client_token": "c4f280f6-fdb2-18eb-89d3-589e2e834cdb",\n    "policies": ["admins"],\n    "metadata": {\n      "username": "mitchellh"\n    },\n    "lease_duration": 0,\n    "renewable": false\n  }\n}\n'})}),"\n",(0,a.jsx)(s.h2,{id:"configuration",children:"Configuration"}),"\n",(0,a.jsx)(s.p,{children:"Auth methods must be configured in advance before users or machines can\nauthenticate. These steps are usually completed by an operator or configuration\nmanagement tool."}),"\n",(0,a.jsxs)(s.ol,{children:["\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsx)(s.p,{children:"Enable the userpass auth method:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-shell-session",children:"$ bao auth enable userpass\n"})}),"\n",(0,a.jsxs)(s.p,{children:["This enables the userpass auth method at ",(0,a.jsx)(s.code,{children:"auth/userpass"}),". To enable it at a different path, use the ",(0,a.jsx)(s.code,{children:"-path"})," flag:"]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-shell-session",children:"$ bao auth enable -path=<path> userpass\n"})}),"\n"]}),"\n",(0,a.jsxs)(s.li,{children:["\n",(0,a.jsx)(s.p,{children:"Configure it with users that are allowed to authenticate:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-shell-session",children:"$ bao write auth/<userpass:path>/users/mitchellh \\\n    password=foo \\\n    policies=admins\n"})}),"\n",(0,a.jsx)(s.p,{children:'This creates a new user "mitchellh" with the password "foo" that will be\nassociated with the "admins" policy. This is the only configuration\nnecessary.'}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"user-lockout",children:"User lockout"}),"\n",(0,a.jsx)(s.p,{children:'If a user provides bad credentials several times in quick succession,\nOpenBao will stop trying to validate their credentials for a while, instead returning immediately\nwith a permission denied error. We call this behavior "user lockout". The time for which\na user will be locked out is called \u201clockout duration\u201d. The user will be able to login after the lockout\nduration has passed. The number of failed login attempts after which the user is locked out is called\n\u201clockout threshold\u201d. The lockout threshold counter is reset to zero after a few minutes without login attempts,\nor upon a successful login attempt. The duration after which the counter will be reset to zero\nafter no login attempts is called "lockout counter reset". This can defeat both automated and targeted requests\ni.e, user-based password guessing attacks as well as automated attacks.'}),"\n",(0,a.jsx)(s.p,{children:'The user lockout feature is enabled by default. The default values for "lockout threshold" is 5 attempts,\n"lockout duration" is 15 minutes, "lockout counter reset" is 15 minutes.'}),"\n",(0,a.jsx)(s.p,{children:"The user lockout feature can be disabled as follows:"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsxs)(s.li,{children:["It can be disabled globally using environment variable ",(0,a.jsx)(s.code,{children:"VAULT_DISABLE_USER_LOCKOUT"}),"."]}),"\n",(0,a.jsxs)(s.li,{children:["It can be disabled for all supported auth methods (ldap, userpass and approle) or a specific supported auth method using the ",(0,a.jsx)(s.code,{children:"disable_lockout"}),"\nparameter within ",(0,a.jsx)(s.code,{children:"user_lockout"})," stanza in configuration file.\nPlease see ",(0,a.jsx)(s.a,{href:"/docs/configuration/user-lockout#user_lockout-stanza",children:"user lockout configuration"})," for more details."]}),"\n",(0,a.jsxs)(s.li,{children:['It can be disabled for a specific auth mount using "auth tune". Please see ',(0,a.jsx)(s.a,{href:"/docs/commands/auth/tune",children:"auth tune command"}),"\nor ",(0,a.jsx)(s.a,{href:"/api-docs/system/auth#tune-auth-method",children:"auth tune api"})," for more details."]}),"\n"]}),"\n",(0,a.jsxs)(s.p,{children:["~> ",(0,a.jsx)(s.strong,{children:"NOTE"}),": This feature is only supported by the userpass, ldap, and approle auth methods."]}),"\n",(0,a.jsx)(s.h2,{id:"api",children:"API"}),"\n",(0,a.jsxs)(s.p,{children:["The Userpass auth method has a full HTTP API. Please see the ",(0,a.jsx)(s.a,{href:"/api-docs/auth/userpass",children:"Userpass auth\nmethod API"})," for more details."]})]})}function d(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>r});var a=n(96540);const t={},o=a.createContext(t);function i(e){const s=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),a.createElement(o.Provider,{value:s},e.children)}}}]);