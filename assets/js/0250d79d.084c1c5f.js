"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[374],{46981:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var t=s(74848),r=s(28453);const o={description:"The '/sys/remount' endpoint is used remount a mounted backend to a new endpoint."},a="Remount ( API )",i={id:"system/remount",title:"Remount ( API )",description:"The '/sys/remount' endpoint is used remount a mounted backend to a new endpoint.",source:"@site/content/api-docs/system/remount.mdx",sourceDirName:"system",slug:"/system/remount",permalink:"/api-docs/system/remount",draft:!1,unlisted:!1,editUrl:"https://github.com/openbao/openbao/tree/main/website/content/api-docs/system/remount.mdx",tags:[],version:"current",frontMatter:{description:"The '/sys/remount' endpoint is used remount a mounted backend to a new endpoint."},sidebar:"api",previous:{title:"/sys/rekey-recovery-key",permalink:"/api-docs/system/rekey-recovery-key"},next:{title:"/sys/rotate",permalink:"/api-docs/system/rotate"}},l={},d=[{value:"Move backend",id:"move-backend",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Sample payload ( cross namespace )",id:"sample-payload--cross-namespace-",level:3},{value:"Sample payload ( cross namespace, auth mount )",id:"sample-payload--cross-namespace-auth-mount-",level:3},{value:"Sample payload ( within namespace )",id:"sample-payload--within-namespace-",level:3},{value:"Sample request",id:"sample-request",level:3},{value:"Sample response",id:"sample-response",level:3},{value:"Monitor migration status",id:"monitor-migration-status",level:2},{value:"Parameters",id:"parameters-1",level:3},{value:"Sample request",id:"sample-request-1",level:3},{value:"Sample response",id:"sample-response-1",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"remount--api-",children:"Remount ( API )"}),"\n",(0,t.jsx)(n.p,{children:"The Remount documentation details the endpoints required to trigger and monitor the status of a remount operation."}),"\n",(0,t.jsx)(n.h2,{id:"move-backend",children:"Move backend"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"/sys/remount"})," endpoint moves an already-mounted backend to a new mount point. Remounting works for both secret\nengines and auth methods."]}),"\n",(0,t.jsxs)(n.p,{children:["OpenBao returns a migration ID when the remount operation completes. You\ncan use the migration ID to look up the status of the mount migration.\nMore details about the remount operation are described in\n",(0,t.jsx)(n.a,{href:"/docs/concepts/mount-migration",children:"Mount Migration"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["~> Note: This endpoint requires a policy with both ",(0,t.jsx)(n.code,{children:"sudo"})," and ",(0,t.jsx)(n.code,{children:"update"})," capabilities to ",(0,t.jsx)(n.code,{children:"sys/remount"})]}),"\n",(0,t.jsx)(n.p,{children:"~> Note: A mount migration will revoke all leases for the secrets of a secrets backend or tokens of an auth backend,\ndepending on which type of backend is being moved."}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{style:{textAlign:"left"},children:"Method"}),(0,t.jsx)(n.th,{style:{textAlign:"left"},children:"Path"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:(0,t.jsx)(n.code,{children:"POST"})}),(0,t.jsx)(n.td,{style:{textAlign:"left"},children:(0,t.jsx)(n.code,{children:"/sys/remount"})})]})})]}),"\n",(0,t.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"from"})," ",(0,t.jsx)(n.code,{children:"(string: <required>)"})," \u2013\xa0Specifies the previous mount point."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"to"})," ",(0,t.jsx)(n.code,{children:"(string: <required>)"})," \u2013\xa0Specifies the new destination mount point."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"sample-payload--cross-namespace-",children:"Sample payload ( cross namespace )"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "from": "ns1/ns2/secret",\n  "to": "ns1/ns3/new-secret"\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"sample-payload--cross-namespace-auth-mount-",children:"Sample payload ( cross namespace, auth mount )"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "from": "ns1/ns2/auth/approle",\n  "to": "ns1/ns3/auth/new-approle"\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"sample-payload--within-namespace-",children:"Sample payload ( within namespace )"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "from": "secret",\n  "to": "new-secret"\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"sample-request",children:"Sample request"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell-session",children:'$ curl \\\n    --header "X-Vault-Token: ..." \\\n    --request POST \\\n    --data @payload.json \\\n    http://127.0.0.1:8200/v1/sys/remount\n'})}),"\n",(0,t.jsx)(n.h3,{id:"sample-response",children:"Sample response"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "migration_id": "ef3ba21c-8be8-4e5f-8d00-cb46a532c665"\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"monitor-migration-status",children:"Monitor migration status"}),"\n",(0,t.jsxs)(n.p,{children:["This endpoint is used to monitor the status of a mount migration operation, using the ID returned in the response\nof the ",(0,t.jsx)(n.code,{children:"sys/remount"})," call. The response contains the passed-in ID, the source and target mounts, and a status field\nthat displays ",(0,t.jsx)(n.code,{children:"in-progress"}),", ",(0,t.jsx)(n.code,{children:"success"})," or ",(0,t.jsx)(n.code,{children:"failure"}),"."]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{style:{textAlign:"left"},children:"Method"}),(0,t.jsx)(n.th,{style:{textAlign:"left"},children:"Path"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"left"},children:(0,t.jsx)(n.code,{children:"GET"})}),(0,t.jsx)(n.td,{style:{textAlign:"left"},children:(0,t.jsx)(n.code,{children:"/sys/remount/status/:migration_id"})})]})})]}),"\n",(0,t.jsx)(n.h3,{id:"parameters-1",children:"Parameters"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"migration_id"})," ",(0,t.jsx)(n.code,{children:"(string: <required>)"})," \u2013\xa0Specifies the id of the mount migration"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"sample-request-1",children:"Sample request"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell-session",children:'$ curl \\\n    --header "X-Vault-Token: ..." \\\n    http://127.0.0.1:8200/v1/sys/remount/status/ef3ba21c-8be8-4e5f-8d00-cb46a532c665\n'})}),"\n",(0,t.jsx)(n.h3,{id:"sample-response-1",children:"Sample response"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "migration_id": "ef3ba21c-8be8-4e5f-8d00-cb46a532c665",\n  "migration_info": {\n    "source_mount": "ns1/ns2/secret",\n    "target_mount": "ns1/ns3/new-secret",\n    "status": "in-progress",\n  }\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>i});var t=s(96540);const r={},o=t.createContext(r);function a(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);