"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[8568],{41856:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>d,toc:()=>o});var n=s(74848),i=s(28453);const l={sidebar_label:"Considerations",description:"The PKI secrets engine for OpenBao generates TLS certificates."},r="PKI secrets engine - considerations",d={id:"secrets/pki/considerations",title:"PKI secrets engine - considerations",description:"The PKI secrets engine for OpenBao generates TLS certificates.",source:"@site/content/docs/secrets/pki/considerations.mdx",sourceDirName:"secrets/pki",slug:"/secrets/pki/considerations",permalink:"/openbao/docs/secrets/pki/considerations",draft:!1,unlisted:!1,editUrl:"https://github.com/openbao/openbao/tree/main/website/content/docs/secrets/pki/considerations.mdx",tags:[],version:"current",frontMatter:{sidebar_label:"Considerations",description:"The PKI secrets engine for OpenBao generates TLS certificates."},sidebar:"docs",previous:{title:"Quick Start - Intermediate CA Setup",permalink:"/openbao/docs/secrets/pki/quick-start-intermediate-ca"},next:{title:"Troubleshooting ACME integration",permalink:"/openbao/docs/secrets/pki/troubleshooting-acme"}},a={},o=[{value:"Table of contents",id:"table-of-contents",level:2},{value:"Be careful with root CAs",id:"be-careful-with-root-cas",level:2},{value:"One CA certificate, one secrets engine",id:"one-ca-certificate-one-secrets-engine",level:2},{value:"Always configure a default issuer",id:"always-configure-a-default-issuer",level:3},{value:"Key types matter",id:"key-types-matter",level:2},{value:"Cluster performance and key type",id:"cluster-performance-and-key-type",level:3},{value:"Use a CA hierarchy",id:"use-a-ca-hierarchy",level:2},{value:"Cross-Signed intermediates",id:"cross-signed-intermediates",level:3},{value:"Cluster URLs are important",id:"cluster-urls-are-important",level:2},{value:"Automate rotation with ACME",id:"automate-rotation-with-acme",level:2},{value:"ACME stores certificates",id:"acme-stores-certificates",level:3},{value:"ACME role restrictions require EAB",id:"acme-role-restrictions-require-eab",level:3},{value:"ACME and the public internet",id:"acme-and-the-public-internet",level:3},{value:"ACME errors are in server logs",id:"acme-errors-are-in-server-logs",level:3},{value:"ACME security considerations",id:"acme-security-considerations",level:3},{value:"Keep certificate lifetimes short, for CRL&#39;s sake",id:"keep-certificate-lifetimes-short-for-crls-sake",level:2},{value:"NotAfter behavior on leaf certificates",id:"notafter-behavior-on-leaf-certificates",level:3},{value:"Cluster performance and quantity of leaf certificates",id:"cluster-performance-and-quantity-of-leaf-certificates",level:3},{value:"You must configure issuing/CRL/OCSP information <em>in advance</em>",id:"you-must-configure-issuingcrlocsp-information-in-advance",level:2},{value:"Distribution of CRLs and OCSP",id:"distribution-of-crls-and-ocsp",level:2},{value:"Automate CRL building and tidying",id:"automate-crl-building-and-tidying",level:2},{value:"Spectrum of revocation support",id:"spectrum-of-revocation-support",level:2},{value:"Automate leaf certificate renewal",id:"automate-leaf-certificate-renewal",level:2},{value:"Safe minimums",id:"safe-minimums",level:2},{value:"Token lifetimes and revocation",id:"token-lifetimes-and-revocation",level:2},{value:"Safe usage of roles",id:"safe-usage-of-roles",level:2},{value:"Telemetry",id:"telemetry",level:2},{value:"Auditing",id:"auditing",level:2},{value:"Role-Based access",id:"role-based-access",level:2},{value:"Cluster scalability",id:"cluster-scalability",level:2},{value:"PSS support",id:"pss-support",level:2},{value:"Tutorial",id:"tutorial",level:2},{value:"API",id:"api",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"pki-secrets-engine---considerations",children:"PKI secrets engine - considerations"}),"\n",(0,n.jsxs)(t.p,{children:["To successfully deploy this secrets engine, there are a number of important\nconsiderations to be aware of, as well as some preparatory steps that should be\nundertaken. You should read all of these ",(0,n.jsx)(t.em,{children:"before"})," using this secrets engine or\ngenerating the CA to use with this secrets engine."]}),"\n",(0,n.jsx)(t.h2,{id:"table-of-contents",children:"Table of contents"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#be-careful-with-root-cas",children:"Be Careful with Root CAs"})}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"#one-ca-certificate-one-secrets-engine",children:"One CA Certificate, One Secrets Engine"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#always-configure-a-default-issuer",children:"Always Configure a Default Issuer"})}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"#key-types-matter",children:"Key Types Matter"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#cluster-performance-and-key-types",children:"Cluster Performance and Key Types"})}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"#use-a-ca-hierarchy",children:"Use a CA Hierarchy"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#cross-signed-intermediates",children:"Cross-Signed Intermediates"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#cluster-urls-are-important",children:"Cluster URLs are Important"})}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"#automate-rotation-with-acme",children:"Automate Rotation with ACME"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#acme-stores-certificates",children:"ACME Stores Certificates"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#acme-role-restrictions-require-eab",children:"ACME Role Restrictions Require EAB"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#acme-and-the-public-internet",children:"ACME and the Public Internet"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#acme-errors-are-in-server-logs",children:"ACME Errors are in Server Logs"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#acme-security-considerations",children:"ACME Security Considerations"})}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"#keep-certificate-lifetimes-short-for-crls-sake",children:"Keep Certificate Lifetimes Short, For CRL's Sake"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#notafter-behavior-on-leaf-certificates",children:"NotAfter Behavior on Leaf Certificates"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#cluster-performance-and-quantity-of-leaf-certificates",children:"Cluster Performance and Quantity of Leaf Certificates"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsxs)(t.a,{href:"#you-must-configure-issuingcrlocsp-information-_in-advance_",children:["You must configure issuing/CRL/OCSP information ",(0,n.jsx)(t.em,{children:"in advance"})]})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#distribution-of-crls-ocsp",children:"Distribution of CRLs and OCSP"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#automate-crl-building-and-tidying",children:"Automate CRL Building and Tidying"})}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"#spectrum-of-revocation-support",children:"Spectrum of Revocation Support"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#what-are-cross-cluster-crls",children:"What Are Cross-Cluster CRLs?"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#issuer-subjects-and-crls",children:"Issuer Subjects and CRLs"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#automate-leaf-certificate-renewal",children:"Automate Leaf Certificate Renewal"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#safe-minimums",children:"Safe Minimums"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#token-lifetimes-and-revocation",children:"Token Lifetimes and Revocation"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#safe-usage-of-roles",children:"Safe Usage of Roles"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#telemetry",children:"Telemetry"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#auditing",children:"Auditing"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#role-based-access",children:"Role-Based Access"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#replicated-datasets",children:"Replicated DataSets"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#cluster-scalability",children:"Cluster Scalability"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#pss-support",children:"PSS Support"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"#issuer-storage-migration-issues",children:"Issuer Storage Migration Issues"})}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"be-careful-with-root-cas",children:"Be careful with root CAs"}),"\n",(0,n.jsx)(t.p,{children:"OpenBao storage is secure, but not as secure as a piece of paper in a bank vault.\nIt is, after all, networked software. If your root CA is hosted outside of\nOpenBao, don't put it in OpenBao as well; instead, issue a shorter-lived\nintermediate CA certificate and put this into OpenBao. This aligns with industry\nbest practices."}),"\n",(0,n.jsxs)(t.p,{children:["Since 0.4, the secrets engine supports generating self-signed root CAs and\ncreating and signing CSRs for intermediate CAs. In each instance, for security\nreasons, the private key can ",(0,n.jsx)(t.em,{children:"only"})," be exported at generation time, and the\nability to do so is part of the command path (so it can be put into ACL\npolicies)."]}),"\n",(0,n.jsxs)(t.p,{children:["If you plan on using intermediate CAs with OpenBao, it is suggested that you let\nOpenBao create CSRs and do not export the private key, then sign those with your\nroot CA (which may be a second mount of the ",(0,n.jsx)(t.code,{children:"pki"})," secrets engine)."]}),"\n",(0,n.jsx)(t.h2,{id:"one-ca-certificate-one-secrets-engine",children:"One CA certificate, one secrets engine"}),"\n",(0,n.jsxs)(t.p,{children:["The PKI Secrets Engine supports multiple issuers in a single mount. However, in\norder to simplify the configuration, it is ",(0,n.jsx)(t.em,{children:"strongly"})," recommended that operators\nlimit a mount to a single issuer. If you want to issue certificates from\nmultiple disparate CAs, mount the PKI secrets engine at multiple mount points\nwith separate CA certificates in each."]}),"\n",(0,n.jsx)(t.p,{children:"The rationale for separating mounts is to simplify permissions management:\nvery few individuals need access to perform operations with the root, but\nmany need access to create leaves. The operations on a root should generally\nbe limited to issuing and revoking intermediate CAs, which is a highly\nprivileged operation; it becomes much easier to audit these operations when\nthey're in a separate mount than if they're mixed in with day-to-day leaf\nissuance."}),"\n",(0,n.jsx)(t.p,{children:"A common pattern is to have one mount act as your root CA and to use this CA\nonly to sign intermediate CA CSRs from other PKI secrets engines."}),"\n",(0,n.jsx)(t.p,{children:"To keep old CAs active, there's two approaches to achieving rotation:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"Use multiple secrets engines. This allows a fresh start, preserving the\nold issuer and CRL. OpenBao ACL policy can be updated to deny new issuance\nunder the old mount point and roles can be re-evaluated before being\nimported into the new mount point."}),"\n",(0,n.jsx)(t.li,{children:"Use multiple issuers in the same mount point. The usage of the old issuer\ncan be restricted to CRL signing, and existing roles and ACL policy can be\nkept as-is. This allows cross-signing within the same mount, and consumers\nof the mount won't have to update their configuration. Once the transitional\nperiod for this rotation has completed and all past issued certificate have\nexpired, it is encouraged to fully remove the old issuer and any unnecessary\ncross-signed issuers from the mount point."}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Another suggested use case for multiple issuers in the same mount is splitting\nissuance by TTL lifetime. For short-lived certificates, an intermediate\nstored in OpenBao will often out-perform a HSM-backed intermediate. For\nlonger-lived certificates, however, it is often important to have the\nintermediate key material secured throughout the lifetime of the end-entity\ncertificate. This means that two intermediates in the same mount -- one backed\nby the HSM and one backed by OpenBao -- can satisfy both use cases. Operators\ncan make roles setting maximum TTLs for each issuer and consumers of the\nmount can decide which to use."}),"\n",(0,n.jsx)(t.h3,{id:"always-configure-a-default-issuer",children:"Always configure a default issuer"}),"\n",(0,n.jsxs)(t.p,{children:["For backwards compatibility, ",(0,n.jsx)(t.a,{href:"/api-docs/secret/pki#read-issuers-configuration",children:"the default issuer"}),"\nis used to service PKI endpoints without an explicit issuer (either via path\nselection or role-based selection). When certificates are revoked and their\nissuer is no longer part of this PKI mount, OpenBao places them on the default\nissuer's CRL. This means maintaining a default issuer is important for both\nbackwards compatibility for issuing certificates and for ensuring revoked\ncertificates land on a CRL."]}),"\n",(0,n.jsx)(t.h2,{id:"key-types-matter",children:"Key types matter"}),"\n",(0,n.jsxs)(t.p,{children:["Certain key types have impacts on performance. Signing certificates from a RSA\nkey will be slower than issuing from an ECDSA or Ed25519 key. Key generation\n(using ",(0,n.jsx)(t.code,{children:"/issue/:role"})," endpoints) using RSA keys will also be slow: RSA key\ngeneration involves finding suitable random primes, whereas Ed25519 keys can\nbe random data. As the number of bits goes up (RSA 2048 -> 4096 or ECDSA\nP-256 -> P-521), signature times also increases."]}),"\n",(0,n.jsx)(t.p,{children:"This matters in both directions: not only is issuance more expensive,\nbut validation of the corresponding signature (in say, TLS handshakes) will\nalso be more expensive. Careful consideration of both issuer and issued key\ntypes can have meaningful impacts on performance of not only OpenBao, but\nsystems using these certificates."}),"\n",(0,n.jsx)(t.h3,{id:"cluster-performance-and-key-type",children:"Cluster performance and key type"}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.a,{href:"https://github.com/hashicorp/vault-benchmark",children:"benchmark-vault"})," project\ncan be used to measure the performance of an OpenBao PKI instance. In general,\nsome considerations to be aware of:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"RSA key generation is much slower and highly variable than EC key\ngeneration. If performance and throughput are a necessity, consider using\nEC keys (including NIST P-curves and Ed25519) instead of RSA."}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:["Key signing requests (via ",(0,n.jsx)(t.code,{children:"/pki/sign"}),") will be faster than (",(0,n.jsx)(t.code,{children:"/pki/issue"}),"),\nespecially for RSA keys: this removes the necessity for OpenBao to generate\nkey material and can sign the key material provided by the client. This\nsigning step is common between both endpoints, so key generation is pure\noverhead if the client has a sufficiently secure source of entropy."]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"The CA's key type matters as well: using a RSA CA will result in a RSA\nsignature and takes longer than a ECDSA or Ed25519 CA."}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsxs)(t.p,{children:["Storage is an important factor: with ",(0,n.jsx)(t.a,{href:"/api-docs/secret/pki#revoke-certificate",children:"BYOC Revocation"}),",\nusing ",(0,n.jsx)(t.code,{children:"no_store=true"})," still gives you the ability to revoke certificates\nand audit logs can be used to track issuance. Clusters using a remote\nstorage over a slow network and using ",(0,n.jsx)(t.code,{children:"no_store=false"})," will\nresult in additional latency on issuance. Adding leases for every issued\ncertificate compounds the problem."]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Storing too many certificates results in longer ",(0,n.jsx)(t.code,{children:"LIST /pki/certs"})," time,\nincluding the time to tidy the instance. As such, for large scale\ndeployments (>= 250k active certificates) it is recommended to use audit\nlogs to track certificates outside of OpenBao."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["As a general comparison on unspecified hardware, using ",(0,n.jsx)(t.code,{children:"benchmark-vault"})," for\n",(0,n.jsx)(t.code,{children:"30s"})," on a local, single node, raft-backed OpenBao instance:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"OpenBao can issue 300k certificates using EC P-256 for CA & leaf keys and\nwithout storage."}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"But switching to storing these leaves drops that number to 65k, and only\n20k with leases."}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Using large, expensive RSA-4096 bit keys, OpenBao can only issue 160 leaves,\nregardless of whether or not storage or leases were used. The 95% key\ngeneration time is above 10s."}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"In comparison, using P-521 keys, OpenBao can issue closer to 30k leaves\nwithout leases and 18k with leases."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"These numbers are for example only, to represent the impact different key types\ncan have on PKI cluster performance."}),"\n",(0,n.jsx)(t.p,{children:"The use of ACME adds additional latency into these numbers, both because\ncertificates need to be stored and because challenge validation needs to\nbe performed."}),"\n",(0,n.jsx)(t.h2,{id:"use-a-ca-hierarchy",children:"Use a CA hierarchy"}),"\n",(0,n.jsx)(t.p,{children:"It is generally recommended to use a hierarchical CA setup, with a root\ncertificate which issues one or more intermediates (based on usage), which\nin turn issue the leaf certificates."}),"\n",(0,n.jsxs)(t.p,{children:["This allows stronger storage or policy guarantees around ",(0,n.jsx)(t.a,{href:"#be-careful-with-root-cas",children:"protection of the\nroot CA"}),", while letting OpenBao manage the\nintermediate CAs and issuance of leaves. Different intermediates might be\nissued for different usage, such as VPN signing, Email signing, or testing\nversus production TLS services. This helps to keep CRLs limited to specific\npurposes: for example, VPN services don't care about the revoked set of\nemail signing certificates if they're using separate certificates and\ndifferent intermediates, and thus don't need both CRL contents. Additionally,\nthis allows higher risk intermediates (such as those issuing longer-lived\nemail signing certificates) to have HSM-backing without impacting the\nperformance of easier-to-rotate intermediates and certificates (such as\nTLS intermediates)."]}),"\n",(0,n.jsxs)(t.p,{children:["OpenBao supports the use of both the ",(0,n.jsxs)(t.a,{href:"/api-docs/secret/pki#allowed_domains",children:[(0,n.jsx)(t.code,{children:"allowed_domains"})," parameter on\nRoles"]})," and the ",(0,n.jsxs)(t.a,{href:"/api-docs/secret/pki#permitted_dns_domains",children:[(0,n.jsx)(t.code,{children:"permitted_dns_domains"}),"\nparameter to set the Name Constraints extension"]}),"\non root and intermediate generation. This allows for several layers of\nseparation of concerns between TLS-based services."]}),"\n",(0,n.jsx)(t.h3,{id:"cross-signed-intermediates",children:"Cross-Signed intermediates"}),"\n",(0,n.jsxs)(t.p,{children:["When cross-signing intermediates from two separate roots, two separate\nintermediate issuers will exist within the OpenBao PKI mount. In order to\ncorrectly serve the cross-signed chain on issuance requests, the\n",(0,n.jsx)(t.code,{children:"manual_chain"})," override is required on either or both intermediates. This\ncan be constructed in the following order:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["this issuer (",(0,n.jsx)(t.code,{children:"self"}),")"]}),"\n",(0,n.jsx)(t.li,{children:"this root"}),"\n",(0,n.jsx)(t.li,{children:"the other copy of this intermediate"}),"\n",(0,n.jsx)(t.li,{children:"the other root"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"All requests to this issuer for signing will now present the full cross-signed\nchain."}),"\n",(0,n.jsx)(t.h2,{id:"cluster-urls-are-important",children:"Cluster URLs are important"}),"\n",(0,n.jsxs)(t.p,{children:["ACME support uses the same configuration as ",(0,n.jsx)(t.a,{href:"/api-docs/secret/pki#enable_aia_url_templating-1",children:"templated AIA\nURLs"}),"to allow ACME\nclients to discover the URL of this cluster."]}),"\n",(0,n.jsx)(t.admonition,{type:"warning",children:(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Warning"}),": It is important to ensure that this configuration is\nup to date and maintained correctly, always pointing to the node's cluster\naddress (which may be a Load Balanced or a DNS Round-Robbin address). If this\nconfiguration is not set on every node, certificate issuance (via REST and/or\nvia ACME) will fail."]})}),"\n",(0,n.jsx)(t.h2,{id:"automate-rotation-with-acme",children:"Automate rotation with ACME"}),"\n",(0,n.jsxs)(t.p,{children:["The PKI Engine supports the ",(0,n.jsx)(t.a,{href:"https://datatracker.ietf.org/doc/html/rfc8555",children:"Automatic Certificate Management Environment\n(ACME)"})," protocol. This is a\nstandardized way to handle validation, issuance, rotation, and revocation of\nserver certificates."]}),"\n",(0,n.jsx)(t.p,{children:"Many ecosystems, from web servers like Caddy, Nginx, and Apache, to\norchestration environments like Kubernetes (via cert-manager) natively\nsupport issuance via the ACME protocol. For deployments without native\nsupport, stand-alone tools like certbot support fetching and renewing\ncertificates on behalf of consumers. OpenBao's PKI Engine only includes server\nsupport for ACME; no client functionality has been included."}),"\n",(0,n.jsx)(t.admonition,{type:"warning",children:(0,n.jsxs)(t.p,{children:["Note: OpenBao's PKI ACME server caps the certificate's validity at 90 days\nmaximum, regardless of role and/or global limits. Shorter validity\ndurations can be set via limiting the role's TTL to be under 90 days.\nAligning with Let's Encrypt, we do not support the optional ",(0,n.jsx)(t.code,{children:"NotBefore"}),"\nand ",(0,n.jsx)(t.code,{children:"NotAfter"})," order request parameters."]})}),"\n",(0,n.jsx)(t.h3,{id:"acme-stores-certificates",children:"ACME stores certificates"}),"\n",(0,n.jsxs)(t.p,{children:["Because ACME requires stored certificates in order to function, the notes\n",(0,n.jsx)(t.a,{href:"#automate-crl-building-and-tidying",children:"below about automating tidy"})," are\nespecially important for the long-term health of the PKI cluster. ACME also\nintroduces additional resource types (accounts, orders, authorizations, and\nchallenges) that must be tidied via ",(0,n.jsxs)(t.a,{href:"/api-docs/secret/pki#tidy",children:["the ",(0,n.jsx)(t.code,{children:"tidy_acme=true"}),"\noption"]}),". Orders, authorizations, and\nchallenges are ",(0,n.jsxs)(t.a,{href:"/api-docs/secret/pki#safety_buffer",children:["cleaned up based on the\n",(0,n.jsx)(t.code,{children:"safety_buffer"})]}),"\nparameter, but accounts can live longer past their last issued certificate\nby controlling the ",(0,n.jsxs)(t.a,{href:"/api-docs/secret/pki#acme_account_safety_buffer",children:[(0,n.jsx)(t.code,{children:"acme_account_safety_buffer"}),"\nparameter"]}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["As a consequence of the above, and like the discussions in the ",(0,n.jsx)(t.a,{href:"#cluster-scalability",children:"Cluster\nScalability"})," section, because these roles have\n",(0,n.jsx)(t.code,{children:"no_store=false"})," set, ACME can only issue certificates on the active nodes\nof PR clusters; standby nodes, if contacted, will transparently forward\nall requests to the active node."]}),"\n",(0,n.jsx)(t.h3,{id:"acme-role-restrictions-require-eab",children:"ACME role restrictions require EAB"}),"\n",(0,n.jsx)(t.p,{children:"Because ACME by default has no external authorization engine and is\nunauthenticated from an OpenBao perspective, the use of roles with ACME\nin the default configuration are of limited value as any ACME client\ncan request certificates under any role by proving possession of the\nrequested certificate identifiers."}),"\n",(0,n.jsx)(t.p,{children:"To solve this issue, there are two possible approaches:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["Use a restrictive ",(0,n.jsxs)(t.a,{href:"/api-docs/secret/pki#set-acme-configuration",children:[(0,n.jsx)(t.code,{children:"allowed_roles"}),", ",(0,n.jsx)(t.code,{children:"allowed_issuers"}),", and\n",(0,n.jsx)(t.code,{children:"default_directory_policy"})," ACME\nconfiguration"]}),"\nto let only a single role and issuer be used. This prevents user\nchoice, allowing some global restrictions to be placed on issuance\nand avoids requiring ACME clients to have (at initial setup) access\nto an OpenBao token other mechanism for acquiring an OpenBao EAB ACME token."]}),"\n",(0,n.jsxs)(t.li,{children:["Use a more permissive ",(0,n.jsxs)(t.a,{href:"/api-docs/secret/pki#eab_policy",children:["configuration with\n",(0,n.jsx)(t.code,{children:"eab_policy=always-required"})]}),"\nto allow more roles and users to select the roles, but bind ACME clients\nto an OpenBao token which can be suitably ACL'd to particular sets of\napproved ACME directories."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"The choice of approach depends on the policies of the organization wishing\nto use ACME."}),"\n",(0,n.jsx)(t.p,{children:"Another consequence of the OpenBao unauthenticated nature of ACME requests\nare that role templating, based on entity information, cannot be used as\nthere is no token and thus no entity associated with the request, even when\nEAB binding is used."}),"\n",(0,n.jsx)(t.h3,{id:"acme-and-the-public-internet",children:"ACME and the public internet"}),"\n",(0,n.jsxs)(t.p,{children:["Using ACME is possible over the public internet; public CAs like Let's Encrypt\noffer this as a service. Similarly, organizations running internal PKI\ninfrastructure might wish to issue server certificates to pieces of\ninfrastructure outside of their internal network boundaries, from a publicly\naccessible OpenBao instance. By default, without enforcing a restrictive\n",(0,n.jsx)(t.code,{children:"eab_policy"}),", this results in a complicated threat model: ",(0,n.jsx)(t.em,{children:"any"})," external\nclient which can prove possession of a domain can issue a certificate under\nthis CA, which might be considered more trusted by this organization."]}),"\n",(0,n.jsxs)(t.p,{children:["As such, we strongly recommend publicly facing OpenBao instances enforce that\nPKI mount operators have required a ",(0,n.jsxs)(t.a,{href:"/api-docs/secret/pki#eab_policy",children:["restrictive ",(0,n.jsx)(t.code,{children:"eab_policy=always-required"}),"\nconfiguration"]}),".  System administrators of\nOpenBao instances can enforce this by ",(0,n.jsxs)(t.a,{href:"/api-docs/secret/pki#acme-external-account-bindings",children:["setting the\n",(0,n.jsx)(t.code,{children:"VAULT_DISABLE_PUBLIC_ACME=true"})," environment\nvariable"]}),"."]}),"\n",(0,n.jsx)(t.h3,{id:"acme-errors-are-in-server-logs",children:"ACME errors are in server logs"}),"\n",(0,n.jsx)(t.p,{children:"Because the ACME client is not necessarily trusted (as account registration\nmay not be tied to a valid OpenBao token when EAB is not used), many error\nmessages end up in the OpenBao server logs out of security necessity. When\ntroubleshooting issues with clients requesting certificates, first check\nthe client's logs, if any, (e.g., certbot will state the log location on\nerrors), and then correlate with OpenBao server logs to identify the failure\nreason."}),"\n",(0,n.jsx)(t.h3,{id:"acme-security-considerations",children:"ACME security considerations"}),"\n",(0,n.jsx)(t.p,{children:"ACME allows any client to use OpenBao to make some sort of external call;\nwhile the design of ACME attempts to minimize this scope and will prohibit\nissuance if incorrect servers are contacted, it cannot account for all\npossible remote server implementations. OpenBao's ACME server makes three\ntypes of requests:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["DNS requests for ",(0,n.jsx)(t.code,{children:"_acme-challenge.<domain>"}),", which should be least\ninvasive and most safe."]}),"\n",(0,n.jsxs)(t.li,{children:["TLS ALPN requests for the ",(0,n.jsx)(t.code,{children:"acme-tls/1"})," protocol, which should be\nsafely handled by the TLS before any application code is invoked."]}),"\n",(0,n.jsxs)(t.li,{children:["HTTP requests to ",(0,n.jsx)(t.code,{children:"http://<domain>/.well-known/acme-challenge/<token>"}),",\nwhich could be problematic based on server design; if all requests,\nregardless of path, are treated the same and assumed to be trusted,\nthis could result in OpenBao being used to make (invalid) requests.\nIdeally, any such server implementations should be updated to ignore\nsuch ACME validation requests or to block access originating from OpenBao\nto this service."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"In all cases, no information about the response presented by the remote\nserver is returned to the ACME client."}),"\n",(0,n.jsx)(t.p,{children:"When running OpenBao on multiple networks, note that OpenBao's ACME server\nplaces no restrictions on requesting client/destination identifier\nvalidations paths; a client could use a HTTP challenge to force OpenBao to\nreach out to a server on a network it could otherwise not access."}),"\n",(0,n.jsx)(t.h2,{id:"keep-certificate-lifetimes-short-for-crls-sake",children:"Keep certificate lifetimes short, for CRL's sake"}),"\n",(0,n.jsxs)(t.p,{children:["This secrets engine aligns with OpenBao's philosophy of short-lived secrets. As\nsuch it is not expected that CRLs will grow large; the only place a private key\nis ever returned is to the requesting client (this secrets engine does ",(0,n.jsx)(t.em,{children:"not"}),"\nstore generated private keys, except for CA certificates). In most cases, if the\nkey is lost, the certificate can simply be ignored, as it will expire shortly."]}),"\n",(0,n.jsxs)(t.p,{children:["If a certificate must truly be revoked, the normal OpenBao revocation function can\nbe used, and any revocation action will cause the CRL to be regenerated. When\nthe CRL is regenerated, any expired certificates are removed from the CRL (and\nany revoked, expired certificate are removed from secrets engine storage). This\nis an expensive operation! Due to the structure of the CRL standard, OpenBao must\nread ",(0,n.jsx)(t.strong,{children:"all"})," revoked certificates into memory in order to rebuild the CRL and\nclients must fetch the regenerated CRL."]}),"\n",(0,n.jsx)(t.p,{children:"This secrets engine does not support multiple CRL endpoints with sliding date\nwindows; often such mechanisms will have the transition point a few days apart,\nbut this gets into the expected realm of the actual certificate validity periods\nissued from this secrets engine. A good rule of thumb for this secrets engine\nwould be to simply not issue certificates with a validity period greater than\nyour maximum comfortable CRL lifetime. Alternately, you can control CRL caching\nbehavior on the client to ensure that checks happen more often."}),"\n",(0,n.jsx)(t.p,{children:"Often multiple endpoints are used in case a single CRL endpoint is down so that\nclients don't have to figure out what to do with a lack of response. Run OpenBao\nin HA mode, and the CRL endpoint should be available even if a particular node\nis down."}),"\n",(0,n.jsx)(t.admonition,{type:"warning",children:(0,n.jsx)(t.p,{children:"Note: When using multiple issuers in the same mount point,\ndifferent issuers may have different CRLs (depending on subject and key\nmaterial). This means that OpenBao may need to regenerate multiple CRLs.\nThis is again a rationale for keeping TTLs short and avoiding revocation\nif possible."})}),"\n",(0,n.jsx)(t.admonition,{type:"warning",children:(0,n.jsx)(t.p,{children:"Note: OpenBao supports two complementary revocation mechanisms: Delta CRLs,\nwhich allow for rebuilds of smaller, incremental additions to the last\ncomplete CRL, and OCSP, which allows responding to revocation status requests\nfor individual certificates. When coupled with the new CRL auto-rebuild\nfunctionality, this means that the revoking step isn't as costly (as the CRL\nisn't always rebuilt on each revocation), outside of storage considerations.\nHowever, while the rebuild operation still can be expensive with lots of\ncertificates, it will be done on a schedule rather than on demand."})}),"\n",(0,n.jsx)(t.h3,{id:"notafter-behavior-on-leaf-certificates",children:"NotAfter behavior on leaf certificates"}),"\n",(0,n.jsxs)(t.p,{children:["The PKI Secrets Engine supports a ",(0,n.jsx)(t.code,{children:"leaf_not_after_behavior"})," ",(0,n.jsx)(t.a,{href:"/api-docs/secret/pki#leaf_not_after_behavior",children:"parameter on\nissuers"}),".  This allows\nmodification of the issuance behavior: should OpenBao ",(0,n.jsx)(t.code,{children:"err"}),", preventing issuance\nof a longer-lived leaf cert than issuer, silently ",(0,n.jsx)(t.code,{children:"truncate"})," to that of the\nissuer's ",(0,n.jsx)(t.code,{children:"NotAfter"})," value, or ",(0,n.jsx)(t.code,{children:"permit"})," longer expirations."]}),"\n",(0,n.jsxs)(t.p,{children:["It is strongly suggested to use ",(0,n.jsx)(t.code,{children:"err"})," or ",(0,n.jsx)(t.code,{children:"truncate"})," for intermediates;\n",(0,n.jsx)(t.code,{children:"permit"})," is only useful for root certificates, as intermediate's NotAfter\nexpiration are checked when validating presented chains."]}),"\n",(0,n.jsxs)(t.p,{children:["In combination with a cascading expiration with longer lived roots (perhaps\non the range of 2-10 years), shorter lived intermediates (perhaps on the\nrange of 6 months to 2 years), and short-lived leaf certificates (on the\nrange of 30 to 90 days), and the ",(0,n.jsx)(t.a,{href:"/docs/secrets/pki/rotation-primitives",children:"rotation strategies discussed in other\nsections"}),", this should keep the\nCRLs adequately small."]}),"\n",(0,n.jsx)(t.h3,{id:"cluster-performance-and-quantity-of-leaf-certificates",children:"Cluster performance and quantity of leaf certificates"}),"\n",(0,n.jsxs)(t.p,{children:["As mentioned above, keeping TTLs short (or using ",(0,n.jsx)(t.code,{children:"no_store=true"}),") and avoiding\nleases is important for a healthy cluster. However it is important to note\nthis is a scale problem: 10-1000 long-lived, stored certificates are probably\nfine, but 50k-100k become a problem and 500k+ stored, unexpired certificates\ncan negatively impact even large OpenBao clusters--even with short TTLs!"]}),"\n",(0,n.jsxs)(t.p,{children:["However, once these certificates are expired, a ",(0,n.jsx)(t.a,{href:"/api-docs/secret/pki#tidy",children:"tidy operation"}),"\nwill clean up CRLs and OpenBao cluster storage."]}),"\n",(0,n.jsxs)(t.p,{children:["Note that organizational risk assessments for certificate compromise might\nmean certain certificate types should always be issued with ",(0,n.jsx)(t.code,{children:"no_store=false"}),";\neven short-lived broad wildcard certificates (say, ",(0,n.jsx)(t.code,{children:"*.example.com"}),") might be\nimportant enough to have precise control over revocation. However, an internal\nservice with a well-scoped certificate (say, ",(0,n.jsx)(t.code,{children:"service.example.com"}),") might be\nof low enough risk to issue a 90-day TTL with ",(0,n.jsx)(t.code,{children:"no_store=true"}),", preventing\nthe need for revocation in the unlikely case of compromise."]}),"\n",(0,n.jsx)(t.p,{children:"Having a shorter TTL decreases the likelihood of needing to revoke a cert\n(but cannot prevent it entirely) and decrease the impact of any such\ncompromise."}),"\n",(0,n.jsx)(t.admonition,{type:"warning",children:(0,n.jsxs)(t.p,{children:["Note: The PKI Secret Engine's ",(0,n.jsx)(t.a,{href:"/api-docs/secret/pki#revoke-certificate",children:"Bring-Your-Own-Cert\n(BYOC)"})," functionality allows\nrevocation of certificates not previously stored (e.g., issued via a role\nwith ",(0,n.jsx)(t.code,{children:"no_store=true"}),"). This means that setting ",(0,n.jsx)(t.code,{children:"no_store=true"})," ",(0,n.jsx)(t.em,{children:"is"})," safe to\nbe used globally, regardless of importance of issued certificates (and their\nlikelihood for revocation)."]})}),"\n",(0,n.jsxs)(t.h2,{id:"you-must-configure-issuingcrlocsp-information-in-advance",children:["You must configure issuing/CRL/OCSP information ",(0,n.jsx)(t.em,{children:"in advance"})]}),"\n",(0,n.jsxs)(t.p,{children:["This secrets engine serves CRLs from a predictable location, but it is not\npossible for the secrets engine to know where it is running. Therefore, you must\nconfigure desired URLs for the issuing certificate, CRL distribution points, and\nOCSP servers manually using the ",(0,n.jsx)(t.code,{children:"config/urls"})," endpoint. It is supported to have\nmore than one of each of these by passing in the multiple URLs as a\ncomma-separated string parameter."]}),"\n",(0,n.jsx)(t.admonition,{type:"warning",children:(0,n.jsxs)(t.p,{children:["Note: When using multiple issuers in the same mount, it is suggested to use\nthe per-issuer AIA fields rather than the global (",(0,n.jsx)(t.code,{children:"/config/urls"}),") variant.\nThis is for correctness: these fields are used for chain building and\nautomatic CRL detection in certain applications. If they point to the wrong\nissuer's information, these applications may break."]})}),"\n",(0,n.jsx)(t.h2,{id:"distribution-of-crls-and-ocsp",children:"Distribution of CRLs and OCSP"}),"\n",(0,n.jsx)(t.p,{children:"Both CRLs and OCSP allow interrogating revocation status of certificates. Both\nof these methods include internal security and authenticity (both CRLs and\nOCSP responses are signed by the issuing CA within OpenBao). This means both are\nfine to distribute over non-secure and non-authenticated channels, such as\nHTTP."}),"\n",(0,n.jsx)(t.h2,{id:"automate-crl-building-and-tidying",children:"Automate CRL building and tidying"}),"\n",(0,n.jsxs)(t.p,{children:["The PKI Secrets Engine supports automated CRL rebuilding (including optional\nDelta CRLs which can be built more frequently than complete CRLs) via the\n",(0,n.jsx)(t.code,{children:"/config/crl"})," endpoint. Additionally, tidying of revoked and expired\ncertificates can be configured automatically via the ",(0,n.jsx)(t.code,{children:"/config/auto-tidy"}),"\nendpoint. Both of these should be enabled to ensure compatibility with the wider\nPKIX ecosystem and performance of the cluster."]}),"\n",(0,n.jsx)(t.h2,{id:"spectrum-of-revocation-support",children:"Spectrum of revocation support"}),"\n",(0,n.jsx)(t.p,{children:"The PKI secrets engine has the ability to support a spectrum of cluster sizes\nand certificate revocation quantities."}),"\n",(0,n.jsx)(t.p,{children:"For users with few revocations or who want a unified view and have the\ninter-cluster bandwidth to support it, we recommend turning on auto\nrebuilding of CRLs, cross-cluster revocation queues, and cross-cluster CRLs.\nThis allows all consumers of the CRLs to have the most accurate picture of\nrevocations, regardless of which cluster they talk to."}),"\n",(0,n.jsxs)(t.p,{children:["If the unified CRL becomes too big for the underlying storage mechanism or\nfor a single host to build, we recommend relying on OCSP instead of CRLs.\nThese have much smaller storage entries, and the CRL ",(0,n.jsx)(t.code,{children:"disabled"})," flag is\nindependent of ",(0,n.jsx)(t.code,{children:"unified_crls"}),", allowing unified OCSP to remain."]}),"\n",(0,n.jsxs)(t.p,{children:["However, when cross-cluster traffic becomes too high (or if CRLs are still\nnecessary in addition to OCSP), we recommend sharding the CRL between\ndifferent clusters. This has been the default behavior of OpenBao, but with\nthe introduction of per-cluster, templated AIA information, the leaf\ncertificate's Authority Information Access (AIA) info will point directly\nto the cluster which issued it, allowing the correct CRL for this cert to\nbe identified by the application. This more correctly mimics the behavior\nof ",(0,n.jsx)(t.a,{href:"https://letsencrypt.org/2022/09/07/new-life-for-crls.html",children:"Let's Encrypt's CRL sharding"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"This sharding behavior can also be used for OCSP, if the cross-cluster\ntraffic for revocation entries becomes too high."}),"\n",(0,n.jsxs)(t.p,{children:["For users who wish to manage revocation manually, using the audit logs to\ntrack certificate issuance would allow an external system to identify which\ncertificates were issued. These can be manually tracked for revocation, and\na ",(0,n.jsx)(t.a,{href:"/api-docs/secret/pki#combine-crls-from-the-same-issuer",children:"custom CRL can be built"}),"\nusing externally tracked revocations. This would allow usage of roles set to\n",(0,n.jsx)(t.code,{children:"no_store=true"}),", so OpenBao is strictly used as an issuing authority and isn't\nstoring any certificates, issued or revoked. For the highest of revocation\nvolumes, this could be the best option."]}),"\n",(0,n.jsx)(t.p,{children:"Notably, this last approach can either be used for the creation of externally\nstored unified or sharded CRLs. If a single external unified CRL becomes\nunreasonably large, each cluster's certificates could have AIA info point\nto an externally stored and maintained, sharded CRL. However,\nOpenBao has no mechanism to sign OCSP requests at this time."}),"\n",(0,n.jsx)(t.h2,{id:"automate-leaf-certificate-renewal",children:"Automate leaf certificate renewal"}),"\n",(0,n.jsxs)(t.p,{children:["To manage certificates for services at scale, it is best to automate the\ncertificate renewal as much as possible. OpenBao Agent ",(0,n.jsx)(t.a,{href:"/docs/agent-and-proxy/agent/template#certificates",children:"has support for\nautomatically renewing requested certificates"}),"\nbased on the ",(0,n.jsx)(t.code,{children:"validTo"})," field. Other solutions might involve using\n",(0,n.jsx)(t.a,{href:"https://cert-manager.io/",children:"cert-manager"})," in Kubernetes or OpenShift, backed\nby the OpenBao CA."]}),"\n",(0,n.jsx)(t.h2,{id:"safe-minimums",children:"Safe minimums"}),"\n",(0,n.jsx)(t.p,{children:"Since its inception, this secrets engine has enforced SHA256 for signature\nhashes rather than SHA1. A minimum of 2048 bits for RSA keys is also enforced.\nSoftware that can handle SHA256 signatures should also be able to handle\n2048-bit keys, and 1024-bit keys are considered unsafe and are disallowed in the\nInternet PKI."}),"\n",(0,n.jsx)(t.h2,{id:"token-lifetimes-and-revocation",children:"Token lifetimes and revocation"}),"\n",(0,n.jsxs)(t.p,{children:["When a token expires, it revokes all leases associated with it. This means that\nlong-lived CA certs need correspondingly long-lived tokens, something that is\neasy to forget. Root and intermediate CA certs don't have associated leases, to\nprevent unintended revocation when not using a token with a long enough\nlifetime. To revoke these certificates, use the ",(0,n.jsx)(t.code,{children:"pki/revoke"})," endpoint."]}),"\n",(0,n.jsx)(t.h2,{id:"safe-usage-of-roles",children:"Safe usage of roles"}),"\n",(0,n.jsxs)(t.p,{children:["The OpenBao PKI Secrets Engine supports many options to limit issuance via\n",(0,n.jsx)(t.a,{href:"/api-docs/secret/pki#create-update-role",children:"Roles"}),".\nCareful consideration of construction is necessary to ensure that more\npermissions are not given than necessary. Additionally, roles should generally\ndo ",(0,n.jsx)(t.em,{children:"one"})," thing; multiple roles should be preferable over having too permissive\nroles that allow arbitrary issuance (e.g., ",(0,n.jsx)(t.code,{children:"allow_any_name"})," should generally\nbe used sparingly, if at all)."]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"allow_any_name"})," should generally be set to ",(0,n.jsx)(t.code,{children:"false"}),"; this is the default."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"allow_localhost"})," should generally be set to ",(0,n.jsx)(t.code,{children:"false"})," for production\nservices, unless listening on ",(0,n.jsx)(t.code,{children:"localhost"})," is expected."]}),"\n",(0,n.jsxs)(t.li,{children:["Unless necessary, ",(0,n.jsx)(t.code,{children:"allow_wildcard_certificates"})," should generally be set to\n",(0,n.jsx)(t.code,{children:"false"}),". This is ",(0,n.jsx)(t.strong,{children:"not"})," the default due to backwards compatibility\nconcerns.","\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["This is especially necessary when ",(0,n.jsx)(t.code,{children:"allow_subdomains"})," or ",(0,n.jsx)(t.code,{children:"allow_glob_domains"}),"\nare enabled."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"enforce_hostnames"})," should generally be enabled for TLS services; this is\nthe default."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"allow_ip_sans"})," should generally be set to ",(0,n.jsx)(t.code,{children:"false"})," (but defaults to ",(0,n.jsx)(t.code,{children:"true"}),"),\nunless IP address certificates are explicitly required."]}),"\n",(0,n.jsxs)(t.li,{children:["When using short TTLs (< 30 days) or with high issuance volume, it is\ngenerally recommend to set ",(0,n.jsx)(t.code,{children:"no_store"})," to ",(0,n.jsx)(t.code,{children:"true"})," (defaults to ",(0,n.jsx)(t.code,{children:"false"}),").\nThis prevents revocation but allows higher throughput as OpenBao no longer\nneeds to store every issued certificate. This is discussed more in the\n",(0,n.jsx)(t.a,{href:"#replicated-datasets",children:"Replicated Datasets"})," section below."]}),"\n",(0,n.jsxs)(t.li,{children:["Do not use roles with root certificates (",(0,n.jsx)(t.code,{children:"issuer_ref"}),"). Root certificates\nshould generally only issue intermediates (see the section on ",(0,n.jsx)(t.a,{href:"#use-a-ca-hierarchy",children:"CA hierarchy\nabove"}),"), which doesn't rely on roles."]}),"\n",(0,n.jsxs)(t.li,{children:["Limit ",(0,n.jsx)(t.code,{children:"key_usage"})," and ",(0,n.jsx)(t.code,{children:"ext_key_usage"}),"; don't attempt to allow all usages\nfor all purposes. Generally the default values are useful for client and\nserver TLS authentication."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"telemetry",children:"Telemetry"}),"\n",(0,n.jsxs)(t.p,{children:["Beyond OpenBao's default telemetry around request processing, PKI exposes count and\nduration metrics for the issue, sign, sign-verbatim, and revoke calls. The\nmetrics keys take the form ",(0,n.jsx)(t.code,{children:"mount-path,operation,[failure]"})," with labels for\nnamespace and role name."]}),"\n",(0,n.jsx)(t.p,{children:"Note that these metrics are per-node and thus would need to be aggregated across\nnodes and clusters."}),"\n",(0,n.jsx)(t.h2,{id:"auditing",children:"Auditing"}),"\n",(0,n.jsx)(t.p,{children:"Because OpenBao HMACs audit string keys by default, it is necessary to tune\nPKI secrets mounts to get an accurate view of issuance that is occurring under\nthis mount."}),"\n",(0,n.jsx)(t.admonition,{type:"warning",children:(0,n.jsxs)(t.p,{children:["Note: Depending on usage of OpenBao, CRLs (and rarely, CA chains) can grow to\nbe rather large. We don't recommend un-HMACing the ",(0,n.jsx)(t.code,{children:"crl"})," field for this\nreason, but note that the recommendations below suggest to un-HMAC the\n",(0,n.jsx)(t.code,{children:"certificate"})," response parameter, which the CRL can be served in via\nthe ",(0,n.jsx)(t.code,{children:"/pki/cert/crl"})," API endpoint. Additionally, the ",(0,n.jsx)(t.code,{children:"http_raw_body"})," can\nbe used to return CRL both in PEM and raw binary DER form, so it is\nsuggested not to un-HMAC that field to not corrupt the log format.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\nIf this is done with only a ",(0,n.jsx)(t.a,{href:"/docs/audit/syslog",children:"syslog"})," audit device,\nOpenBao can deny requests (with an opaque ",(0,n.jsx)(t.code,{children:"500 Internal Error"})," message)\nafter the action has been performed on the server, because it was\nunable to log the message.",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"\nThe suggested workaround is to either leave the ",(0,n.jsx)(t.code,{children:"certificate"})," and ",(0,n.jsx)(t.code,{children:"crl"}),"\nresponse fields HMACed and/or to also enable the ",(0,n.jsx)(t.a,{href:"/docs/audit/file",children:(0,n.jsx)(t.code,{children:"file"})}),"\naudit log type."]})}),"\n",(0,n.jsx)(t.p,{children:"Some suggested keys to un-HMAC for requests are as follows:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"csr"})," - the requested CSR to sign,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"certificate"})," - the requested self-signed certificate to re-sign or\nwhen importing issuers,"]}),"\n",(0,n.jsxs)(t.li,{children:["Various issuance-related overriding parameters, such as:","\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"issuer_ref"})," - the issuer requested to sign this certificate,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"common_name"})," - the requested common name,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"alt_names"})," - alternative requested DNS-type SANs for this certificate,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"other_sans"})," - other (non-DNS, non-Email, non-IP, non-URI) requested SANs for this certificate,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"ip_sans"})," - requested IP-type SANs for this certificate,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"uri_sans"})," - requested URI-type SANs for this certificate,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"ttl"})," - requested expiration date of this certificate,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"not_after"})," - requested expiration date of this certificate,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"serial_number"})," - the subject's requested serial number,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"key_type"})," - the requested key type,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"private_key_format"})," - the requested key format which is also\nused for the public certificate format as well,"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["Various role- or issuer-related generation parameters, such as:","\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"ou"})," - the subject's organizational unit,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"organization"})," - the subject's organization,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"country"})," - the subject's country code,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"locality"})," - the subject's locality,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"province"})," - the subject's province,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"street_address"})," - the subject's street address,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"postal_code"})," - the subject's postal code,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"permitted_dns_domains"})," - permitted DNS domains,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"policy_identifiers"})," - the requested policy identifiers when creating a role, and"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"ext_key_usage_oids"})," - the extended key usage OIDs for the requested certificate."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Some suggested keys to un-HMAC for responses are as follows:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"certificate"})," - the certificate that was issued,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"issuing_ca"})," - the certificate of the CA which issued the requested\ncertificate,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"serial_number"})," - the serial number of the certificate that was issued,"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"error"})," - to show errors associated with the request, and"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"ca_chain"})," - optional due to noise; the full CA chain of the issuer of\nthe requested certificate."]}),"\n"]}),"\n",(0,n.jsx)(t.admonition,{type:"warning",children:(0,n.jsx)(t.p,{children:"Note: These list of parameters to un-HMAC are provided as a suggestion and\nmay not be exhaustive."})}),"\n",(0,n.jsxs)(t.p,{children:["The following keys are suggested ",(0,n.jsx)(t.strong,{children:"NOT"})," to un-HMAC, due to their sensitive\nnature:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"private_key"})," - this response parameter contains the private keys\ngenerated by OpenBao during issuance, and"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"pem_bundle"})," this request parameter is only used on the issuer-import\npaths and may contain sensitive private key material."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"role-based-access",children:"Role-Based access"}),"\n",(0,n.jsxs)(t.p,{children:["OpenBao supports ",(0,n.jsx)(t.a,{href:"/tutorials/getting-started/getting-started-policies",children:"path-based ACL Policies"}),"\nfor limiting access to various paths within OpenBao."]}),"\n",(0,n.jsx)(t.p,{children:"The following is a condensed example reference of ACLing the PKI Secrets\nEngine. These are just a suggestion; other personas and policy approaches\nmay also be valid."}),"\n",(0,n.jsx)(t.p,{children:"We suggest the following personas:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.em,{children:"Operator"}),";  a privileged user who manages the health of the PKI\nsubsystem; manages issuers and key material."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.em,{children:"Agent"}),"; a semi-privileged user that manages roles and handles\nrevocation on behalf of an operator; may also handle delegated\nissuance. This may also be called an ",(0,n.jsx)(t.em,{children:"administrator"})," or ",(0,n.jsx)(t.em,{children:"role\nmanager"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.em,{children:"Advanced"}),"; potentially a power-user or service that has access to\nadditional issuance APIs."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.em,{children:"Requester"}),"; a low-level user or service that simply requests certificates."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.em,{children:"Unauthed"}),"; any arbitrary user or service that lacks an OpenBao token."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"For these personas, we suggest the following ACLs, in condensed, tabular form:"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Path"}),(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Operations"}),(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Operator"}),(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Agent"}),(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Advanced"}),(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Requester"}),(0,n.jsx)(t.th,{style:{textAlign:"left"},children:"Unauthed"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/ca(/pem)?"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/ca_chain"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/crl(/pem)?"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/crl/delta(/pem)?"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/cert/:serial(/raw(/pem)?)?"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/issuers"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"List"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/issuer/:issuer_ref/(json\xa6der\xa6pem)"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/issuer/:issuer_ref/crl(/der\xa6/pem)?"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/issuer/:issuer_ref/crl/delta(/der\xa6/pem)?"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/ocsp/<request>"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/ocsp"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/certs"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"List"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/revoke-with-key"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/roles"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"List"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/roles/:role"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/(issue\xa6sign)/:role"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/issuer/:issuer_ref/(issue\xa6sign)/:role"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/config/auto-tidy"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/config/ca"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/config/crl"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/config/issuers"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/crl/rotate"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/crl/rotate-delta"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/roles/:role"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/issuer/:issuer_ref"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/sign-verbatim(/:role)?"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/issuer/:issuer_ref/sign-verbatim(/:role)?"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/revoke"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/tidy"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/tidy-cancel"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/tidy-status"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/config/auto-tidy"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/config/ca"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/config/crl"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/config/issuers"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/config/keys"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read, Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/config/urls"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read, Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/issuer/:issuer_ref"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/issuer/:issuer_ref/revoke"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/issuer/:issuer_ref/sign-intermediate"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/issuer/issuer_ref/sign-self-issued"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/issuers/generate/+/+"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/issuers/import/+"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/intermediate/generate/+"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/intermediate/cross-sign"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/intermediate/set-signed"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/keys"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"List"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/key/:key_ref"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Read, Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/keys/generate/+"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/keys/import"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/root/generate/+"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/root/sign-intermediate"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/root/sign-self-issued"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/root/rotate/+"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{style:{textAlign:"left"},children:(0,n.jsx)(t.code,{children:"/root/replace"})}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Write"}),(0,n.jsx)(t.td,{style:{textAlign:"left"},children:"Yes"}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}}),(0,n.jsx)(t.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,n.jsx)(t.h2,{id:"cluster-scalability",children:"Cluster scalability"}),"\n",(0,n.jsx)(t.p,{children:"Most non-introspection operations in the PKI secrets engine require a write to\nstorage, and so are forwarded to the cluster's active node for execution.\nThis table outlines which operations can be executed on performance standby nodes\nand thus scale horizontally across all nodes within a cluster."}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Path"}),(0,n.jsx)(t.th,{children:"Operations"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"ca[/pem]"}),(0,n.jsx)(t.td,{children:"Read"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{children:["cert/",(0,n.jsx)("em",{children:"serial-number"})]}),(0,n.jsx)(t.td,{children:"Read"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"cert/ca_chain"}),(0,n.jsx)(t.td,{children:"Read"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"config/crl"}),(0,n.jsx)(t.td,{children:"Read"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"certs"}),(0,n.jsx)(t.td,{children:"List"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"ca_chain"}),(0,n.jsx)(t.td,{children:"Read"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"crl[/pem]"}),(0,n.jsx)(t.td,{children:"Read"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"issue"}),(0,n.jsxs)(t.td,{children:["Update ",(0,n.jsx)("sup",{children:"*"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{children:["revoke/",(0,n.jsx)("em",{children:"serial-number"})]}),(0,n.jsx)(t.td,{children:"Read"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"sign"}),(0,n.jsxs)(t.td,{children:["Update ",(0,n.jsx)("sup",{children:"*"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"sign-verbatim"}),(0,n.jsxs)(t.td,{children:["Update ",(0,n.jsx)("sup",{children:"*"})]})]})]})]}),"\n",(0,n.jsxs)(t.p,{children:["* Only if the corresponding role has ",(0,n.jsx)(t.code,{children:"no_store"})," set to true and ",(0,n.jsx)(t.code,{children:"generate_lease"}),"\nset to false. If ",(0,n.jsx)(t.code,{children:"generate_lease"})," is true the lease creation will be forwarded to\nthe active node; if ",(0,n.jsx)(t.code,{children:"no_store"})," is false the entire request will be forwarded to\nthe active node."]}),"\n",(0,n.jsx)(t.h2,{id:"pss-support",children:"PSS support"}),"\n",(0,n.jsxs)(t.p,{children:["Go lacks support for PSS certificates, keys, and CSRs using the ",(0,n.jsx)(t.code,{children:"rsaPSS"})," OID\n(",(0,n.jsx)(t.code,{children:"1.2.840.113549.1.1.10"}),"). It requires all RSA certificates, keys, and CSRs\nto use the alternative ",(0,n.jsx)(t.code,{children:"rsaEncryption"})," OID (",(0,n.jsx)(t.code,{children:"1.2.840.113549.1.1.1"}),")."]}),"\n",(0,n.jsxs)(t.p,{children:["When using OpenSSL to generate CAs or CSRs from PKCS8-encoded PSS keys, the\nresulting CAs and CSRs will have the ",(0,n.jsx)(t.code,{children:"rsaPSS"})," OID. Go and OpenBao will reject\nthem. Instead, use OpenSSL to generate or convert to a PKCS#1v1.5 private\nkey file and use this to generate the CSR. OpenBao will, depending on the role\nand the signing mechanism, still use a PSS signature despite the\n",(0,n.jsx)(t.code,{children:"rsaEncryption"})," OID on the request as the SubjectPublicKeyInfo and\nSignatureAlgorithm fields are orthogonal. When creating an external CA and\nimporting it into OpenBao, ensure that the ",(0,n.jsx)(t.code,{children:"rsaEncryption"})," OID is present on\nthe SubjectPublicKeyInfo field even if the SignatureAlgorithm is PSS-based."]}),"\n",(0,n.jsxs)(t.p,{children:["These certificates generated by Go (with ",(0,n.jsx)(t.code,{children:"rsaEncryption"})," OID but PSS-based\nsignatures) are otherwise compatible with the fully PSS-based certificates.\nOpenSSL and NSS support parsing and verifying chains using this type of\ncertificate. Note that some TLS implementations may not support these types\nof certificates if they do not support ",(0,n.jsx)(t.code,{children:"rsa_pss_rsae_*"})," signature schemes.\nAdditionally, some implementations allow rsaPSS OID certificates to contain\nrestrictions on signature parameters allowed by this certificate, but Go and\nOpenBao do not support adding such restrictions."]}),"\n",(0,n.jsx)(t.p,{children:"Go additionally lacks support for creating OCSP responses with the PSS\nsignature algorithm. OpenBao will automatically downgrade issuers with\nPSS-based revocation signature algorithms to PKCS#1v1.5, but note that\ncertain KMS devices (like HSMs and GCP) may not support this with the\nsame key. As a result, the OCSP responder may fail to sign responses,\nreturning an internal error."}),"\n",(0,n.jsx)(t.h2,{id:"tutorial",children:"Tutorial"}),"\n",(0,n.jsxs)(t.p,{children:["Refer to the ",(0,n.jsx)(t.a,{href:"/tutorials/secrets-management/pki-engine",children:"Build Your Own Certificate Authority (CA)"}),"\nguide for a step-by-step tutorial."]}),"\n",(0,n.jsx)(t.h2,{id:"api",children:"API"}),"\n",(0,n.jsxs)(t.p,{children:["The PKI secrets engine has a full HTTP API. Please see the\n",(0,n.jsx)(t.a,{href:"/api-docs/secret/pki",children:"PKI secrets engine API"})," for more\ndetails."]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>r,x:()=>d});var n=s(96540);const i={},l=n.createContext(i);function r(e){const t=n.useContext(l);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(l.Provider,{value:t},e.children)}}}]);