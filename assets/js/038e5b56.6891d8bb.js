"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7489],{88331:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var o=t(74848),a=t(28453);const i={layout:"docs",page_title:"OpenBao Agent API Proxy",description:"OpenBao Agent's API Proxy functionality allows you to use OpenBao Agent's API as a proxy for OpenBao's API."},r="OpenBao agent API proxy",s={id:"agent-and-proxy/agent/apiproxy",title:"OpenBao agent API proxy",description:"OpenBao Agent's API Proxy functionality allows you to use OpenBao Agent's API as a proxy for OpenBao's API.",source:"@site/content/docs/agent-and-proxy/agent/apiproxy.mdx",sourceDirName:"agent-and-proxy/agent",slug:"/agent-and-proxy/agent/apiproxy",permalink:"/openbao/docs/agent-and-proxy/agent/apiproxy",draft:!1,unlisted:!1,editUrl:"https://github.com/openbao/openbao/tree/main/website/content/docs/agent-and-proxy/agent/apiproxy.mdx",tags:[],version:"current",frontMatter:{layout:"docs",page_title:"OpenBao Agent API Proxy",description:"OpenBao Agent's API Proxy functionality allows you to use OpenBao Agent's API as a proxy for OpenBao's API."},sidebar:"tutorialSidebar",previous:{title:"What is OpenBao Agent?",permalink:"/openbao/docs/agent-and-proxy/agent/"},next:{title:"OpenBao agent caching",permalink:"/openbao/docs/agent-and-proxy/agent/caching/"}},c={},l=[{value:"Functionality",id:"functionality",level:2},{value:"Using Auto-Auth token",id:"using-auto-auth-token",level:2},{value:"Forcing Auto-Auth token",id:"forcing-auto-auth-token",level:2},{value:"Configuration (<code>api_proxy</code>)",id:"configuration-api_proxy",level:2},{value:"Example configuration",id:"example-configuration",level:3}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"openbao-agent-api-proxy",children:"OpenBao agent API proxy"}),"\n",(0,o.jsx)(n.p,{children:"OpenBao Agent's API Proxy functionality allows you to use OpenBao Agent's API as a proxy\nfor OpenBao's API."}),"\n",(0,o.jsxs)(n.p,{children:["~> Note: This functionality will be deprecated in a future release. Please\nswitch to using ",(0,o.jsx)(n.a,{href:"/docs/agent-and-proxy/proxy",children:"OpenBao Proxy"})," for API proxying purposes, instead."]}),"\n",(0,o.jsx)(n.h2,{id:"functionality",children:"Functionality"}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsxs)(n.a,{href:"/docs/agent-and-proxy/agent#listener-stanza",children:[(0,o.jsx)(n.code,{children:"listener"})," stanza"]})," for OpenBao Agent configures a listener for OpenBao Agent. If\nits ",(0,o.jsx)(n.code,{children:"role"})," is not set to ",(0,o.jsx)(n.code,{children:"metrics_only"}),", it will act as a proxy for the OpenBao server that\nhas been configured in the ",(0,o.jsxs)(n.a,{href:"/docs/agent-and-proxy/agent#vault-stanza",children:[(0,o.jsx)(n.code,{children:"vault"})," stanza"]})," of OpenBao Agent. This enables access to the OpenBao\nAPI from the Agent API, and can be configured to optionally allow or force the automatic use of\nthe Auto-Auth token for these requests, as described below."]}),"\n",(0,o.jsxs)(n.p,{children:["If a ",(0,o.jsx)(n.code,{children:"listener"})," has been configured alongside a ",(0,o.jsx)(n.code,{children:"cache"})," stanza, the API Proxy will\nfirst attempt to utilize the cache subsystem for qualifying requests, before forwarding the\nrequest to OpenBao. See the ",(0,o.jsx)(n.a,{href:"/docs/agent-and-proxy/agent/caching",children:"caching docs"})," for more information on caching."]}),"\n",(0,o.jsx)(n.h2,{id:"using-auto-auth-token",children:"Using Auto-Auth token"}),"\n",(0,o.jsxs)(n.p,{children:["OpenBao Agent allows for easy authentication to OpenBao in a wide variety of\nenvironments using ",(0,o.jsx)(n.a,{href:"/docs/agent-and-proxy/autoauth",children:"Auto-Auth"}),". By setting the\n",(0,o.jsx)(n.code,{children:"use_auto_auth_token"})," (see below) configuration, clients will not be required\nto provide an OpenBao token to the requests made to the Agent. When this\nconfiguration is set, if the request doesn't already bear a token, then the\nauto-auth token will be used to forward the request to the OpenBao server. This\nconfiguration will be overridden if the request already has a token attached,\nin which case, the token present in the request will be used to forward the\nrequest to the OpenBao server."]}),"\n",(0,o.jsx)(n.h2,{id:"forcing-auto-auth-token",children:"Forcing Auto-Auth token"}),"\n",(0,o.jsxs)(n.p,{children:["OpenBao Agent can be configured to force the use of the auto-auth token by using\nthe value ",(0,o.jsx)(n.code,{children:"force"})," for the ",(0,o.jsx)(n.code,{children:"use_auto_auth_token"})," option. This configuration\noverrides the default behavior described above in ",(0,o.jsx)(n.a,{href:"/docs/agent-and-proxy/agent/apiproxy#using-auto-auth-token",children:"Using Auto-Auth\nToken"}),", and instead ignores any\nexisting OpenBao token in the request and instead uses the auto-auth token."]}),"\n",(0,o.jsxs)(n.h2,{id:"configuration-api_proxy",children:["Configuration (",(0,o.jsx)(n.code,{children:"api_proxy"}),")"]}),"\n",(0,o.jsxs)(n.p,{children:["The top level ",(0,o.jsx)(n.code,{children:"api_proxy"})," block has the following configuration entries:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"use_auto_auth_token"})," ",(0,o.jsx)(n.code,{children:"(bool/string: false)"})," - If set, the requests made to Agent\nwithout an OpenBao token will be forwarded to the OpenBao server with the\nauto-auth token attached. If the requests already bear a token, this\nconfiguration will be overridden and the token in the request will be used to\nforward the request to the OpenBao server. If set to ",(0,o.jsx)(n.code,{children:'"force"'})," Agent will use the\nauto-auth token, overwriting the attached OpenBao token if set."]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"example-configuration",children:"Example configuration"}),"\n",(0,o.jsxs)(n.p,{children:["Here is an example of a ",(0,o.jsx)(n.code,{children:"listener"})," configuration alongside ",(0,o.jsx)(n.code,{children:"api_proxy"})," configuration to force the use of the auto_auth token\nand enforce consistency."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-hcl",children:'# Other OpenBao agent configuration blocks\n# ...\n\napi_proxy {\n  use_auto_auth_token = "force"\n}\n\nlistener "tcp" {\n    address = "127.0.0.1:8100"\n    tls_disable = true\n}\n'})})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(u,{...e})}):u(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>s});var o=t(96540);const a={},i=o.createContext(a);function r(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);