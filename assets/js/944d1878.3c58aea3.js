"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3714],{27984:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>p,frontMatter:()=>s,metadata:()=>a,toc:()=>d});var i=t(74848),o=t(28453);const s={description:"Setup and configuration for OpenBao as an OpenID Connect (OIDC) identity provider."},r="OIDC identity provider",a={id:"secrets/identity/oidc-provider",title:"OIDC identity provider",description:"Setup and configuration for OpenBao as an OpenID Connect (OIDC) identity provider.",source:"@site/content/docs/secrets/identity/oidc-provider.mdx",sourceDirName:"secrets/identity",slug:"/secrets/identity/oidc-provider",permalink:"/docs/secrets/identity/oidc-provider",draft:!1,unlisted:!1,editUrl:"https://github.com/openbao/openbao/tree/main/website/content/docs/secrets/identity/oidc-provider.mdx",tags:[],version:"current",frontMatter:{description:"Setup and configuration for OpenBao as an OpenID Connect (OIDC) identity provider."},sidebar:"docs",previous:{title:"Identity tokens",permalink:"/docs/secrets/identity/identity-token"},next:{title:"Overview",permalink:"/docs/secrets/kv/"}},c={},d=[{value:"Setup",id:"setup",level:2},{value:"Usage",id:"usage",level:2},{value:"Supported flows",id:"supported-flows",level:2},{value:"Tutorial",id:"tutorial",level:2},{value:"API",id:"api",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"oidc-identity-provider",children:"OIDC identity provider"}),"\n",(0,i.jsxs)(n.p,{children:["OpenBao is an OpenID Connect (",(0,i.jsx)(n.a,{href:"https://openid.net/specs/openid-connect-core-1_0.html",children:"OIDC"}),")\nidentity provider. This enables client applications that speak the OIDC protocol to leverage\nOpenBao's source of ",(0,i.jsx)(n.a,{href:"/docs/concepts/identity",children:"identity"})," and wide range of ",(0,i.jsx)(n.a,{href:"/docs/auth",children:"authentication methods"}),"\nwhen authenticating end-users. Client applications can configure their authentication logic\nto talk to OpenBao. Once enabled, OpenBao will act as the bridge to other identity providers via\nits existing authentication methods. Client applications can also obtain identity information\nfor their end-users by leveraging custom templating of OpenBao identity information."]}),"\n",(0,i.jsxs)(n.p,{children:["-> ",(0,i.jsx)(n.strong,{children:"Note"}),": For more detailed information on the configuration resources and OIDC endpoints,\nplease visit the ",(0,i.jsx)(n.a,{href:"/docs/concepts/oidc-provider",children:"OIDC provider"})," concepts page."]}),"\n",(0,i.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,i.jsx)(n.p,{children:"The OpenBao OIDC provider system is built on top of the identity secrets engine.\nThis secrets engine is mounted by default and cannot be disabled or moved."}),"\n",(0,i.jsxs)(n.p,{children:["Each OpenBao namespace has a default OIDC ",(0,i.jsx)(n.a,{href:"/docs/concepts/oidc-provider#providers",children:"provider"}),"\nand ",(0,i.jsx)(n.a,{href:"/docs/concepts/oidc-provider#key",children:"key"}),". This built-in configuration enables client\napplications to begin using OpenBao as a source of identity with minimal configuration. For\ndetails on the built-in configuration and advanced options, see the ",(0,i.jsx)(n.a,{href:"/docs/concepts/oidc-provider",children:"OIDC provider"}),"\nconcepts page."]}),"\n",(0,i.jsx)(n.p,{children:"The following steps show a minimal configuration that allows a client application to use\nOpenBao as an OIDC provider."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Enable an OpenBao auth method:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"$ bao auth enable userpass\nSuccess! Enabled userpass auth method at: userpass/\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Any OpenBao auth method may be used within the OIDC flow. For simplicity, enable the\n",(0,i.jsx)(n.code,{children:"userpass"})," auth method."]}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Create a user:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'$ bao write auth/userpass/users/end-user password="securepassword"\nSuccess! Data written to: auth/userpass/users/end-user\n'})}),"\n",(0,i.jsxs)(n.p,{children:["This user will authenticate to OpenBao through a client application, otherwise known as\nan OIDC ",(0,i.jsx)(n.a,{href:"https://openid.net/specs/openid-connect-core-1_0.html#Terminology",children:"relying party"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Create a client application:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'$ bao write identity/oidc/client/my-webapp \\\n  redirect_uris="https://localhost:9702/auth/oidc-callback" \\\n  assignments="allow_all"\nSuccess! Data written to: identity/oidc/client/my-webapp\n'})}),"\n",(0,i.jsxs)(n.p,{children:["This operation creates a client application which can be used to configure an OIDC\nrelying party. See the ",(0,i.jsx)(n.a,{href:"/docs/concepts/oidc-provider#client-applications",children:"client applications"}),"\nsection for details on different client types, including ",(0,i.jsx)(n.code,{children:"confidential"})," and ",(0,i.jsx)(n.code,{children:"public"})," clients."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"assignments"})," parameter limits the OpenBao entities and groups that are allowed to\nauthenticate through the client application. By default, no OpenBao entities are allowed.\nTo allow all OpenBao entities to authenticate, the built-in ",(0,i.jsx)(n.a,{href:"/docs/concepts/oidc-provider#assignments",children:"allow_all"}),"\nassignment is provided."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Read client credentials:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"$ bao read identity/oidc/client/my-webapp\n\nKey                 Value\n---                 -----\naccess_token_ttl    24h\nassignments         [allow_all]\nclient_id           GSDTnn3KaOrLpNlVGlYLS9TVsZgOTweO\nclient_secret       hvo_secret_gBKHcTP58C4aq7FqPWsuqKgpiiegd7ahpifGae9WGkHRCwFEJTZA9KGdNVpzE0r8\nclient_type         confidential\nid_token_ttl        24h\nkey                 default\nredirect_uris       [https://localhost:9702/auth/oidc-callback]\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"client_id"})," and ",(0,i.jsx)(n.code,{children:"client_secret"})," are the client application's credentials. These\nvalues are typically required when configuring an OIDC relying party."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Read OIDC discovery configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'$ curl -s http://127.0.0.1:8200/v1/identity/oidc/provider/default/.well-known/openid-configuration\n{\n  "issuer": "http://127.0.0.1:8200/v1/identity/oidc/provider/default",\n  "jwks_uri": "http://127.0.0.1:8200/v1/identity/oidc/provider/default/.well-known/keys",\n  "authorization_endpoint": "http://127.0.0.1:8200/ui/vault/identity/oidc/provider/default/authorize",\n  "token_endpoint": "http://127.0.0.1:8200/v1/identity/oidc/provider/default/token",\n  "userinfo_endpoint": "http://127.0.0.1:8200/v1/identity/oidc/provider/default/userinfo",\n  "request_parameter_supported": false,\n  "request_uri_parameter_supported": false,\n  "id_token_signing_alg_values_supported": [\n    "RS256",\n    "RS384",\n    "RS512",\n    "ES256",\n    "ES384",\n    "ES512",\n    "EdDSA"\n  ],\n  "response_types_supported": [\n    "code"\n  ],\n  "scopes_supported": [\n    "openid"\n  ],\n  "subject_types_supported": [\n    "public"\n  ],\n  "grant_types_supported": [\n    "authorization_code"\n  ],\n  "token_endpoint_auth_methods_supported": [\n    "none",\n    "client_secret_basic",\n    "client_secret_post"\n  ]\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Each OpenBao OIDC provider publishes ",(0,i.jsx)(n.a,{href:"https://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata",children:"discovery metadata"}),".\nThe ",(0,i.jsx)(n.code,{children:"issuer"})," value is typically required when configuring an OIDC relying party."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(n.p,{children:"After configuring an OpenBao auth method and client application, the following details can\nbe used to configure an OIDC relying party to delegate end-user authentication to OpenBao."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"client_id"})," - The ID of the client application"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"client_secret"})," - The secret of the client application"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"issuer"})," - The issuer of the OpenBao OIDC provider"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"A number of HashiCorp products provide OIDC authentication methods. This means that they\ncan leverage OpenBao as a source of identity using the OIDC protocol. See the following links\nfor details on configuring OIDC authentication for other HashiCorp products:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/boundary/tutorials/access-management/oidc-auth",children:"Boundary"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/consul/docs/security/acl/auth-methods/oidc",children:"Consul"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/waypoint/docs/server/auth/oidc",children:"Waypoint"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/nomad/tutorials/single-sign-on/sso-oidc-vault",children:"Nomad"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Otherwise, refer to the documentation of the specific OIDC relying party for usage details."}),"\n",(0,i.jsx)(n.h2,{id:"supported-flows",children:"Supported flows"}),"\n",(0,i.jsx)(n.p,{children:"The OpenBao OIDC provider feature currently supports the following authentication flow:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://openid.net/specs/openid-connect-core-1_0.html#CodeFlowAuth",children:"Authorization Code Flow"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"tutorial",children:"Tutorial"}),"\n",(0,i.jsxs)(n.p,{children:["Refer to the ",(0,i.jsx)(n.a,{href:"/tutorials/auth-methods/oidc-identity-provider",children:"OpenBao as an OIDC Identity Provider"}),"\ntutorial to learn how to configure a HashiCorp ",(0,i.jsx)(n.a,{href:"https://www.boundaryproject.io/",children:"Boundary"}),"\nto leverage OpenBao as a source of identity using the OIDC protocol."]}),"\n",(0,i.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,i.jsxs)(n.p,{children:["The OpenBao OIDC provider feature has a full HTTP API. Please see the\n",(0,i.jsx)(n.a,{href:"/api-docs/secret/identity/oidc-provider",children:"OIDC identity provider API"})," for more\ndetails."]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var i=t(96540);const o={},s=i.createContext(o);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);