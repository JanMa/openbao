"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5447],{88545:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>l,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var a=t(74848),o=t(28453);const r={description:"OpenBao Agent and OpenBao Proxy are daemons that can be used to perform some OpenBao\nfunctionality automatically."},i="OpenBao agent and OpenBao proxy",s={id:"agent-and-proxy/index",title:"OpenBao agent and OpenBao proxy",description:"OpenBao Agent and OpenBao Proxy are daemons that can be used to perform some OpenBao\nfunctionality automatically.",source:"@site/content/docs/agent-and-proxy/index.mdx",sourceDirName:"agent-and-proxy",slug:"/agent-and-proxy/",permalink:"/openbao/docs/agent-and-proxy/",draft:!1,unlisted:!1,editUrl:"https://github.com/openbao/openbao/tree/main/website/content/docs/agent-and-proxy/index.mdx",tags:[],version:"current",frontMatter:{description:"OpenBao Agent and OpenBao Proxy are daemons that can be used to perform some OpenBao\nfunctionality automatically."},sidebar:"docs",previous:{title:"Token helpers",permalink:"/openbao/docs/commands/token-helper"},next:{title:"Overview",permalink:"/openbao/docs/agent-and-proxy/autoauth/"}},c={},d=[{value:"Introduce OpenBao agent and OpenBao proxy to the workflow",id:"introduce-openbao-agent-and-openbao-proxy-to-the-workflow",level:3}];function p(e){const n={a:"a",code:"code",h1:"h1",h3:"h3",img:"img",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"openbao-agent-and-openbao-proxy",children:"OpenBao agent and OpenBao proxy"}),"\n",(0,a.jsx)(n.p,{children:"A valid client token must accompany most requests to OpenBao. This\nincludes all API requests, as well as via the OpenBao CLI and other libraries.\nTherefore, OpenBao clients must first authenticate with OpenBao to acquire a token.\nOpenBao provides several authentication methods to assist in\ndelivering this initial token."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"Client authentication",src:t(70745).A+"",width:"1018",height:"268"})}),"\n",(0,a.jsx)(n.p,{children:"If the client can securely acquire the token, all subsequent requests (e.g., request\ndatabase credentials, read key/value secrets) are processed based on the\ntrust established by a successful authentication."}),"\n",(0,a.jsx)(n.p,{children:"This means that client application must invoke the OpenBao API to authenticate\nwith OpenBao and manage the acquired token, in addition to invoking the API to\nrequest secrets from OpenBao. This implies code changes to client applications\nalong with additional testing and maintenance of the application."}),"\n",(0,a.jsxs)(n.p,{children:["The following code example implements OpenBao API to authenticate with OpenBao\nthrough ",(0,a.jsx)(n.a,{href:"/docs/auth/approle#code-example",children:"AppRole auth method"}),", and then uses\nthe returned client token to read secrets at ",(0,a.jsx)(n.code,{children:"kv-v2/data/creds"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n    ...snip...\n    openbao "github.com/openbao/openbao/api"\n)\n\n// Fetches a key-value secret (kv-v2) after authenticating via AppRole\nfunc getSecretWithAppRole() (string, error) {\n    config := openbao.DefaultConfig()\n\n    client := openbao.NewClient(config)\n    wrappingToken := ioutil.ReadFile("path/to/wrapping-token")\n    unwrappedToken := client.Logical().Unwrap(strings.TrimSuffix(string(wrappingToken), "\\n"))\n\n    secretID := unwrappedToken.Data["secret_id"]\n    roleID := os.Getenv("APPROLE_ROLE_ID")\n\n    params := map[string]interface{}{\n        "role_id":   roleID,\n        "secret_id": secretID,\n    }\n    resp := client.Logical().Write("auth/approle/login", params)\n    client.SetToken(resp.Auth.ClientToken)\n\n    secret, err := client.Logical().Read("kv-v2/data/creds")\n    if err != nil {\n        return "", fmt.Errorf("unable to read secret: %w", err)\n    }\n\n    data := secret.Data["data"].(map[string]interface{})\n\n    ...snip...\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"For some OpenBao deployments, making (and maintaining) these changes to\napplications may not be a problem, and may actually be preferred. This may be\napplied to scenarios where you have a small number of applications, or you want\nto keep strict, customized control over how each application interacts with\nOpenBao. However, in other situations where you have a large number of\napplications, as in large enterprises, you may not have the resources or expertise\nto update and maintain the OpenBao integration code for every application. When\nthird party applications are being deployed by the application, it is prohibited\nto add the OpenBao integration code."}),"\n",(0,a.jsx)(n.h3,{id:"introduce-openbao-agent-and-openbao-proxy-to-the-workflow",children:"Introduce OpenBao agent and OpenBao proxy to the workflow"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"/docs/agent-and-proxy/agent",children:"OpenBao Agent"})," and ",(0,a.jsx)(n.a,{href:"/docs/agent-and-proxy/proxy",children:"OpenBao Proxy"})," aim to remove this initial hurdle to adopt OpenBao by providing a\nmore scalable and simpler way for applications to integrate with OpenBao. OpenBao Agent can\nobtain secrets and provide them to applications, and OpenBao Proxy can act as\na proxy between OpenBao and the application, optionally simplifying the authentication process\nand caching requests."]}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Capability"}),(0,a.jsx)(n.th,{style:{textAlign:"center"},children:"OpenBao Agent"}),(0,a.jsx)(n.th,{style:{textAlign:"center"},children:"OpenBao Proxy"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsxs)(n.td,{children:[(0,a.jsx)(n.a,{href:"/docs/agent-and-proxy/autoauth",children:"Auto-Auth"})," to authenticate with OpenBao"]}),(0,a.jsx)(n.td,{style:{textAlign:"center"},children:"x"}),(0,a.jsx)(n.td,{style:{textAlign:"center"},children:"x"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsxs)(n.td,{children:[(0,a.jsx)(n.a,{href:"/docs/agent-and-proxy/agent/caching",children:"Caching"})," the newly created tokens and leases"]}),(0,a.jsx)(n.td,{style:{textAlign:"center"},children:"x"}),(0,a.jsx)(n.td,{style:{textAlign:"center"},children:"x"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsxs)(n.td,{children:["Run as a ",(0,a.jsx)(n.a,{href:"/docs/agent-and-proxy/agent/winsvc",children:"Windows Service"})]}),(0,a.jsx)(n.td,{style:{textAlign:"center"},children:"x"}),(0,a.jsx)(n.td,{style:{textAlign:"center"}})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsxs)(n.td,{children:[(0,a.jsx)(n.a,{href:"/docs/agent-and-proxy/agent/template",children:"Templating"})," to render user-supplied templates"]}),(0,a.jsx)(n.td,{style:{textAlign:"center"},children:"x"}),(0,a.jsx)(n.td,{style:{textAlign:"center"}})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsxs)(n.td,{children:[(0,a.jsx)(n.a,{href:"/docs/agent-and-proxy/proxy/apiproxy",children:"API Proxy"})," to act as a proxy for OpenBao API"]}),(0,a.jsx)(n.td,{style:{textAlign:"center"},children:"Will be deprecated"}),(0,a.jsx)(n.td,{style:{textAlign:"center"},children:"x"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsxs)(n.td,{children:[(0,a.jsx)(n.a,{href:"/docs/agent-and-proxy/agent/process-supervisor",children:"Process Supervisor"})," for injecting secrets as environment variables into a process"]}),(0,a.jsx)(n.td,{style:{textAlign:"center"},children:"x"}),(0,a.jsx)(n.td,{style:{textAlign:"center"}})]})]})]}),"\n",(0,a.jsxs)(n.p,{children:["To learn more, refer to the ",(0,a.jsx)(n.a,{href:"/docs/agent-and-proxy/agent",children:"OpenBao Agent"})," or ",(0,a.jsx)(n.a,{href:"/docs/agent-and-proxy/proxy",children:"OpenBao\nProxy"})," documentation page."]})]})}function l(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},70745:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/diagram-vault-agent-45615fd4bb2d9429e7d44f54d84432d3.png"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>s});var a=t(96540);const o={},r=a.createContext(o);function i(e){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),a.createElement(r.Provider,{value:n},e.children)}}}]);