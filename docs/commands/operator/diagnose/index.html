<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-commands/operator/diagnose" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">operator diagnose | OpenBao</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://janma.github.io/openbao/docs/commands/operator/diagnose/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="operator diagnose | OpenBao"><meta data-rh="true" name="description" content="&quot;bao operator diagnose&quot; is a new operator-centric command, focused on providing a clear description 
of what is working in OpenBao, and what is not working. The command focuses on why OpenBao cannot serve requests,
but will also warn on configurations or statuses that it deems to be unsafe in some way. "><meta data-rh="true" property="og:description" content="&quot;bao operator diagnose&quot; is a new operator-centric command, focused on providing a clear description 
of what is working in OpenBao, and what is not working. The command focuses on why OpenBao cannot serve requests,
but will also warn on configurations or statuses that it deems to be unsafe in some way. "><link data-rh="true" rel="icon" href="/openbao/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://janma.github.io/openbao/docs/commands/operator/diagnose/"><link data-rh="true" rel="alternate" href="https://janma.github.io/openbao/docs/commands/operator/diagnose/" hreflang="en"><link data-rh="true" rel="alternate" href="https://janma.github.io/openbao/docs/commands/operator/diagnose/" hreflang="x-default"><link rel="stylesheet" href="/openbao/assets/css/styles.a7459e73.css">
<script src="/openbao/assets/js/runtime~main.905ad1f5.js" defer="defer"></script>
<script src="/openbao/assets/js/main.e1fe259b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/openbao/"><div class="navbar__logo"><img src="/openbao/img/logo.svg" alt="OpenBao Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/openbao/img/logo.svg" alt="OpenBao Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">OpenBao</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/openbao/docs/">Docs</a><a class="navbar__item navbar__link" href="/openbao/api-docs/">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/openbao/openbao" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/what-is-openbao/">What is OpenBao?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/use-cases/">Use cases</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/get-started/developer-qs/">Getting Started</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/browser-support/">Browser Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/install/">Installing OpenBao</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/internals/">Internals</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/concepts/">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/configuration/">Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/openbao/docs/commands/">Commands (CLI)</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/agent/">agent</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/commands/audit/">audit</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/commands/auth/">auth</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/debug/">debug</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/delete/">delete</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/commands/kv/">kv</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/commands/lease/">lease</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/list/">list</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/login/">login</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/monitor/">monitor</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/openbao/docs/commands/operator/">operator</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/operator/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/openbao/docs/commands/operator/diagnose/">diagnose</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/operator/generate-root/">generate-root</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/operator/init/">init</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/operator/key-status/">key-status</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/operator/members/">members</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/operator/migrate/">migrate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/operator/raft/">raft</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/operator/rekey/">rekey</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/operator/rotate/">rotate</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/operator/seal/">seal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/operator/step-down/">step-down</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/operator/unseal/">unseal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/operator/usage/">usage</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/patch/">patch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/path-help/">path-help</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/commands/pki/">pki</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/commands/plugin/">plugin</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/commands/policy/">policy</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/print/">print</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/proxy/">proxy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/read/">read</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/commands/secrets/">secrets</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/server/">server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/ssh/">ssh</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/status/">status</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/commands/token/">token</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/commands/transit/">transit</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/unwrap/">unwrap</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/version/">version</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/version-history/">version-history</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/write/">write</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/commands/token-helper/">Token helpers</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/agent-and-proxy/">OpenBao Agent and Proxy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/secrets/">Secret Engines</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/auth/">Auth Methods</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/audit/">Audit Devices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/plugins/">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/platform/">Platforms</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/upgrading/">Upgrade Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/release-notes/">Release Notes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/deprecation/">Deprecation Notices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/policies/">Policies</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/faq/">FAQ</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/glossary/">Glossary</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/openbao/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Commands (CLI)</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">operator</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">diagnose</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>operator diagnose</h1>
<p>The operator diagnose command should be used primarily when OpenBao is down or
partially inoperational. The command can be used safely regardless of the state
OpenBao is in, but may return meaningless results for some of the test cases if the
OpenBao server is already running.</p>
<p>Note: if you run the diagnose command proactively, either before a server
starts or while a server is operational, please consult the documentation
on the individual checks below to see which checks are returning false error
messages or warnings.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h2>
<p>The following flags are available in addition to the <a href="/openbao/docs/commands/">standard set of
flags</a> included on all commands.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="output-options">Output options<a href="#output-options" class="hash-link" aria-label="Direct link to Output options" title="Direct link to Output options">​</a></h3>
<ul>
<li><code>-format</code> <code>(string: &quot;table&quot;)</code> - Print the output in the given format. Valid
formats are &quot;table&quot;, &quot;json&quot;, or &quot;yaml&quot;. This can also be specified via the
<code>VAULT_FORMAT</code> environment variable.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="output-layout">Output layout<a href="#output-layout" class="hash-link" aria-label="Direct link to Output layout" title="Direct link to Output layout">​</a></h4>
<p>The operator diagnose command will output a set of lines in the CLI.
Each line will begin with a prefix in parenthesis. These are:.</p>
<ul>
<li><code>[ success ]</code> - Denotes that the check was successful.</li>
<li><code>[ warning ]</code> - Denotes that the check has passed, but that there may be potential
issues to look into that may relate to the issues OpenBao is experiencing. Diagnose warns
frequently. These warnings are meant to serve as starting points in the debugging process.</li>
<li><code>[ failure ]</code> - Denotes that the check has failed. Failures are critical issues in the eyes
of the diagnose command.</li>
</ul>
<p>In addition to these prefixed lines, there may be output lines that are not prefixed, but are
color-coded purple. These are advice lines from Diagnose, and are meant to offer general guidance
on how to go about fixing potential warnings or failures that may arise.</p>
<p>Warn or fail prefixes in nested checks will bubble up to the parent if the prefix superceeds the
parent prefix. Fail superceeds warn, and warn superceeds ok. For example, if the TLS checks under
the Storage check fails, the <code>[ failure ]</code> prefix will bubble up to the Storage check.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="command-options">Command options<a href="#command-options" class="hash-link" aria-label="Direct link to Command options" title="Direct link to Command options">​</a></h3>
<ul>
<li><code>-config</code> <code>(string; &quot;&quot;)</code> - The path to the OpenBao configuration file used by
the OpenBao server on startup.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="diagnose-checks">Diagnose checks<a href="#diagnose-checks" class="hash-link" aria-label="Direct link to Diagnose checks" title="Direct link to Diagnose checks">​</a></h3>
<p>The following section details the various checks that Diagnose runs. Check names in documentation
will be separated by slashes to denote that they are nested, when applicable. For example, a check
documented as <code>A / B</code> will show up as <code>B</code> in the <code>operator diagnose</code> output, and will be nested
(indented) under <code>A</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="openbao-diagnose">OpenBao diagnose<a href="#openbao-diagnose" class="hash-link" aria-label="Direct link to OpenBao diagnose" title="Direct link to OpenBao diagnose">​</a></h4>
<p><code>OpenBao Diagnose</code> is the top level check that contains the rest of the checks. It will report the status
of the check</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-operating-system--check-open-file-limit">Check operating system / check open file limit<a href="#check-operating-system--check-open-file-limit" class="hash-link" aria-label="Direct link to Check operating system / check open file limit" title="Direct link to Check operating system / check open file limit">​</a></h4>
<p><code>Check Open File Limit</code> verifies that the open file limit value is set high enough for OpenBao
to run effectively. We recommend setting these limits to at least 1024768.</p>
<p>This check will be skipped on openbsd, arm, and windows.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-operating-system--check-disk-usage">Check operating system / check disk usage<a href="#check-operating-system--check-disk-usage" class="hash-link" aria-label="Direct link to Check operating system / check disk usage" title="Direct link to Check operating system / check disk usage">​</a></h4>
<p><code>Check Disk Usage</code> will report disk usage for each partition. For each partition on a prod host,
we recommend having at least 5% of the partition free to use, and at least 1 GB of space.</p>
<p>This check will be skipped on openbsd and arm.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="parse-configuration">Parse configuration<a href="#parse-configuration" class="hash-link" aria-label="Direct link to Parse configuration" title="Direct link to Parse configuration">​</a></h4>
<p><code>Parse Configuration</code> will check the OpenBao server config file for syntax errors. It will check
for extra values in the configuration file, repeated stanzas, and stanzas that do not belong
in the configuration file (for example a &quot;tcpp&quot; listener as opposed to a tcp listener).</p>
<p>Currently, the <code>storage</code> stanza is not checked.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-storage--create-storage-backend">Check storage / create storage backend<a href="#check-storage--create-storage-backend" class="hash-link" aria-label="Direct link to Check storage / create storage backend" title="Direct link to Check storage / create storage backend">​</a></h4>
<p><code>Create Storage Backend</code> ensures that the storage stanza configured in the OpenBao server config
has enough information to create a storage object internally. Common errors will have to do
with misconfigured fields in the storage stanza.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-storage--check-raft-folder-permissions">Check storage / check raft folder permissions<a href="#check-storage--check-raft-folder-permissions" class="hash-link" aria-label="Direct link to Check storage / check raft folder permissions" title="Direct link to Check storage / check raft folder permissions">​</a></h4>
<p><code>Check Raft Folder Permissions</code> computes the permissions on the raft folder, checks that a boltDB file
has been initialized within the folder previously, and ensures that the folder is not too permissive, but
at the same time has enough permissions to be used. The raft folder should not have <code>other</code> permissions, but
should have <code>group rw</code> or <code>owner rw</code>, depending on different setups. This check also warns if it detects a
symlink being used.</p>
<p>Note that this check will warn that a raft file has not been created if diagnose is run without any
pre-existing server runs.</p>
<p>This check will be skipped on windows.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-storage--check-raft-folder-ownership">Check storage / check raft folder ownership<a href="#check-storage--check-raft-folder-ownership" class="hash-link" aria-label="Direct link to Check storage / check raft folder ownership" title="Direct link to Check storage / check raft folder ownership">​</a></h4>
<p><code>Check Raft Folder Ownership</code> ensures that OpenBao does not need to run as root to access the boltDB folder.</p>
<p>Note that this check will warn that a raft file has not been created if diagnose is run without any
pre-existing server runs.</p>
<p>This check will be skipped on windows.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-storage--check-for-raft-quorum">Check storage / check for raft quorum<a href="#check-storage--check-for-raft-quorum" class="hash-link" aria-label="Direct link to Check storage / check for raft quorum" title="Direct link to Check storage / check for raft quorum">​</a></h4>
<p><code>Check For Raft Quorum</code> uses the FSM to ensure that there were an odd number of voters in the raft quorum when
OpenBao was last running.</p>
<p>Note that this check will warn that there are 0 voters if diagnose is run without any pre-existing server runs.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-storage--check-storage-access">Check storage / check storage access<a href="#check-storage--check-storage-access" class="hash-link" aria-label="Direct link to Check storage / check storage access" title="Direct link to Check storage / check storage access">​</a></h4>
<p><code>Check Storage Access</code> will try to write a dud value, named <code>diagnose/latency/&lt;uuid&gt;</code>, to storage.
Ensure that there is no important data at this location before running diagnose, as this check
will overwrite that data. This check will then try to list and read the value it wrote to ensure
the name and value is as expected.</p>
<p><code>Check Storage Access</code> will warn if any operation takes longer than 100ms, and error out if the
entire check takes longer than 30s.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-service-discovery--check-consul-service-discovery-tls">Check service discovery / check consul service discovery TLS<a href="#check-service-discovery--check-consul-service-discovery-tls" class="hash-link" aria-label="Direct link to Check service discovery / check consul service discovery TLS" title="Direct link to Check service discovery / check consul service discovery TLS">​</a></h4>
<p><code>Check Consul Service Discovery TLS</code> verifies TLS information included in the service discovery
stanza if the storage type is consul. If a certificate chain is provided, Diagnose parses
the root, intermediate, and leaf certificates, and checks each one for correctness.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-service-discovery--check-consul-direct-service-discovery">Check service discovery / check consul direct service discovery<a href="#check-service-discovery--check-consul-direct-service-discovery" class="hash-link" aria-label="Direct link to Check service discovery / check consul direct service discovery" title="Direct link to Check service discovery / check consul direct service discovery">​</a></h4>
<p><code>Check Consul Direct Service Discovery</code> is a consul-specific check that ensures OpenBao
is not accessing the consul server directly, but rather through a local agent.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-openbao-server-configuration-seals">Create OpenBao server configuration seals<a href="#create-openbao-server-configuration-seals" class="hash-link" aria-label="Direct link to Create OpenBao server configuration seals" title="Direct link to Create OpenBao server configuration seals">​</a></h4>
<p><code>Create OpenBao Server Configuration Seals</code> creates seals from the OpenBao configuration
stanza and verifies they can be initialized and finalized.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-transit-seal-tls">Check transit seal TLS<a href="#check-transit-seal-tls" class="hash-link" aria-label="Direct link to Check transit seal TLS" title="Direct link to Check transit seal TLS">​</a></h4>
<p><code>Check Transit Seal TLS</code> checks the TLS client certificate, key, and CA certificate
provided in a transit seal stanza (if one exists) for correctness.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-core-configuration--initialize-randomness-for-core">Create core configuration / initialize randomness for core<a href="#create-core-configuration--initialize-randomness-for-core" class="hash-link" aria-label="Direct link to Create core configuration / initialize randomness for core" title="Direct link to Create core configuration / initialize randomness for core">​</a></h4>
<p><code>Initialize Randomness for Core</code> ensures that OpenBao has access to the randReader that
the OpenBao core uses.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ha-storage">HA storage<a href="#ha-storage" class="hash-link" aria-label="Direct link to HA storage" title="Direct link to HA storage">​</a></h4>
<p>This check and any nested checks will be the same as the <code>Check Storage</code> checks.
The only difference is that the checks here will be run on whatever is specified in the
<code>ha_storage</code> section of the OpenBao configuration, as opposed to the <code>storage</code> section.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="determine-redirect-address">Determine redirect address<a href="#determine-redirect-address" class="hash-link" aria-label="Direct link to Determine redirect address" title="Direct link to Determine redirect address">​</a></h4>
<p>Ensures that one of the <code>VAULT_API_ADDR</code>, <code>VAULT_REDIRECT_ADDR</code>, or <code>VAULT_ADVERTISE_ADDR</code>
environment variables are set, or that the redirect address is specified in the OpenBao
configuration.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-cluster-address">Check cluster address<a href="#check-cluster-address" class="hash-link" aria-label="Direct link to Check cluster address" title="Direct link to Check cluster address">​</a></h4>
<p>Parses the cluster address from the <code>VAULT_CLUSTER_ADDR</code> environment variable, or from the
redirect address or cluster address specified in the OpenBao configuration, and checks that
the address is of the form <code>host:port</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-core-creation">Check core creation<a href="#check-core-creation" class="hash-link" aria-label="Direct link to Check core creation" title="Direct link to Check core creation">​</a></h4>
<p><code>Check Core Creation</code> verifies the logical configuration checks that OpenBao does when it
creates a core object. These are runtime checks, meaning any errors thrown by this diagnose
test will also be thrown by the OpenBao server itself when it is run.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="start-listeners--check-listener-tls">Start listeners / check listener TLS<a href="#start-listeners--check-listener-tls" class="hash-link" aria-label="Direct link to Start listeners / check listener TLS" title="Direct link to Start listeners / check listener TLS">​</a></h4>
<p><code>Check Listener TLS</code> verifies the server certificate file and key are valid and matching.
It also checks the client CA file, if one is provided, for a valid certificate, and performs
the standard runtime listener checks on the listener configuration stanza, such as verifying
that the minimum and maximum TLS versions are within the bounds of what OpenBao supports.</p>
<p>Like all the other Diagnose TLS checks, it will warn if any of the certificates provided are
set to expire within the next month.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="start-listeners--create-listeners">Start listeners / create listeners<a href="#start-listeners--create-listeners" class="hash-link" aria-label="Direct link to Start listeners / create listeners" title="Direct link to Start listeners / create listeners">​</a></h4>
<p><code>Create Listeners</code> uses the listener configuration to initialize the listeners, erroring with
a server error if anything goes wrong.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-autounseal-encryption">Check autounseal encryption<a href="#check-autounseal-encryption" class="hash-link" aria-label="Direct link to Check autounseal encryption" title="Direct link to Check autounseal encryption">​</a></h4>
<p><code>Check Autounseal Encryption</code> will initialize the barrier using the seal stanza, if the seal
type is not a shamir seal, and use it to encrypt and decrypt a dud value.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-server-before-runtime">Check server before runtime<a href="#check-server-before-runtime" class="hash-link" aria-label="Direct link to Check server before runtime" title="Direct link to Check server before runtime">​</a></h4>
<p><code>Check Server Before Runtime</code> achieves parity with the server run command, running through
the runtime code checks before the server is initialized to ensure that nothing fails.
This check will never fail without another diagnose check failing.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/openbao/openbao/tree/main/website/content/docs/commands/operator/diagnose.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/openbao/docs/commands/operator/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Overview</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/openbao/docs/commands/operator/generate-root/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">generate-root</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a><ul><li><a href="#output-options" class="table-of-contents__link toc-highlight">Output options</a></li><li><a href="#command-options" class="table-of-contents__link toc-highlight">Command options</a></li><li><a href="#diagnose-checks" class="table-of-contents__link toc-highlight">Diagnose checks</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/openbao/docs/">Intro</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/openbao/openbao/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://chat.lfx.linuxfoundation.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chat Server<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://wiki.lfedge.org/display/OH/OpenBao+%28Hashicorp+Vault+Fork+effort%29+FAQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Wiki<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/openbao/openbao" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 The OpenBao Authors. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>