<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-concepts/tokens" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Tokens | OpenBao</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://janma.github.io/openbao/docs/concepts/tokens/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Tokens | OpenBao"><meta data-rh="true" name="description" content="Tokens are a core auth method in OpenBao. Concepts and important features."><meta data-rh="true" property="og:description" content="Tokens are a core auth method in OpenBao. Concepts and important features."><link data-rh="true" rel="icon" href="/openbao/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://janma.github.io/openbao/docs/concepts/tokens/"><link data-rh="true" rel="alternate" href="https://janma.github.io/openbao/docs/concepts/tokens/" hreflang="en"><link data-rh="true" rel="alternate" href="https://janma.github.io/openbao/docs/concepts/tokens/" hreflang="x-default"><link rel="stylesheet" href="/openbao/assets/css/styles.a7459e73.css">
<script src="/openbao/assets/js/runtime~main.3b401cda.js" defer="defer"></script>
<script src="/openbao/assets/js/main.a8b794cc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/openbao/"><div class="navbar__logo"><img src="/openbao/img/logo.svg" alt="OpenBao Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/openbao/img/logo.svg" alt="OpenBao Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">OpenBao</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/openbao/docs/">Docs</a><a class="navbar__item navbar__link" href="/openbao/api-docs/">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/openbao/openbao" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/what-is-openbao/">What is OpenBao?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/use-cases/">Use cases</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/get-started/developer-qs/">Getting Started</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/browser-support/">Browser Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/install/">Installing OpenBao</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/internals/">Internals</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/openbao/docs/concepts/">Concepts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/dev-server/">&#x27;Dev&#x27; Server</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/seal/">Seal/Unseal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/lease/">Lease, renew, and revoke</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/auth/">Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/openbao/docs/concepts/tokens/">Tokens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/identity/">Identity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/oidc-provider/">OIDC provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/response-wrapping/">Response wrapping</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/policies/">Policies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/password-policies/">Password policies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/username-templating/">Username templating</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/ha/">High Availability</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/storage/">Storage</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/concepts/integrated-storage/">Integrated Storage</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/pgp-gpg-keybase/">PGP, GnuPG and Keybase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/recovery-mode/">Recovery mode</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/resource-quotas/">Resource quotas</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/concepts/client-count/">Client Clount</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/transform/">Transform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/mount-migration/">Mount migration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/duration-format/">Duration string format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/user-lockout/">User lockout</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/concepts/events/">Events</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/configuration/">Configuration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/commands/">Commands (CLI)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/agent-and-proxy/">OpenBao Agent and Proxy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/secrets/">Secret Engines</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/auth/">Auth Methods</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/audit/">Audit Devices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/plugins/">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/platform/">Platforms</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/upgrading/">Upgrade Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/release-notes/">Release Notes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/deprecation/">Deprecation Notices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/policies/">Policies</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/faq/">FAQ</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/glossary/">Glossary</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/openbao/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Concepts</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Tokens</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Tokens</h1>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Internal token structure is volatile</div><div class="admonitionContent_BuS1"><p>Tokens are opaque values so their structure is undocumented and subject to change.
Scripts and automations that rely on the internal structure of a token in scripts will break.</p></div></div>
<p>Tokens are the core method for <em>authentication</em> within OpenBao. Tokens
can be used directly or <a href="/openbao/docs/concepts/auth/">auth methods</a>
can be used to dynamically generate tokens based on external identities.</p>
<p>If you&#x27;ve gone through the getting started guide, you probably noticed that
<code>bao server -dev</code> (or <code>bao operator init</code> for a non-dev server) outputs an
initial &quot;root token.&quot; This is the first method of authentication for OpenBao.
It is also the only auth method that cannot be disabled.</p>
<p>As stated in the <a href="/openbao/docs/concepts/auth/">authentication concepts</a>,
all external authentication mechanisms, such as GitHub, map down to dynamically
created tokens. These tokens have all the same properties as a normal manually
created token.</p>
<p>Within OpenBao, tokens map to information. The most important information mapped
to a token is a set of one or more attached
<a href="/openbao/docs/concepts/policies/">policies</a>. These policies control what the token
holder is allowed to do within OpenBao. Other mapped information includes
metadata that can be viewed and is added to the audit log, such as creation
time, last renewal time, and more.</p>
<p>Read on for a deeper dive into token concepts.  See the
<a href="/openbao/tutorials/tokens/tokens/">tokens tutorial</a>
for details on how these concepts play out in practice.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="token-types">Token types<a href="#token-types" class="hash-link" aria-label="Direct link to Token types" title="Direct link to Token types">​</a></h2>
<p>There are two types of tokens: <code>service</code> tokens and <code>batch</code> tokens. A section
near the bottom of this page contains detailed information about their
differences, but it is useful to understand other token concepts first. The
features in the following sections all apply to service tokens, and their
applicability to batch tokens is discussed later.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-token-store">The token store<a href="#the-token-store" class="hash-link" aria-label="Direct link to The token store" title="Direct link to The token store">​</a></h2>
<p>Often in documentation or in help channels, the &quot;token store&quot; is referenced.
This is the same as the <a href="/openbao/docs/auth/token/"><code>token</code> authentication
backend</a>. This is a special
backend in that it is responsible for creating and storing tokens, and cannot
be disabled. It is also the only auth method that has no login
capability -- all actions require existing authenticated tokens.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="root-tokens">Root tokens<a href="#root-tokens" class="hash-link" aria-label="Direct link to Root tokens" title="Direct link to Root tokens">​</a></h2>
<p>Root tokens are tokens that have the <code>root</code> policy attached to them. Root
tokens can do anything in OpenBao. <em>Anything</em>. In addition, they are the only
type of token within OpenBao that can be set to never expire without any renewal
needed. As a result, it is purposefully hard to create root tokens; in fact
there are only three ways to create root tokens:</p>
<ol>
<li>The initial root token generated at <code>bao operator init</code> time -- this token has no
expiration</li>
<li>By using another root token; a root token with an expiration cannot create a
root token that never expires</li>
<li>By using <code>bao operator generate-root</code> (<a href="/openbao/tutorials/operations/generate-root/">example</a>)
with the permission of a quorum of unseal key holders</li>
</ol>
<p>Root tokens are useful in development but should be extremely carefully guarded
in production. In fact, the OpenBao team recommends that root tokens are only
used for just enough initial setup (usually, setting up auth methods
and policies necessary to allow administrators to acquire more limited tokens)
or in emergencies, and are revoked immediately after they are no longer needed.
If a new root token is needed, the <code>operator generate-root</code> command and associated
<a href="/openbao/api-docs/system/generate-root/">API endpoint</a> can be used to generate one on-the-fly.</p>
<p>It is also good security practice for there to be multiple eyes on a terminal
whenever a root token is live. This way multiple people can verify as to the
tasks performed with the root token, and that the token was revoked immediately
after these tasks were completed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="token-hierarchies-and-orphan-tokens">Token hierarchies and orphan tokens<a href="#token-hierarchies-and-orphan-tokens" class="hash-link" aria-label="Direct link to Token hierarchies and orphan tokens" title="Direct link to Token hierarchies and orphan tokens">​</a></h2>
<p>Normally, when a token holder creates new tokens, these tokens will be created
as children of the original token; tokens they create will be children of them;
and so on. When a parent token is revoked, all of its child tokens -- and all
of their leases -- are revoked as well. This ensures that a user cannot escape
revocation by simply generating a never-ending tree of child tokens.</p>
<p>Often this behavior is not desired, so users with appropriate access can create
<code>orphan</code> tokens. These tokens have no parent -- they are the root of their own
token tree. These orphan tokens can be created:</p>
<ol>
<li>Via <code>write</code> access to the <code>auth/token/create-orphan</code> endpoint</li>
<li>By having <code>sudo</code> or <code>root</code> access to the <code>auth/token/create</code>
and setting the <code>no_parent</code> parameter to <code>true</code></li>
<li>Via token store roles</li>
<li>By logging in with any other (non-<code>token</code>) auth method</li>
</ol>
<p>Users with appropriate permissions can also use the <code>auth/token/revoke-orphan</code>
endpoint, which revokes the given token but rather than revoke the rest of the
tree, it instead sets the tokens&#x27; immediate children to be orphans. Use with
caution!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="token-accessors">Token accessors<a href="#token-accessors" class="hash-link" aria-label="Direct link to Token accessors" title="Direct link to Token accessors">​</a></h2>
<p>When tokens are created, a token accessor is also created and returned. This
accessor is a value that acts as a reference to a token and can only be used to
perform limited actions:</p>
<ol>
<li>Look up a token&#x27;s properties (not including the actual token ID)</li>
<li>Look up a token&#x27;s capabilities on a path</li>
<li>Renew the token</li>
<li>Revoke the token</li>
</ol>
<p>The token <em>making the call</em>, <em>not</em> the token associated with the accessor, must
have appropriate permissions for these functions.</p>
<p>There are many useful workflows around token accessors. As an example, a
service that creates tokens on behalf of another service (such as the
<a href="https://www.nomadproject.io/" target="_blank" rel="noopener noreferrer">Nomad</a> scheduler) can store the accessor
correlated with a particular job ID. When the job is complete, the accessor can
be used to instantly revoke the token given to the job and all of its leased
credentials, limiting the chance that a bad actor will discover and use them.</p>
<p>Audit devices can optionally be set to not obfuscate token accessors in audit
logs. This provides a way to quickly revoke tokens in case of an emergency.
However, it also means that the audit logs can be used to perform a larger-scale
denial of service attack.</p>
<p>Finally, the only way to &quot;list tokens&quot; is via the <code>auth/token/accessors</code>
command, which actually gives a list of token accessors. While this is still a
dangerous endpoint (since listing all of the accessors means that they can then
be used to revoke all tokens), it also provides a way to audit and revoke the
currently-active set of tokens.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="token-time-to-live-periodic-tokens-and-explicit-max-ttls">Token Time-To-Live, periodic tokens, and explicit max TTLs<a href="#token-time-to-live-periodic-tokens-and-explicit-max-ttls" class="hash-link" aria-label="Direct link to Token Time-To-Live, periodic tokens, and explicit max TTLs" title="Direct link to Token Time-To-Live, periodic tokens, and explicit max TTLs">​</a></h2>
<p>Every non-root token has a time-to-live (TTL) associated with it, which is a
current period of validity since either the token&#x27;s creation time or last
renewal time, whichever is more recent. (Root tokens may have a TTL associated,
but the TTL may also be 0, indicating a token that never expires). After the
current TTL is up, the token will no longer function -- it, and its associated
leases, are revoked.</p>
<p>If the token is renewable, OpenBao can be asked to extend the token validity
period using <code>bao token renew</code> or the appropriate renewal endpoint. At this
time, various factors come into play. What happens depends upon whether the
token is a periodic token (available for creation by <code>root</code>/<code>sudo</code> users, token
store roles, or some auth methods), has an explicit maximum TTL
attached, or neither.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-general-case">The general case<a href="#the-general-case" class="hash-link" aria-label="Direct link to The general case" title="Direct link to The general case">​</a></h3>
<p>In the general case, where there is neither a period nor explicit maximum TTL
value set on the token, the token&#x27;s lifetime since it was created will be
compared to the maximum TTL. This maximum TTL value is dynamically generated
and can change from renewal to renewal, so the value cannot be displayed when a
token&#x27;s information is looked up. It is based on a combination of factors:</p>
<ol>
<li>The system max TTL, which is 32 days but can be changed in OpenBao&#x27;s
configuration file.</li>
<li>The max TTL set on a mount using <a href="/openbao/api-docs/system/mounts/">mount
tuning</a>. This value
is allowed to override the system max TTL -- it can be longer or shorter,
and if set this value will be respected.</li>
<li>A value suggested by the auth method that issued the token. This
might be configured on a per-role, per-group, or per-user basis. This value
is allowed to be less than the mount max TTL (or, if not set, the system max
TTL), but it is not allowed to be longer.</li>
</ol>
<p>Note that the values in (2) and (3) may change at any given time, which is why
a final determination about the current allowed max TTL is made at renewal time
using the current values. It is also why it is important to always ensure that
the TTL returned from a renewal operation is within an allowed range; if this
value is not extending, likely the TTL of the token cannot be extended past its
current value and the client may want to reauthenticate and acquire a new
token. However, outside of direct operator interaction, OpenBao will never revoke
a token before the returned TTL has expired.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="explicit-max-ttls">Explicit max TTLs<a href="#explicit-max-ttls" class="hash-link" aria-label="Direct link to Explicit max TTLs" title="Direct link to Explicit max TTLs">​</a></h3>
<p>Tokens can have an explicit max TTL set on them. This value becomes a hard
limit on the token&#x27;s lifetime -- no matter what the values in (1), (2), and (3)
from the general case are, the token cannot live past this explicitly-set
value. This has an effect even when using periodic tokens to escape the normal
TTL mechanism.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="periodic-tokens">Periodic tokens<a href="#periodic-tokens" class="hash-link" aria-label="Direct link to Periodic tokens" title="Direct link to Periodic tokens">​</a></h3>
<p>In some cases, having a token be revoked would be problematic -- for instance,
if a long-running service needs to maintain its SQL connection pool over a long
period of time. In this scenario, a periodic token can be used. Periodic tokens
can be created in a few ways:</p>
<ol>
<li>By having <code>sudo</code> capability or a <code>root</code> token with the <code>auth/token/create</code>
endpoint</li>
<li>By using token store roles</li>
<li>By using an auth method that supports issuing these, such as
AppRole</li>
</ol>
<p>At issue time, the TTL of a periodic token will be equal to the configured
period. At every renewal time, the TTL will be reset back to this configured
period, and as long as the token is successfully renewed within each of these
periods of time, it will never expire. Outside of <code>root</code> tokens, it is
currently the only way for a token in OpenBao to have an unlimited lifetime.</p>
<p>The idea behind periodic tokens is that it is easy for systems and services to
perform an action relatively frequently -- for instance, every two hours, or
even every five minutes. Therefore, as long as a system is actively renewing
this token -- in other words, as long as the system is alive -- the system is
allowed to keep using the token and any associated leases. However, if the
system stops renewing within this period (for instance, if it was shut down),
the token will expire relatively quickly. It is good practice to keep this
period as short as possible, and generally speaking it is not useful for humans
to be given periodic tokens.</p>
<p>There are a few important things to know when using periodic tokens:</p>
<ul>
<li>When a periodic token is created via a token store role, the <em>current</em> value
of the role&#x27;s period setting will be used at renewal time</li>
<li>A token with both a period and an explicit max TTL will act like a periodic
token but will be revoked when the explicit max TTL is reached</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cidr-bound-tokens">CIDR-Bound tokens<a href="#cidr-bound-tokens" class="hash-link" aria-label="Direct link to CIDR-Bound tokens" title="Direct link to CIDR-Bound tokens">​</a></h2>
<p>Some tokens are able to be bound to CIDR(s) that restrict the range of client
IPs allowed to use them. These affect all tokens except for non-expiring root
tokens (those with a TTL of zero). If a root token has an expiration, it also
is affected by CIDR-binding.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="token-types-in-detail">Token types in detail<a href="#token-types-in-detail" class="hash-link" aria-label="Direct link to Token types in detail" title="Direct link to Token types in detail">​</a></h2>
<p>There are currently two types of tokens.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="service-tokens">Service tokens<a href="#service-tokens" class="hash-link" aria-label="Direct link to Service tokens" title="Direct link to Service tokens">​</a></h3>
<p>Service tokens are what users will generally think of as &quot;normal&quot; OpenBao tokens.
They support all features, such as renewal, revocation, creating child tokens,
and more. They are correspondingly heavyweight to create and track.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="batch-tokens">Batch tokens<a href="#batch-tokens" class="hash-link" aria-label="Direct link to Batch tokens" title="Direct link to Batch tokens">​</a></h3>
<p>Batch tokens are encrypted blobs that carry enough information for them to
be used for OpenBao actions, but they require no storage on disk to track them.
As a result they are extremely lightweight and scalable, but lack most of the
flexibility and features of service tokens.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="token-type-comparison">Token type comparison<a href="#token-type-comparison" class="hash-link" aria-label="Direct link to Token type comparison" title="Direct link to Token type comparison">​</a></h3>
<p>This reference chart describes the difference in behavior between service and
batch tokens.</p>
<table><thead><tr><th></th><th style="text-align:right">Service Tokens</th><th style="text-align:right">Batch Tokens</th></tr></thead><tbody><tr><td>Can Be Root Tokens</td><td style="text-align:right">Yes</td><td style="text-align:right">No</td></tr><tr><td>Can Create Child Tokens</td><td style="text-align:right">Yes</td><td style="text-align:right">No</td></tr><tr><td>Can be Renewable</td><td style="text-align:right">Yes</td><td style="text-align:right">No</td></tr><tr><td>Manually Revocable</td><td style="text-align:right">Yes</td><td style="text-align:right">No</td></tr><tr><td>Can be Periodic</td><td style="text-align:right">Yes</td><td style="text-align:right">No</td></tr><tr><td>Can have Explicit Max TTL</td><td style="text-align:right">Yes</td><td style="text-align:right">No (always uses a fixed TTL)</td></tr><tr><td>Has Accessors</td><td style="text-align:right">Yes</td><td style="text-align:right">No</td></tr><tr><td>Has Cubbyhole</td><td style="text-align:right">Yes</td><td style="text-align:right">No</td></tr><tr><td>Revoked with Parent (if not orphan)</td><td style="text-align:right">Yes</td><td style="text-align:right">Stops Working</td></tr><tr><td>Dynamic Secrets Lease Assignment</td><td style="text-align:right">Self</td><td style="text-align:right">Parent (if not orphan)</td></tr><tr><td>Cost</td><td style="text-align:right">Heavyweight; multiple storage writes per token creation</td><td style="text-align:right">Lightweight; no storage cost for token creation</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="service-vs-batch-token-lease-handling">Service vs. batch token lease handling<a href="#service-vs-batch-token-lease-handling" class="hash-link" aria-label="Direct link to Service vs. batch token lease handling" title="Direct link to Service vs. batch token lease handling">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="service-tokens-1">Service tokens<a href="#service-tokens-1" class="hash-link" aria-label="Direct link to Service tokens" title="Direct link to Service tokens">​</a></h4>
<p>Leases created by service tokens (including child tokens&#x27; leases) are tracked
along with the service token and revoked when the token expires.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="batch-tokens-1">Batch tokens<a href="#batch-tokens-1" class="hash-link" aria-label="Direct link to Batch tokens" title="Direct link to Batch tokens">​</a></h4>
<p>Leases created by batch tokens are constrained to the remaining TTL of the
batch tokens and, if the batch token is not an orphan, are tracked by the
parent. They are revoked when the batch token&#x27;s TTL expires, or when the batch
token&#x27;s parent is revoked (at which point the batch token is also denied access
to OpenBao).</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/openbao/openbao/tree/main/website/content/docs/concepts/tokens.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/openbao/docs/concepts/auth/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Authentication</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/openbao/docs/concepts/identity/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Identity</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#token-types" class="table-of-contents__link toc-highlight">Token types</a></li><li><a href="#the-token-store" class="table-of-contents__link toc-highlight">The token store</a></li><li><a href="#root-tokens" class="table-of-contents__link toc-highlight">Root tokens</a></li><li><a href="#token-hierarchies-and-orphan-tokens" class="table-of-contents__link toc-highlight">Token hierarchies and orphan tokens</a></li><li><a href="#token-accessors" class="table-of-contents__link toc-highlight">Token accessors</a></li><li><a href="#token-time-to-live-periodic-tokens-and-explicit-max-ttls" class="table-of-contents__link toc-highlight">Token Time-To-Live, periodic tokens, and explicit max TTLs</a><ul><li><a href="#the-general-case" class="table-of-contents__link toc-highlight">The general case</a></li><li><a href="#explicit-max-ttls" class="table-of-contents__link toc-highlight">Explicit max TTLs</a></li><li><a href="#periodic-tokens" class="table-of-contents__link toc-highlight">Periodic tokens</a></li></ul></li><li><a href="#cidr-bound-tokens" class="table-of-contents__link toc-highlight">CIDR-Bound tokens</a></li><li><a href="#token-types-in-detail" class="table-of-contents__link toc-highlight">Token types in detail</a><ul><li><a href="#service-tokens" class="table-of-contents__link toc-highlight">Service tokens</a></li><li><a href="#batch-tokens" class="table-of-contents__link toc-highlight">Batch tokens</a></li><li><a href="#token-type-comparison" class="table-of-contents__link toc-highlight">Token type comparison</a></li><li><a href="#service-vs-batch-token-lease-handling" class="table-of-contents__link toc-highlight">Service vs. batch token lease handling</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/openbao/docs/">Intro</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/openbao/openbao/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://chat.lfx.linuxfoundation.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chat Server<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://wiki.lfedge.org/display/OH/OpenBao+%28Hashicorp+Vault+Fork+effort%29+FAQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Wiki<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/openbao/openbao" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 The OpenBao Authors. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>