<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-policies/migration" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Migration policy | OpenBao</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://janma.github.io/openbao/docs/policies/migration/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Migration policy | OpenBao"><meta data-rh="true" name="description" content="The OpenBao policy around migration from upstream to OpenBao."><meta data-rh="true" property="og:description" content="The OpenBao policy around migration from upstream to OpenBao."><link data-rh="true" rel="icon" href="/openbao/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://janma.github.io/openbao/docs/policies/migration/"><link data-rh="true" rel="alternate" href="https://janma.github.io/openbao/docs/policies/migration/" hreflang="en"><link data-rh="true" rel="alternate" href="https://janma.github.io/openbao/docs/policies/migration/" hreflang="x-default"><link rel="stylesheet" href="/openbao/assets/css/styles.a7459e73.css">
<script src="/openbao/assets/js/runtime~main.73807cf4.js" defer="defer"></script>
<script src="/openbao/assets/js/main.6ba2fa5e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/openbao/"><div class="navbar__logo"><img src="/openbao/img/logo.svg" alt="OpenBao Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/openbao/img/logo.svg" alt="OpenBao Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">OpenBao</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/openbao/docs/">Docs</a><a class="navbar__item navbar__link" href="/openbao/api-docs/">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/openbao/openbao" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Migration policy</h1>
<p>This policy was original <a href="https://github.com/orgs/openbao/discussions/55" target="_blank" rel="noopener noreferrer">discussed on
GitHub</a> and ratified on
the <a href="https://wiki.lfedge.org/display/OH/OpenBao+Meetings" target="_blank" rel="noopener noreferrer">February 8th, 2024 meeting</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="definitions">Definitions<a href="#definitions" class="hash-link" aria-label="Direct link to Definitions" title="Direct link to Definitions">​</a></h2>
<p>From a consumption perspective, there are three personas we can define:</p>
<ol>
<li>
<p><strong>Bao Operators</strong>. These are the people tasked with deploying updates to
the <code>bao</code> binary, handling outages, &amp;c. They might typically access <code>/sys</code>,
setup new mounts, get high-privileged root tokens temporarily to setup
additional clusters or change quotas, &amp;c, but aren&#x27;t (for this discussion)
direct consumers of many secrets methods. They likely also interface with
OpenBao&#x27;s configuration, logging, and auditing interfaces, and may interact
briefly (during outages &amp;c) with storage directly. They&#x27;d be in charge
of handling any migration which needs to occur during an upgrade or change
event from upstream to OpenBao. While a breaking change, these are most
likely to have a flexible enough deployment &amp; workflow to accept change.</p>
</li>
<li>
<p><strong>Connection Operators</strong>. These are individuals who deploy applications
which talk to OpenBao. They might directly interact with <code>bao</code>&#x27;s API
namespace, to set up new accounts, services, potentially (if delegated by
Bao operators) creating new secrets engines, and configuration any existing
secrets engines in their purview. They may do this directly (via CLI or
UI) or indirectly (via a centralized management service like OpenTofu).
These types of users can accept a moderate amount of change, but changes
to APIs (especially unexpectedly) can cause issues.</p>
</li>
<li>
<p><strong>Applications &amp; end-users</strong>. These are individuals (broadly speaking)
which only interface with the API of authentication and secrets engines to
get secrets (again, broadly speaking -- a PKI certificate is not a
traditional secret nor does Transit expose a similar interface that grants
leases). These typically have the least flexible workflow and are hesitant
to change.</p>
</li>
</ol>
<p>We can also talk about compatibility on several layers:</p>
<ol>
<li>
<p><strong>Seal compatibility</strong>. Is encrypted data drop-in compatible with
upstream, for a given combination of <code>(seal mechanism, storage provider, plugin)</code>. Can this storage layout be read (i.e., is the disk tree similar)
by core and can the resulting plugin be loaded and function equivalently
to API consumers? This implies no to minimal migration necessary.</p>
</li>
<li>
<p><strong>Storage compatibility</strong>. For unencrypted data (i.e., using an unencrypted
backup/one-time migration bundle or using the unsupported-but-useful
<code>sys/raw</code> interface), can this be migrated from an upstream instance
directly into downstream at an equivalent path without rewriting the
data itself. This means all the rest of the core (minus the initial
encryption layer and potentially meaning a different physical storage
backend) are compatible with  upstream.</p>
</li>
<li>
<p><strong>API compatibility</strong>. For consumers of upstream&#x27;s secret&#x27;s or auth
plugin&#x27;s API only, would they be able to point interchangeably at an
upstream or OpenBao instance without caring about which, assuming suitable
data &amp; plugins are available in both locations. This usage does not extend
to non-plugin APIs (e.g., under <code>/sys</code>), but should include the GRPC
external plugin communication mechanism.</p>
</li>
</ol>
<p>(In this hierarchy it is implied that 1 implies 2 implies 3, i.e., a seal
or storage compatible fork would imply API compatibility, and likewise
seal compatibility implies storage compatibility).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="observations">Observations<a href="#observations" class="hash-link" aria-label="Direct link to Observations" title="Direct link to Observations">​</a></h2>
<p>Notably, API compatibility is most aligned with the connection operators&#x27; and
application &amp; end-users&#x27; goals: minimize API change. While seal and storage
compatibility are cool from a Bao operator&#x27;s perspective, breaking either
(w.r.t. upstream -- likely ahead of initial GA) results in a one-time
migration, but difficult from a Bao development community perspective. This
type of compatibility helps cross-adoption but becomes hard to support,
especially as several key portions are impossible to do without reverse
engineering Vault Enterprise (e.g., auto-unseal, seal wrapping, replication,
certain secret engine features, ...).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="proposal">Proposal<a href="#proposal" class="hash-link" aria-label="Direct link to Proposal" title="Direct link to Proposal">​</a></h2>
<p>Aim for API compatibility only, with limited seal compatibility when using remaining
seal, storage, and plugins <a href="https://github.com/orgs/openbao/discussions/64" target="_blank" rel="noopener noreferrer">as discussed in that proposal</a>.</p>
<p>This allows us to prune unnecessary features, create alternative,
non-compatible implementations of various upstream, Enterprise features, and
decreases maintenance burdens. This allows us to create a more healthy,
separate but welcoming community from upstream.</p>
<p>It also recognizes that OpenBao (by discussing removing support for already
deprecated changes or removing plugins that no maintainer has stepped up to
support) will inevitably, intentionally or otherwise, deviate from upstream.
It provides support commitment to portions of the organization most resistant
to change, and allows Bao operators to decide whether or not to make the
migration. It also recognizes that upstream may or may not make other decisions
and potentially backwards-incompatible changes of their own, allowing us to
take a different approach if necessary.</p>
<p>This still allows us to take advantage of the broader secrets &amp; auth engine
ecosystem, as GRPC compatibility is still encouraged. And third-party client
tooling should continue to function between the two, unless they were using
unsupported, internal implementation details and crossing the API boundary.</p>
<p>However, it walks a fine line that, when a user&#x27;s existing usage of upstream aligns
with OpenBao&#x27;s goals, the two should be drop-in compatible at the initial release.
This then allows a smoother migration between the two projects.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="migration-path">Migration path<a href="#migration-path" class="hash-link" aria-label="Direct link to Migration path" title="Direct link to Migration path">​</a></h3>
<p>This means that some operators will need to make a conscious, one-time migration
from a compatible upstream version to an OpenBao version. This likely warrants
the creation of documentation and tools to help aid this migration, on a
per-plugin basis. It means that OpenBao&#x27;s server will not be drop-in binary
equivalent from upstream&#x27;s, and that we should likely place some marker to
detect and prevent incompatible, unsupported usage.</p>
<p>The remaining operators (who use a supported subset) will be able to
drop-in replace like a regular upgrade.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/openbao/openbao/tree/main/website/content/docs/policies/migration.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#definitions" class="table-of-contents__link toc-highlight">Definitions</a></li><li><a href="#observations" class="table-of-contents__link toc-highlight">Observations</a></li><li><a href="#proposal" class="table-of-contents__link toc-highlight">Proposal</a><ul><li><a href="#migration-path" class="table-of-contents__link toc-highlight">Migration path</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/openbao/docs/">Intro</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/openbao/openbao/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://chat.lfx.linuxfoundation.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chat Server<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://wiki.lfedge.org/display/OH/OpenBao+%28Hashicorp+Vault+Fork+effort%29+FAQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Wiki<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/openbao/openbao" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 The OpenBao Authors. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>