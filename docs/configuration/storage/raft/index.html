<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-configuration/storage/raft" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Integrated storage (Raft) backend | OpenBao</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://janma.github.io/openbao/docs/configuration/storage/raft/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Integrated storage (Raft) backend | OpenBao"><meta data-rh="true" name="description" content="
The Integrated Storage (Raft) backend is used to persist OpenBao&#x27;s data. Unlike all the other
storage backends, this backend does not operate from a single source for the
data. Instead all the nodes in an OpenBao cluster will have a replicated copy of
the entire data. The data is replicated across the nodes using the Raft
Consensus Algorithm."><meta data-rh="true" property="og:description" content="
The Integrated Storage (Raft) backend is used to persist OpenBao&#x27;s data. Unlike all the other
storage backends, this backend does not operate from a single source for the
data. Instead all the nodes in an OpenBao cluster will have a replicated copy of
the entire data. The data is replicated across the nodes using the Raft
Consensus Algorithm."><link data-rh="true" rel="icon" href="/openbao/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://janma.github.io/openbao/docs/configuration/storage/raft/"><link data-rh="true" rel="alternate" href="https://janma.github.io/openbao/docs/configuration/storage/raft/" hreflang="en"><link data-rh="true" rel="alternate" href="https://janma.github.io/openbao/docs/configuration/storage/raft/" hreflang="x-default"><link rel="stylesheet" href="/openbao/assets/css/styles.a7459e73.css">
<script src="/openbao/assets/js/runtime~main.d13fa89d.js" defer="defer"></script>
<script src="/openbao/assets/js/main.f51d3bb7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/openbao/"><div class="navbar__logo"><img src="/openbao/img/logo.svg" alt="OpenBao Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/openbao/img/logo.svg" alt="OpenBao Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">OpenBao</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/openbao/docs/">Docs</a><a class="navbar__item navbar__link" href="/openbao/api-docs/">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/openbao/openbao" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/what-is-openbao/">What is OpenBao?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/use-cases/">Use cases</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/get-started/developer-qs/">Getting Started</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/browser-support/">Browser Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/install/">Installing OpenBao</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/internals/">Internals</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/concepts/">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/openbao/docs/configuration/">Configuration</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/configuration/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/configuration/listener/">listener</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/configuration/seal/">seal</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/openbao/docs/configuration/service-registration/">service_registration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/openbao/docs/configuration/storage/">storage</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/configuration/storage/">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/configuration/storage/filesystem/">Filesystem</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/configuration/storage/in-memory/">In-Memory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/openbao/docs/configuration/storage/raft/">Integrated storage (Raft)</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/configuration/telemetry/">telemetry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/configuration/ui/">ui</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/configuration/user-lockout/">user-lockout</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/openbao/docs/configuration/log-requests-level/">Log completed requests</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/commands/">Commands (CLI)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/agent-and-proxy/">OpenBao Agent and Proxy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/secrets/">Secret Engines</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/auth/">Auth Methods</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/audit/">Audit Devices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/plugins/">Plugins</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/platform/">Platforms</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/upgrading/">Upgrade Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/release-notes/">Release Notes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/deprecation/">Deprecation Notices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/policies/">Policies</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/rfcs/">RFCs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/openbao/docs/faq/">FAQ</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/openbao/docs/glossary/">Glossary</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/openbao/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Configuration</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">storage</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Integrated storage (Raft)</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Integrated storage (Raft) backend</h1>
<p>The Integrated Storage backend is used to persist OpenBao&#x27;s data. Unlike other storage
backends, Integrated Storage does not operate from a single source of data. Instead
all the nodes in an OpenBao cluster will have a replicated copy of OpenBao&#x27;s data.
Data gets replicated across all the nodes via the <a href="https://raft.github.io/" target="_blank" rel="noopener noreferrer" title="The Raft Consensus Algorithm">Raft Consensus
Algorithm</a>.</p>
<ul>
<li>
<p><strong>High Availability</strong> – the Integrated Storage backend supports high availability.</p>
</li>
<li>
<p><strong>HashiCorp Supported</strong> – the Integrated Storage backend is officially supported
by HashiCorp.</p>
</li>
</ul>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">storage &quot;raft&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  path = &quot;/path/to/raft/data&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  node_id = &quot;raft_node_1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cluster_addr = &quot;http://127.0.0.1:8201&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p><strong>Note:</strong> When using the Integrated Storage backend, it is required to provide
<a href="/openbao/docs/concepts/ha/#per-node-cluster-address"><code>cluster_addr</code></a> to indicate the address and port to be used for communication
between the nodes in the Raft cluster.</p></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p><strong>Note:</strong> When using the Integrated Storage backend, a separate
<a href="/openbao/docs/configuration/#ha_storage"><code>ha_storage</code></a>
backend cannot be declared.</p></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p><strong>Note:</strong> When using the Integrated Storage backend, it is strongly recommended to
set <a href="/openbao/docs/configuration/#disable_mlock"><code>disable_mlock</code></a> to <code>true</code>, and to disable memory swapping on the system.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="raft-parameters"><code>raft</code> parameters<a href="#raft-parameters" class="hash-link" aria-label="Direct link to raft-parameters" title="Direct link to raft-parameters">​</a></h2>
<ul>
<li>
<p><code>path</code> <code>(string: &quot;&quot;)</code> – The file system path where all the OpenBao data gets
stored.
This value can be overridden by setting the <code>VAULT_RAFT_PATH</code> environment variable.</p>
</li>
<li>
<p><code>node_id</code> <code>(string: &quot;&quot;)</code> - The identifier for the node in the Raft cluster.
This value can be overridden by setting the <code>VAULT_RAFT_NODE_ID</code> environment variable.</p>
</li>
<li>
<p><code>performance_multiplier</code> <code>(integer: 0)</code> - An integer multiplier used by
servers to scale key Raft timing parameters. Tuning this affects the time it
takes OpenBao to detect leader failures and to perform leader elections, at the
expense of requiring more network and CPU resources for better performance.
Omitting this value or setting it to 0 uses default timing described below.
Lower values are used to tighten timing and increase sensitivity while higher
values relax timings and reduce sensitivity.</p>
<p>By default, OpenBao will use a lower-performance timing that&#x27;s suitable for
minimal OpenBao servers, currently equivalent to setting this to a value of 5
(this default may be changed in future versions of OpenBao, depending if the
target minimum server profile changes). Setting this to a value of 1 will
configure Raft to its highest-performance mode and is recommended for
production OpenBao servers. The maximum allowed value is 10.</p>
</li>
<li>
<p><code>trailing_logs</code> <code>(integer: 10000)</code> - This controls how many log entries are
left in the log store on disk after a snapshot is made. This should only be
adjusted when followers cannot catch up to the leader due to a very large
snapshot size and high write throughput causing log truncation before a
snapshot can be fully installed. If you need to use this to recover a cluster,
consider reducing write throughput or the amount of data stored on OpenBao. The
default value is 10000 which is suitable for all normal workloads. The
<code>trailing_logs</code> metric is not the same as <code>max_trailing_logs</code>.</p>
</li>
<li>
<p><code>snapshot_threshold</code> <code>(integer: 8192)</code> - This controls the minimum number of Raft
commit entries between snapshots that are saved to disk. This is a low-level
parameter that should rarely need to be changed. Very busy clusters
experiencing excessive disk IO may increase this value to reduce disk IO and
minimize the chances of all servers taking snapshots at the same time.
Increasing this trades off disk IO for disk space since the log will grow much
larger and the space in the <code>raft.db</code> file can&#x27;t be reclaimed till the next
snapshot. Servers may take longer to recover from crashes or failover if this
is increased significantly as more logs will need to be replayed.</p>
</li>
<li>
<p><code>snapshot_interval</code> <code>(integer: 120 seconds)</code> - The snapshot interval
controls how often Raft checks whether a snapshot operation is
required. Raft randomly staggers snapshots between the configured
interval and twice the configured interval to keep the entire cluster
from performing a snapshot at once. The default snapshot interval is
120 seconds.</p>
</li>
<li>
<p><code>retry_join</code> <code>(list: [])</code> - A set of connection details for another node in the
cluster, which is used to help nodes locate a leader in order to join a cluster.
There can be one or more <a href="#retry_join-stanza"><code>retry_join</code></a> stanzas.</p>
<p>If the connection details for all nodes in the cluster are known in advance, you
can include these stanzas to enable nodes to automatically join the Raft cluster.
Once one of the nodes is initialized as the leader, the remaining nodes will use
their <a href="#retry_join-stanza"><code>retry_join</code></a> configuration to locate the leader and
join the cluster. Note that when using Shamir seal, the joined nodes will still
need to be unsealed manually.
See <a href="#retry_join-stanza">the section below</a> for the parameters accepted by the
<a href="#retry_join-stanza"><code>retry_join</code></a> stanza.</p>
</li>
<li>
<p><code>retry_join_as_non_voter</code> <code>(boolean: false)</code> - If set, causes any <code>retry_join</code>
config to join the Raft cluster as a non-voter. The node will not participate
in the Raft quorum but will still receive the data replication stream, adding
read scalability to a cluster. This option has the same effect as the
<a href="/openbao/docs/commands/operator/raft/#non-voter"><code>-non-voter</code></a> flag for the
<code>bao operator raft join</code> command, but only affects voting status when joining
via <code>retry_join</code> config. This setting can be overridden to true by setting the
<code>VAULT_RAFT_RETRY_JOIN_AS_NON_VOTER</code> environment variable to any non-empty value.
Only valid if there is at least one <code>retry_join</code> stanza.</p>
</li>
<li>
<p><code>max_entry_size</code> <code>(integer: 1048576)</code> - This configures the maximum number of
bytes for a Raft entry. It applies to both Put operations and transactions.
Any put or transaction operation exceeding this configuration value will cause
the respective operation to fail. Raft has a suggested max size of data in a
Raft log entry. This is based on current architecture, default timing, etc.
Integrated Storage also uses a chunk size that is the threshold used for
breaking a large value into chunks. By default, the chunk size is the same as
Raft&#x27;s max size log entry. The default value for this configuration is 1048576
-- two times the chunking size.</p>
</li>
<li>
<p><code>autopilot_reconcile_interval</code> <code>(string: &quot;10s&quot;)</code> - This is the interval after
which autopilot will pick up any state changes. State change could mean multiple
things; for example a newly joined voter node, initially added as non-voter to
the Raft cluster by autopilot has successfully completed the stabilization
period thereby qualifying for being promoted as a voter, a node that has become
unhealthy and needs to be shown as such in the state API, a node has been marked
as dead needing eviction from Raft configuration, etc.</p>
</li>
<li>
<p><code>autopilot_update_interval</code> <code>(string: &quot;2s&quot;)</code> - This is the interval after which
autopilot will poll OpenBao for any updates to the information it cares about. This
includes things like the autopilot configuration, current autopilot state, raft
configuration, known servers, latest raft index, and stats for all the known servers.
The information that autopilot receives will be used to calculate its next state.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="retry_join-stanza"><code>retry_join</code> stanza<a href="#retry_join-stanza" class="hash-link" aria-label="Direct link to retry_join-stanza" title="Direct link to retry_join-stanza">​</a></h3>
<ul>
<li>
<p><code>leader_api_addr</code> <code>(string: &quot;&quot;)</code> - Address of a possible leader node.</p>
</li>
<li>
<p><code>auto_join</code> <code>(string: &quot;&quot;)</code> - Cloud auto-join configuration, using
<a href="https://github.com/hashicorp/go-discover" target="_blank" rel="noopener noreferrer">go-discover</a> syntax.</p>
</li>
<li>
<p><code>auto_join_scheme</code> <code>(string: &quot;&quot;)</code> - The optional URI protocol scheme for addresses
discovered via auto-join. Available values are <code>http</code> or <code>https</code>.</p>
</li>
<li>
<p><code>auto_join_port</code> <code>(uint: &quot;&quot;)</code> - The optional port used for addressed discovered
via auto-join.</p>
</li>
<li>
<p><code>leader_tls_servername</code> <code>(string: &quot;&quot;)</code> - The TLS server name to use when
connecting with HTTPS.
Should match one of the names in the <a href="https://en.wikipedia.org/wiki/Subject_Alternative_Name" target="_blank" rel="noopener noreferrer">DNS
SANs</a> of the remote
server certificate.
See also <a href="/openbao/docs/concepts/integrated-storage/#autojoin-with-tls-servername">Integrated Storage and TLS</a></p>
</li>
<li>
<p><code>leader_ca_cert_file</code> <code>(string: &quot;&quot;)</code> - File path to the CA cert of the
possible leader node.</p>
</li>
<li>
<p><code>leader_client_cert_file</code> <code>(string: &quot;&quot;)</code> - File path to the client certificate
for the follower node to establish client authentication with the possible
leader node.</p>
</li>
<li>
<p><code>leader_client_key_file</code> <code>(string: &quot;&quot;)</code> - File path to the client key for the
follower node to establish client authentication with the possible leader node.</p>
</li>
<li>
<p><code>leader_ca_cert</code> <code>(string: &quot;&quot;)</code> - CA cert of the possible leader node.</p>
</li>
<li>
<p><code>leader_client_cert</code> <code>(string: &quot;&quot;)</code> - Client certificate for the follower node
to establish client authentication with the possible leader node.</p>
</li>
<li>
<p><code>leader_client_key</code> <code>(string: &quot;&quot;)</code> - Client key for the follower node to
establish client authentication with the possible leader node.</p>
</li>
</ul>
<p>Each <a href="#retry_join-stanza"><code>retry_join</code></a> block may provide TLS certificates via
file paths or as a single-line certificate string value with newlines delimited
by <code>\n</code>, but not a combination of both. Each <a href="#retry_join-stanza"><code>retry_join</code></a>
stanza may contain either a <a href="#leader_api_addr"><code>leader_api_addr</code></a> value or a
cloud <a href="#auto_join"><code>auto_join</code></a> configuration value, but not both. When an
<a href="#auto_join"><code>auto_join</code></a> value is provided, OpenBao will automatically attempt to
discover and resolve potential Raft leader addresses using <a href="https://github.com/hashicorp/go-discover" target="_blank" rel="noopener noreferrer">go-discover</a>.
See the go-discover
<a href="https://github.com/hashicorp/go-discover/blob/master/README.md" target="_blank" rel="noopener noreferrer">README</a>
for details on the format of the <code>auto_join</code> value.</p>
<p>By default, OpenBao will attempt to reach discovered peers using HTTPS and port 8200. Operators may override these through the
<a href="#auto_join_scheme"><code>auto_join_scheme</code></a> and <a href="#auto_join_port"><code>auto_join_port</code></a>
fields respectively.</p>
<p>Example Configuration:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">storage &quot;raft&quot; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  path    = &quot;/Users/foo/raft/&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  node_id = &quot;node1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  retry_join {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leader_api_addr = &quot;http://127.0.0.2:8200&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leader_ca_cert_file = &quot;/path/to/ca1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leader_client_cert_file = &quot;/path/to/client/cert1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leader_client_key_file = &quot;/path/to/client/key1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  retry_join {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leader_api_addr = &quot;http://127.0.0.3:8200&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leader_ca_cert_file = &quot;/path/to/ca2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leader_client_cert_file = &quot;/path/to/client/cert2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leader_client_key_file = &quot;/path/to/client/key2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  retry_join {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leader_api_addr = &quot;http://127.0.0.4:8200&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leader_ca_cert_file = &quot;/path/to/ca3&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leader_client_cert_file = &quot;/path/to/client/cert3&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    leader_client_key_file = &quot;/path/to/client/key3&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  retry_join {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    auto_join = &quot;provider=aws region=eu-west-1 tag_key=openbao tag_value=... access_key_id=... secret_access_key=...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tutorial">Tutorial<a href="#tutorial" class="hash-link" aria-label="Direct link to Tutorial" title="Direct link to Tutorial">​</a></h2>
<p>Refer to the <a href="/openbao/tutorials/raft/">Integrated
Storage</a> series of tutorials to learn more about implementing OpenBao using Integrated Storage.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/openbao/openbao/tree/main/website/content/docs/configuration/storage/raft.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/openbao/docs/configuration/storage/in-memory/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">In-Memory</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/openbao/docs/configuration/telemetry/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">telemetry</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#raft-parameters" class="table-of-contents__link toc-highlight"><code>raft</code> parameters</a><ul><li><a href="#retry_join-stanza" class="table-of-contents__link toc-highlight"><code>retry_join</code> stanza</a></li></ul></li><li><a href="#tutorial" class="table-of-contents__link toc-highlight">Tutorial</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/openbao/docs/">Intro</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/openbao/openbao/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://chat.lfx.linuxfoundation.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chat Server<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://wiki.lfedge.org/display/OH/OpenBao+%28Hashicorp+Vault+Fork+effort%29+FAQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Wiki<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/openbao/openbao" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 The OpenBao Authors. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>